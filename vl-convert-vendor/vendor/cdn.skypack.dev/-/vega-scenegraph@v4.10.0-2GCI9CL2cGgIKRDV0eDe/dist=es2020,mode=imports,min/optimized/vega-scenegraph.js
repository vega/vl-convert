import{hasOwnProperty as Pt,inherits as ot,lruCache as $i,isArray as Z,error as cn,toSet as Hi,extend as Wi,isFunction as ce,isNumber as hn,isObject as un,truthy as fn,array as dn,peek as pn}from"/-/vega-util@v1.17.0-uRskU0IBL2vWCP4Va8OC/dist=es2020,mode=imports,min/optimized/vega-util.js";import{arc as ji,area as gn,line as Ui,symbol as Xi,curveBasis as Fi,curveBasisClosed as Ji,curveBasisOpen as Yi,curveBundle as Ki,curveCardinal as Zi,curveCardinalOpen as Qi,curveCardinalClosed as tr,curveCatmullRom as er,curveCatmullRomClosed as nr,curveCatmullRomOpen as ir,curveLinear as rr,curveLinearClosed as sr,curveMonotoneY as or,curveMonotoneX as ar,curveNatural as lr,curveStep as cr,curveStepAfter as hr,curveStepBefore as ur}from"/-/d3-shape@v3.1.0-yz7kc2ZI0P02sA7MMeyD/dist=es2020,mode=imports,min/optimized/d3-shape.js";import{path as vn}from"/-/d3-path@v3.0.1-tHVDF1s2W2KiMuJCxWJF/dist=es2020,mode=imports,min/optimized/d3-path.js";export{path}from"/-/d3-path@v3.0.1-tHVDF1s2W2KiMuJCxWJF/dist=es2020,mode=imports,min/optimized/d3-path.js";import{image as fr,canvas as he}from"/-/vega-canvas@v1.2.6-LOIUlXMv11fR2KwlkAGG/dist=es2020,mode=imports,min/optimized/vega-canvas.js";import{loader as yn}from"/-/vega-loader@v4.5.0-NhsMLBp96EaizeMWgoMP/dist=es2020,mode=imports,min/optimized/vega-loader.js";import{isDiscrete as dr,domainCaption as _n}from"/-/vega-scale@v7.2.0-V0J4hKWZmxW22KwUY6dZ/dist=es2020,mode=imports,min/optimized/vega-scale.js";let kn=0;function pr(){kn=0}const Lt="p_";function ue(t){return t&&t.gradient}function wn(t,e,n){const i=t.gradient;let r=t.id,s=i==="radial"?Lt:"";return r||(r=t.id="gradient_"+kn++,i==="radial"?(t.x1=O(t.x1,.5),t.y1=O(t.y1,.5),t.r1=O(t.r1,0),t.x2=O(t.x2,.5),t.y2=O(t.y2,.5),t.r2=O(t.r2,.5),s=Lt):(t.x1=O(t.x1,0),t.y1=O(t.y1,0),t.x2=O(t.x2,1),t.y2=O(t.y2,0))),e[r]=t,"url("+(n||"")+"#"+s+r+")"}function O(t,e){return t??e}function gr(t,e){var n=[],i;return i={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:n,stop:function(r,s){return n.push({offset:r,color:s}),i}}}const bn={basis:{curve:Fi},"basis-closed":{curve:Ji},"basis-open":{curve:Yi},bundle:{curve:Ki,tension:"beta",value:.85},cardinal:{curve:Zi,tension:"tension",value:0},"cardinal-open":{curve:Qi,tension:"tension",value:0},"cardinal-closed":{curve:tr,tension:"tension",value:0},"catmull-rom":{curve:er,tension:"alpha",value:.5},"catmull-rom-closed":{curve:nr,tension:"alpha",value:.5},"catmull-rom-open":{curve:ir,tension:"alpha",value:.5},linear:{curve:rr},"linear-closed":{curve:sr},monotone:{horizontal:or,vertical:ar},natural:{curve:lr},step:{curve:cr},"step-after":{curve:hr},"step-before":{curve:ur}};function fe(t,e,n){var i=Pt(bn,t)&&bn[t],r=null;return i&&(r=i.curve||i[e||"vertical"],i.tension&&n!=null&&(r=r[i.tension](n))),r}const vr={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},yr=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,_r=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,kr=/^((\s+,?\s*)|(,\s*))/,wr=/^[01]/;function gt(t){const e=[];return t.match(yr).forEach(n=>{let i=n[0];const r=i.toLowerCase(),s=vr[r],o=br(r,s,n.slice(1).trim()),l=o.length;if(l<s||l&&l%s!==0)throw Error("Invalid SVG path, incorrect parameter count");if(e.push([i,...o.slice(0,s)]),l===s)return;r==="m"&&(i=i==="M"?"L":"l");for(let a=s;a<l;a+=s)e.push([i,...o.slice(a,a+s)])}),e}function br(t,e,n){const i=[];for(let r=0;e&&r<n.length;)for(let s=0;s<e;++s){const o=t==="a"&&(s===3||s===4)?wr:_r,l=n.slice(r).match(o);if(l===null)throw Error("Invalid SVG path, incorrect parameter type");r+=l[0].length,i.push(+l[0]);const a=n.slice(r).match(kr);a!==null&&(r+=a[0].length)}return i}const V=Math.PI/180,xr=1e-14,Q=Math.PI/2,D=Math.PI*2,at=Math.sqrt(3)/2;var de={},pe={},xn=[].join;function Tr(t,e,n,i,r,s,o,l,a){const h=xn.call(arguments);if(de[h])return de[h];const c=o*V,u=Math.sin(c),f=Math.cos(c);n=Math.abs(n),i=Math.abs(i);const d=f*(l-t)*.5+u*(a-e)*.5,p=f*(a-e)*.5-u*(l-t)*.5;let g=d*d/(n*n)+p*p/(i*i);g>1&&(g=Math.sqrt(g),n*=g,i*=g);const v=f/n,k=u/n,_=-u/i,x=f/i,y=v*l+k*a,C=_*l+x*a,A=v*t+k*e,b=_*t+x*e,R=(A-y)*(A-y)+(b-C)*(b-C);let st=1/R-.25;st<0&&(st=0);let Y=Math.sqrt(st);s==r&&(Y=-Y);const se=.5*(y+A)-Y*(b-C),oe=.5*(C+b)+Y*(A-y),ae=Math.atan2(C-oe,y-se),Bi=Math.atan2(b-oe,A-se);let K=Bi-ae;K<0&&s===1?K+=D:K>0&&s===0&&(K-=D);const le=Math.ceil(Math.abs(K/(Q+.001))),ln=[];for(let pt=0;pt<le;++pt){const Gi=ae+pt*K/le,Vi=ae+(pt+1)*K/le;ln[pt]=[se,oe,Gi,Vi,n,i,u,f]}return de[h]=ln}function Mr(t){const e=xn.call(t);if(pe[e])return pe[e];var n=t[0],i=t[1],r=t[2],s=t[3],o=t[4],l=t[5],a=t[6],h=t[7];const c=h*o,u=-a*l,f=a*o,d=h*l,p=Math.cos(r),g=Math.sin(r),v=Math.cos(s),k=Math.sin(s),_=.5*(s-r),x=Math.sin(_*.5),y=8/3*x*x/Math.sin(_),C=n+p-y*g,A=i+g+y*p,b=n+v,R=i+k,st=b+y*k,Y=R-y*v;return pe[e]=[c*C+u*A,f*C+d*A,c*st+u*Y,f*st+d*Y,c*b+u*R,f*b+d*R]}const S=["l",0,0,0,0,0,0,0];function Cr(t,e,n){const i=S[0]=t[0];if(i==="a"||i==="A")S[1]=e*t[1],S[2]=n*t[2],S[3]=t[3],S[4]=t[4],S[5]=t[5],S[6]=e*t[6],S[7]=n*t[7];else if(i==="h"||i==="H")S[1]=e*t[1];else if(i==="v"||i==="V")S[1]=n*t[1];else for(var r=1,s=t.length;r<s;++r)S[r]=(r%2==1?e:n)*t[r];return S}function mt(t,e,n,i,r,s){var o,l=null,a=0,h=0,c=0,u=0,f,d,p,g,v=0,k=0;n==null&&(n=0),i==null&&(i=0),r==null&&(r=1),s==null&&(s=r),t.beginPath&&t.beginPath();for(var _=0,x=e.length;_<x;++_){o=e[_],(r!==1||s!==1)&&(o=Cr(o,r,s));switch(o[0]){case"l":a+=o[1],h+=o[2],t.lineTo(a+n,h+i);break;case"L":a=o[1],h=o[2],t.lineTo(a+n,h+i);break;case"h":a+=o[1],t.lineTo(a+n,h+i);break;case"H":a=o[1],t.lineTo(a+n,h+i);break;case"v":h+=o[1],t.lineTo(a+n,h+i);break;case"V":h=o[1],t.lineTo(a+n,h+i);break;case"m":a+=o[1],h+=o[2],v=a,k=h,t.moveTo(a+n,h+i);break;case"M":a=o[1],h=o[2],v=a,k=h,t.moveTo(a+n,h+i);break;case"c":f=a+o[5],d=h+o[6],c=a+o[3],u=h+o[4],t.bezierCurveTo(a+o[1]+n,h+o[2]+i,c+n,u+i,f+n,d+i),a=f,h=d;break;case"C":a=o[5],h=o[6],c=o[3],u=o[4],t.bezierCurveTo(o[1]+n,o[2]+i,c+n,u+i,a+n,h+i);break;case"s":f=a+o[3],d=h+o[4],c=2*a-c,u=2*h-u,t.bezierCurveTo(c+n,u+i,a+o[1]+n,h+o[2]+i,f+n,d+i),c=a+o[1],u=h+o[2],a=f,h=d;break;case"S":f=o[3],d=o[4],c=2*a-c,u=2*h-u,t.bezierCurveTo(c+n,u+i,o[1]+n,o[2]+i,f+n,d+i),a=f,h=d,c=o[1],u=o[2];break;case"q":f=a+o[3],d=h+o[4],c=a+o[1],u=h+o[2],t.quadraticCurveTo(c+n,u+i,f+n,d+i),a=f,h=d;break;case"Q":f=o[3],d=o[4],t.quadraticCurveTo(o[1]+n,o[2]+i,f+n,d+i),a=f,h=d,c=o[1],u=o[2];break;case"t":f=a+o[1],d=h+o[2],l[0].match(/[QqTt]/)===null?(c=a,u=h):l[0]==="t"?(c=2*a-p,u=2*h-g):l[0]==="q"&&(c=2*a-c,u=2*h-u),p=c,g=u,t.quadraticCurveTo(c+n,u+i,f+n,d+i),a=f,h=d,c=a+o[1],u=h+o[2];break;case"T":f=o[1],d=o[2],c=2*a-c,u=2*h-u,t.quadraticCurveTo(c+n,u+i,f+n,d+i),a=f,h=d;break;case"a":Tn(t,a+n,h+i,[o[1],o[2],o[3],o[4],o[5],o[6]+a+n,o[7]+h+i]),a+=o[6],h+=o[7];break;case"A":Tn(t,a+n,h+i,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+i]),a=o[6],h=o[7];break;case"z":case"Z":a=v,h=k,t.closePath();break}l=o}}function Tn(t,e,n,i){const r=Tr(i[5],i[6],i[0],i[1],i[3],i[4],i[2],e,n);for(let s=0;s<r.length;++s){const o=Mr(r[s]);t.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}const Mn=.5773502691896257,Cn={circle:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,D)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,i=n/2.5;t.moveTo(-n,-i),t.lineTo(-n,i),t.lineTo(-i,i),t.lineTo(-i,n),t.lineTo(i,n),t.lineTo(i,i),t.lineTo(n,i),t.lineTo(n,-i),t.lineTo(i,-i),t.lineTo(i,-n),t.lineTo(-i,-n),t.lineTo(-i,-i),t.closePath()}},diamond:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),i=-n/2;t.rect(i,i,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,i=n/7,r=n/2.5,s=n/8;t.moveTo(-i,n),t.lineTo(i,n),t.lineTo(i,-s),t.lineTo(r,-s),t.lineTo(0,-n),t.lineTo(-r,-s),t.lineTo(-i,-s),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,i=at*n,r=i-n*Mn,s=n/4;t.moveTo(0,-i-r),t.lineTo(-s,i-r),t.lineTo(s,i-r),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,i=at*n,r=i-n*Mn;t.moveTo(0,-i-r),t.lineTo(-n,i-r),t.lineTo(n,i-r),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,i=at*n;t.moveTo(0,-i),t.lineTo(-n,i),t.lineTo(n,i),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,i=at*n;t.moveTo(0,i),t.lineTo(-n,-i),t.lineTo(n,-i),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,i=at*n;t.moveTo(i,0),t.lineTo(-i,-n),t.lineTo(-i,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,i=at*n;t.moveTo(-i,0),t.lineTo(i,-n),t.lineTo(i,n),t.closePath()}},stroke:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function An(t){return Pt(Cn,t)?Cn[t]:Ar(t)}var ge={};function Ar(t){if(!Pt(ge,t)){const e=gt(t);ge[t]={draw:function(n,i){mt(n,e,0,0,Math.sqrt(i)/2)}}}return ge[t]}const $=.448084975506;function Rr(t){return t.x}function zr(t){return t.y}function Er(t){return t.width}function Sr(t){return t.height}function B(t){return typeof t=="function"?t:()=>+t}function It(t,e,n){return Math.max(e,Math.min(t,n))}function Rn(){var t=Rr,e=zr,n=Er,i=Sr,r=B(0),s=r,o=r,l=r,a=null;function h(c,u,f){var d,p=u??+t.call(this,c),g=f??+e.call(this,c),v=+n.call(this,c),k=+i.call(this,c),_=Math.min(v,k)/2,x=It(+r.call(this,c),0,_),y=It(+s.call(this,c),0,_),C=It(+o.call(this,c),0,_),A=It(+l.call(this,c),0,_);if(a||(a=d=vn()),x<=0&&y<=0&&C<=0&&A<=0)a.rect(p,g,v,k);else{var b=p+v,R=g+k;a.moveTo(p+x,g),a.lineTo(b-y,g),a.bezierCurveTo(b-$*y,g,b,g+$*y,b,g+y),a.lineTo(b,R-A),a.bezierCurveTo(b,R-$*A,b-$*A,R,b-A,R),a.lineTo(p+C,R),a.bezierCurveTo(p+$*C,R,p,R-$*C,p,R-C),a.lineTo(p,g+x),a.bezierCurveTo(p,g+$*x,p+$*x,g,p+x,g),a.closePath()}if(d)return a=null,d+""||null}return h.x=function(c){return arguments.length?(t=B(c),h):t},h.y=function(c){return arguments.length?(e=B(c),h):e},h.width=function(c){return arguments.length?(n=B(c),h):n},h.height=function(c){return arguments.length?(i=B(c),h):i},h.cornerRadius=function(c,u,f,d){return arguments.length?(r=B(c),s=u!=null?B(u):r,l=f!=null?B(f):r,o=d!=null?B(d):s,h):r},h.context=function(c){return arguments.length?(a=c??null,h):a},h}function zn(){var t,e,n,i,r=null,s,o,l,a;function h(u,f,d){const p=d/2;if(s){var g=l-f,v=u-o;if(g||v){var k=Math.sqrt(g*g+v*v),_=(g/=k)*a,x=(v/=k)*a,y=Math.atan2(v,g);r.moveTo(o-_,l-x),r.lineTo(u-g*p,f-v*p),r.arc(u,f,p,y-Math.PI,y),r.lineTo(o+_,l+x),r.arc(o,l,a,y,y+Math.PI)}else r.arc(u,f,p,0,D);r.closePath()}else s=1;o=u,l=f,a=p}function c(u){var f,d=u.length,p,g=!1,v;for(r==null&&(r=v=vn()),f=0;f<=d;++f)!(f<d&&i(p=u[f],f,u))===g&&((g=!g)&&(s=0)),g&&h(+t(p,f,u),+e(p,f,u),+n(p,f,u));if(v)return r=null,v+""||null}return c.x=function(u){return arguments.length?(t=u,c):t},c.y=function(u){return arguments.length?(e=u,c):e},c.size=function(u){return arguments.length?(n=u,c):n},c.defined=function(u){return arguments.length?(i=u,c):i},c.context=function(u){return arguments.length?(u==null?r=null:r=u,c):r},c}function vt(t,e){return t??e}const yt=t=>t.x||0,_t=t=>t.y||0,Pr=t=>t.width||0,Lr=t=>t.height||0,mr=t=>(t.x||0)+(t.width||0),Ir=t=>(t.y||0)+(t.height||0),Or=t=>t.startAngle||0,Dr=t=>t.endAngle||0,Nr=t=>t.padAngle||0,qr=t=>t.innerRadius||0,Br=t=>t.outerRadius||0,Gr=t=>t.cornerRadius||0,Vr=t=>vt(t.cornerRadiusTopLeft,t.cornerRadius)||0,$r=t=>vt(t.cornerRadiusTopRight,t.cornerRadius)||0,Hr=t=>vt(t.cornerRadiusBottomRight,t.cornerRadius)||0,Wr=t=>vt(t.cornerRadiusBottomLeft,t.cornerRadius)||0,jr=t=>vt(t.size,64),Ur=t=>t.size||1,Ot=t=>!(t.defined===!1),Xr=t=>An(t.shape||"circle"),Fr=ji().startAngle(Or).endAngle(Dr).padAngle(Nr).innerRadius(qr).outerRadius(Br).cornerRadius(Gr),Jr=gn().x(yt).y1(_t).y0(Ir).defined(Ot),Yr=gn().y(_t).x1(yt).x0(mr).defined(Ot),Kr=Ui().x(yt).y(_t).defined(Ot),Zr=Rn().x(yt).y(_t).width(Pr).height(Lr).cornerRadius(Vr,$r,Hr,Wr),Qr=Xi().type(Xr).size(jr),ts=zn().x(yt).y(_t).defined(Ot).size(Ur);function ve(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function es(t,e){return Fr.context(t)(e)}function ns(t,e){const n=e[0],i=n.interpolate||"linear";return(n.orient==="horizontal"?Yr:Jr).curve(fe(i,n.orient,n.tension)).context(t)(e)}function is(t,e){const n=e[0],i=n.interpolate||"linear";return Kr.curve(fe(i,n.orient,n.tension)).context(t)(e)}function lt(t,e,n,i){return Zr.context(t)(e,n,i)}function rs(t,e){return(e.mark.shape||e.shape).context(t)(e)}function ss(t,e){return Qr.context(t)(e)}function os(t,e){return ts.context(t)(e)}var En=1;function Sn(){En=1}function ye(t,e,n){var i=e.clip,r=t._defs,s=e.clip_id||(e.clip_id="clip"+En++),o=r.clipping[s]||(r.clipping[s]={id:s});return ce(i)?o.path=i(null):ve(n)?o.path=lt(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+s+")"}function z(t){this.clear(),t&&this.union(t)}z.prototype={clone(){return new z(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,i){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),i<e?(this.y2=e,this.y1=i):(this.y1=e,this.y2=i),this},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},rotate(t,e,n){const i=this.rotatedPoints(t,e,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},rotatedPoints(t,e,n){var{x1:i,y1:r,x2:s,y2:o}=this,l=Math.cos(t),a=Math.sin(t),h=e-e*l+n*a,c=n-e*a-n*l;return[l*i-a*r+h,a*i+l*r+c,l*i-a*o+h,a*i+l*o+c,l*s-a*r+h,a*s+l*r+c,l*s-a*o+h,a*s+l*o+c]},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function _e(t){this.mark=t,this.bounds=this.bounds||new z}function ke(t){_e.call(this,t),this.items=this.items||[]}ot(ke,_e);function we(t){this._pending=0,this._loader=t||yn()}function Pn(t){t._pending+=1}function kt(t){t._pending-=1}we.prototype={pending(){return this._pending},sanitizeURL(t){const e=this;return Pn(e),e._loader.sanitize(t,{context:"href"}).then(n=>(kt(e),n)).catch(()=>(kt(e),null))},loadImage(t){const e=this,n=fr();return Pn(e),e._loader.sanitize(t,{context:"image"}).then(i=>{const r=i.href;if(!r||!n)throw{url:r};const s=new n,o=Pt(i,"crossOrigin")?i.crossOrigin:"anonymous";return o!=null&&(s.crossOrigin=o),s.onload=()=>kt(e),s.onerror=()=>kt(e),s.src=r,s}).catch(i=>(kt(e),{complete:!1,width:0,height:0,src:i&&i.url||""}))},ready(){const t=this;return new Promise(e=>{function n(i){t.pending()?setTimeout(()=>{n(!0)},10):e(i)}n(!1)})}};function tt(t,e,n){if(e.stroke&&e.opacity!==0&&e.strokeOpacity!==0){const i=e.strokeWidth!=null?+e.strokeWidth:1;t.expand(i+(n?as(e,i):0))}return t}function as(t,e){return t.strokeJoin&&t.strokeJoin!=="miter"?0:e}const ls=D-1e-8;let Dt,Nt,qt,et,be,Bt,xe,Te;const H=(t,e)=>Dt.add(t,e),Gt=(t,e)=>H(Nt=t,qt=e),Ln=t=>H(t,Dt.y1),mn=t=>H(Dt.x1,t),nt=(t,e)=>be*t+xe*e,it=(t,e)=>Bt*t+Te*e,Me=(t,e)=>H(nt(t,e),it(t,e)),Ce=(t,e)=>Gt(nt(t,e),it(t,e));function wt(t,e){return Dt=t,e?(et=e*V,be=Te=Math.cos(et),Bt=Math.sin(et),xe=-Bt):(be=Te=1,et=Bt=xe=0),cs}const cs={beginPath(){},closePath(){},moveTo:Ce,lineTo:Ce,rect(t,e,n,i){et?(Me(t+n,e),Me(t+n,e+i),Me(t,e+i),Ce(t,e)):(H(t+n,e+i),Gt(t,e))},quadraticCurveTo(t,e,n,i){const r=nt(t,e),s=it(t,e),o=nt(n,i),l=it(n,i);In(Nt,r,o,Ln),In(qt,s,l,mn),Gt(o,l)},bezierCurveTo(t,e,n,i,r,s){const o=nt(t,e),l=it(t,e),a=nt(n,i),h=it(n,i),c=nt(r,s),u=it(r,s);On(Nt,o,a,c,Ln),On(qt,l,h,u,mn),Gt(c,u)},arc(t,e,n,i,r,s){if(i+=et,r+=et,Nt=n*Math.cos(r)+t,qt=n*Math.sin(r)+e,Math.abs(r-i)>ls)H(t-n,e-n),H(t+n,e+n);else{const o=h=>H(n*Math.cos(h)+t,n*Math.sin(h)+e);let l,a;if(o(i),o(r),r!==i)if(i=i%D,i<0&&(i+=D),r=r%D,r<0&&(r+=D),r<i&&(s=!s,l=i,i=r,r=l),s)for(r-=D,l=i-i%Q,a=0;a<4&&l>r;++a,l-=Q)o(l);else for(l=i-i%Q+Q,a=0;a<4&&l<r;++a,l=l+Q)o(l)}}};function In(t,e,n,i){const r=(t-e)/(t+n-2*e);0<r&&r<1&&i(t+(e-t)*r)}function On(t,e,n,i,r){const s=i-t+3*e-3*n,o=t+n-2*e,l=t-e;let a=0,h=0,c;Math.abs(s)>xr?(c=o*o+l*s,c>=0&&(c=Math.sqrt(c),a=(-o+c)/s,h=(-o-c)/s)):a=.5*l/o,0<a&&a<1&&r(Dn(a,t,e,n,i)),0<h&&h<1&&r(Dn(h,t,e,n,i))}function Dn(t,e,n,i,r){const s=1-t,o=s*s,l=t*t;return o*s*e+3*o*t*n+3*s*l*i+l*t*r}var W=(W=he(1,1))?W.getContext("2d"):null;const Ae=new z;function Re(t){return function(e,n){if(!W)return!0;t(W,e),Ae.clear().union(e.bounds).intersect(n).round();const{x1:i,y1:r,x2:s,y2:o}=Ae;for(let l=r;l<=o;++l)for(let a=i;a<=s;++a)if(W.isPointInPath(a,l))return!0;return!1}}function ze(t,e){return e.contains(t.x||0,t.y||0)}function Nn(t,e){const n=t.x||0,i=t.y||0,r=t.width||0,s=t.height||0;return e.intersects(Ae.set(n,i,n+r,i+s))}function qn(t,e){const n=t.x||0,i=t.y||0,r=t.x2!=null?t.x2:n,s=t.y2!=null?t.y2:i;return ct(e,n,i,r,s)}function ct(t,e,n,i,r){const{x1:s,y1:o,x2:l,y2:a}=t,h=i-e,c=r-n;let u=0,f=1,d,p,g,v;for(v=0;v<4;++v){if(v===0&&(d=-h,p=-(s-e)),v===1&&(d=h,p=l-e),v===2&&(d=-c,p=-(o-n)),v===3&&(d=c,p=a-n),Math.abs(d)<1e-10&&p<0)return!1;if(g=p/d,d<0){if(g>f)return!1;g>u&&(u=g)}else if(d>0){if(g<u)return!1;g<f&&(f=g)}}return!0}function ht(t,e){t.globalCompositeOperation=e.blend||"source-over"}function P(t,e){return t??e}function Bn(t,e){const n=e.length;for(let i=0;i<n;++i)t.addColorStop(e[i].offset,e[i].color);return t}function hs(t,e,n){const i=n.width(),r=n.height();let s;if(e.gradient==="radial")s=t.createRadialGradient(n.x1+P(e.x1,.5)*i,n.y1+P(e.y1,.5)*r,Math.max(i,r)*P(e.r1,0),n.x1+P(e.x2,.5)*i,n.y1+P(e.y2,.5)*r,Math.max(i,r)*P(e.r2,.5));else{const o=P(e.x1,0),l=P(e.y1,0),a=P(e.x2,1),h=P(e.y2,0);if(o===a||l===h||i===r)s=t.createLinearGradient(n.x1+o*i,n.y1+l*r,n.x1+a*i,n.y1+h*r);else{const c=he(Math.ceil(i),Math.ceil(r)),u=c.getContext("2d");return u.scale(i,r),u.fillStyle=Bn(u.createLinearGradient(o,l,a,h),e.stops),u.fillRect(0,0,i,r),t.createPattern(c,"no-repeat")}}return Bn(s,e.stops)}function Gn(t,e,n){return ue(n)?hs(t,n,e.bounds):n}function Vt(t,e,n){return n*=e.fillOpacity==null?1:e.fillOpacity,n>0?(t.globalAlpha=n,t.fillStyle=Gn(t,e,e.fill),!0):!1}var us=[];function ut(t,e,n){var i=(i=e.strokeWidth)!=null?i:1;return i<=0?!1:(n*=e.strokeOpacity==null?1:e.strokeOpacity,n>0?(t.globalAlpha=n,t.strokeStyle=Gn(t,e,e.stroke),t.lineWidth=i,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||us),t.lineDashOffset=e.strokeDashOffset||0),!0):!1)}function fs(t,e){return t.zindex-e.zindex||t.index-e.index}function Ee(t){if(!t.zdirty)return t.zitems;var e=t.items,n=[],i,r,s;for(r=0,s=e.length;r<s;++r)i=e[r],i.index=r,i.zindex&&n.push(i);return t.zdirty=!1,t.zitems=n.sort(fs)}function L(t,e){var n=t.items,i,r;if(!n||!n.length)return;const s=Ee(t);if(s&&s.length){for(i=0,r=n.length;i<r;++i)n[i].zindex||e(n[i]);n=s}for(i=0,r=n.length;i<r;++i)e(n[i])}function $t(t,e){var n=t.items,i,r;if(!n||!n.length)return null;const s=Ee(t);for(s&&s.length&&(n=s),r=n.length;--r>=0;)if(i=e(n[r]))return i;if(n===s){for(n=t.items,r=n.length;--r>=0;)if(!n[r].zindex&&(i=e(n[r])))return i}return null}function Se(t){return function(e,n,i){L(n,r=>{(!i||i.intersects(r.bounds))&&Vn(t,e,r,r)})}}function ds(t){return function(e,n,i){n.items.length&&(!i||i.intersects(n.bounds))&&Vn(t,e,n.items[0],n.items)}}function Vn(t,e,n,i){var r=n.opacity==null?1:n.opacity;if(r===0)return;if(t(e,i))return;ht(e,n),n.fill&&Vt(e,n,r)&&e.fill(),n.stroke&&ut(e,n,r)&&e.stroke()}function Ht(t){return t=t||fn,function(e,n,i,r,s,o){return i*=e.pixelRatio,r*=e.pixelRatio,$t(n,l=>{const a=l.bounds;if(a&&!a.contains(s,o)||!a)return;if(t(e,l,i,r,s,o))return l})}}function bt(t,e){return function(n,i,r,s){var o=Array.isArray(i)?i[0]:i,l=e??o.fill,a=o.stroke&&n.isPointInStroke,h,c;return a&&(h=o.strokeWidth,c=o.strokeCap,n.lineWidth=h??1,n.lineCap=c??"butt"),t(n,i)?!1:l&&n.isPointInPath(r,s)||a&&n.isPointInStroke(r,s)}}function Pe(t){return Ht(bt(t))}function rt(t,e){return"translate("+t+","+e+")"}function Le(t){return"rotate("+t+")"}function ps(t,e){return"scale("+t+","+e+")"}function $n(t){return rt(t.x||0,t.y||0)}function gs(t){return rt(t.x||0,t.y||0)+(t.angle?" "+Le(t.angle):"")}function vs(t){return rt(t.x||0,t.y||0)+(t.angle?" "+Le(t.angle):"")+(t.scaleX||t.scaleY?" "+ps(t.scaleX||1,t.scaleY||1):"")}function me(t,e,n){function i(o,l){o("transform",gs(l)),o("d",e(null,l))}function r(o,l){return e(wt(o,l.angle),l),tt(o,l).translate(l.x||0,l.y||0)}function s(o,l){var a=l.x||0,h=l.y||0,c=l.angle||0;o.translate(a,h),c&&o.rotate(c*=V),o.beginPath(),e(o,l),c&&o.rotate(-c),o.translate(-a,-h)}return{type:t,tag:"path",nested:!1,attr:i,bound:r,draw:Se(s),pick:Pe(s),isect:n||Re(s)}}var ys=me("arc",es);function _s(t,e){for(var n=t[0].orient==="horizontal"?e[1]:e[0],i=t[0].orient==="horizontal"?"y":"x",r=t.length,s=Infinity,o,l;--r>=0;){if(t[r].defined===!1)continue;l=Math.abs(t[r][i]-n),l<s&&(s=l,o=t[r])}return o}function ks(t,e){for(var n=Math.pow(t[0].strokeWidth||1,2),i=t.length,r,s,o;--i>=0;){if(t[i].defined===!1)continue;if(r=t[i].x-e[0],s=t[i].y-e[1],o=r*r+s*s,o<n)return t[i]}return null}function ws(t,e){for(var n=t.length,i,r,s;--n>=0;){if(t[n].defined===!1)continue;if(i=t[n].x-e[0],r=t[n].y-e[1],s=i*i+r*r,i=t[n].size||1,s<i*i)return t[n]}return null}function Ie(t,e,n){function i(a,h){var c=h.mark.items;c.length&&a("d",e(null,c))}function r(a,h){var c=h.items;return c.length===0?a:(e(wt(a),c),tt(a,c[0]))}function s(a,h){a.beginPath(),e(a,h)}const o=bt(s);function l(a,h,c,u,f,d){var p=h.items,g=h.bounds;return!p||!p.length||g&&!g.contains(f,d)?null:(c*=a.pixelRatio,u*=a.pixelRatio,o(a,p,c,u)?p[0]:null)}return{type:t,tag:"path",nested:!0,attr:i,bound:r,draw:ds(s),pick:l,isect:ze,tip:n}}var bs=Ie("area",ns,_s);function xs(t,e){var n=e.clip;t.save(),ce(n)?(t.beginPath(),n(t),t.clip()):Hn(t,e.group)}function Hn(t,e){t.beginPath(),ve(e)?lt(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function Wn(t){const e=P(t.strokeWidth,1);return t.strokeOffset!=null?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function Ts(t,e){t("transform",$n(e))}function jn(t,e){const n=Wn(e);t("d",lt(null,e,n,n))}function Ms(t,e){t("class","background"),t("aria-hidden",!0),jn(t,e)}function Cs(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?jn(t,e):t("d","")}function As(t,e,n){const i=e.clip?ye(n,e,e):null;t("clip-path",i)}function Rs(t,e){if(!e.clip&&e.items){const n=e.items,i=n.length;for(let r=0;r<i;++r)t.union(n[r].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),tt(t,e),t.translate(e.x||0,e.y||0)}function xt(t,e,n,i){const r=Wn(e);t.beginPath(),lt(t,e,(n||0)+r,(i||0)+r)}const zs=bt(xt),Es=bt(xt,!1),Ss=bt(xt,!0);function Ps(t,e,n){L(e,i=>{const r=i.x||0,s=i.y||0,o=i.strokeForeground,l=i.opacity==null?1:i.opacity;(i.stroke||i.fill)&&l&&(xt(t,i,r,s),ht(t,i),i.fill&&Vt(t,i,l)&&t.fill(),i.stroke&&!o&&ut(t,i,l)&&t.stroke()),t.save(),t.translate(r,s),i.clip&&Hn(t,i),n&&n.translate(-r,-s),L(i,a=>{this.draw(t,a,n)}),n&&n.translate(r,s),t.restore(),o&&i.stroke&&l&&(xt(t,i,r,s),ht(t,i),ut(t,i,l)&&t.stroke())})}function Ls(t,e,n,i,r,s){if(e.bounds&&!e.bounds.contains(r,s)||!e.items)return null;const o=n*t.pixelRatio,l=i*t.pixelRatio;return $t(e,a=>{let h,c,u;const f=a.bounds;if(f&&!f.contains(r,s))return;c=a.x||0,u=a.y||0;const d=c+(a.width||0),p=u+(a.height||0),g=a.clip;if(g&&(r<c||r>d||s<u||s>p))return;if(t.save(),t.translate(c,u),c=r-c,u=s-u,g&&ve(a)&&!Ss(t,a,o,l))return t.restore(),null;const v=a.strokeForeground,k=e.interactive!==!1;return k&&v&&a.stroke&&Es(t,a,o,l)?(t.restore(),a):(h=$t(a,_=>ms(_,c,u)?this.pick(_,n,i,c,u):null),!h&&k&&(a.fill||!v&&a.stroke)&&zs(t,a,o,l)&&(h=a),t.restore(),h||null)})}function ms(t,e,n){return(t.interactive!==!1||t.marktype==="group")&&t.bounds&&t.bounds.contains(e,n)}var Is={type:"group",tag:"g",nested:!1,attr:Ts,bound:Rs,draw:Ps,pick:Ls,isect:Nn,content:As,background:Ms,foreground:Cs},Tt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function Oe(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then(i=>{t.image=i,t.image.url=t.url})),n}function De(t,e){return t.width!=null?t.width:!e||!e.width?0:t.aspect!==!1&&t.height?t.height*e.width/e.height:e.width}function Ne(t,e){return t.height!=null?t.height:!e||!e.height?0:t.aspect!==!1&&t.width?t.width*e.height/e.width:e.height}function Wt(t,e){return t==="center"?e/2:t==="right"?e:0}function jt(t,e){return t==="middle"?e/2:t==="bottom"?e:0}function Os(t,e,n){const i=Oe(e,n),r=De(e,i),s=Ne(e,i),o=(e.x||0)-Wt(e.align,r),l=(e.y||0)-jt(e.baseline,s),a=!i.src&&i.toDataURL?i.toDataURL():i.src||"";t("href",a,Tt["xmlns:xlink"],"xlink:href"),t("transform",rt(o,l)),t("width",r),t("height",s),t("preserveAspectRatio",e.aspect===!1?"none":"xMidYMid")}function Ds(t,e){const n=e.image,i=De(e,n),r=Ne(e,n),s=(e.x||0)-Wt(e.align,i),o=(e.y||0)-jt(e.baseline,r);return t.set(s,o,s+i,o+r)}function Ns(t,e,n){L(e,i=>{if(n&&!n.intersects(i.bounds))return;const r=Oe(i,this);let s=De(i,r),o=Ne(i,r);if(s===0||o===0)return;let l=(i.x||0)-Wt(i.align,s),a=(i.y||0)-jt(i.baseline,o),h,c,u,f;i.aspect!==!1&&(c=r.width/r.height,u=i.width/i.height,c===c&&u===u&&c!==u&&(u<c?(f=s/c,a+=(o-f)/2,o=f):(f=o*c,l+=(s-f)/2,s=f))),(r.complete||r.toDataURL)&&(ht(t,i),t.globalAlpha=(h=i.opacity)!=null?h:1,t.imageSmoothingEnabled=i.smooth!==!1,t.drawImage(r,l,a,s,o))})}var qs={type:"image",tag:"image",nested:!1,attr:Os,bound:Ds,draw:Ns,pick:Ht(),isect:fn,get:Oe,xOffset:Wt,yOffset:jt},Bs=Ie("line",is,ks);function Gs(t,e){var n=e.scaleX||1,i=e.scaleY||1;(n!==1||i!==1)&&t("vector-effect","non-scaling-stroke"),t("transform",vs(e)),t("d",e.path)}function Ut(t,e){var n=e.path;if(n==null)return!0;var i=e.x||0,r=e.y||0,s=e.scaleX||1,o=e.scaleY||1,l=(e.angle||0)*V,a=e.pathCache;(!a||a.path!==n)&&((e.pathCache=a=gt(n)).path=n),l&&t.rotate&&t.translate?(t.translate(i,r),t.rotate(l),mt(t,a,0,0,s,o),t.rotate(-l),t.translate(-i,-r)):mt(t,a,i,r,s,o)}function Vs(t,e){return Ut(wt(t,e.angle),e)?t.set(0,0,0,0):tt(t,e,!0)}var $s={type:"path",tag:"path",nested:!1,attr:Gs,bound:Vs,draw:Se(Ut),pick:Pe(Ut),isect:Re(Ut)};function Hs(t,e){t("d",lt(null,e))}function Ws(t,e){var n,i;return tt(t.set(n=e.x||0,i=e.y||0,n+e.width||0,i+e.height||0),e)}function Un(t,e){t.beginPath(),lt(t,e)}var js={type:"rect",tag:"path",nested:!1,attr:Hs,bound:Ws,draw:Se(Un),pick:Pe(Un),isect:Nn};function Us(t,e){t("transform",$n(e)),t("x2",e.x2!=null?e.x2-(e.x||0):0),t("y2",e.y2!=null?e.y2-(e.y||0):0)}function Xs(t,e){var n,i;return tt(t.set(n=e.x||0,i=e.y||0,e.x2!=null?e.x2:n,e.y2!=null?e.y2:i),e)}function Xn(t,e,n){var i,r,s,o;return e.stroke&&ut(t,e,n)?(i=e.x||0,r=e.y||0,s=e.x2!=null?e.x2:i,o=e.y2!=null?e.y2:r,t.beginPath(),t.moveTo(i,r),t.lineTo(s,o),!0):!1}function Fs(t,e,n){L(e,i=>{if(n&&!n.intersects(i.bounds))return;var r=i.opacity==null?1:i.opacity;r&&Xn(t,i,r)&&(ht(t,i),t.stroke())})}function Js(t,e,n,i){return t.isPointInStroke?Xn(t,e,1)&&t.isPointInStroke(n,i):!1}var Ys={type:"rule",tag:"line",nested:!1,attr:Us,bound:Xs,draw:Fs,pick:Ht(Js),isect:qn},Ks=me("shape",rs),Zs=me("symbol",ss,ze);const Fn=$i();var ft={height:N,measureWidth:Be,estimateWidth:qe,width:qe,canvas:Jn};Jn(!0);function Jn(t){ft.width=t&&W?Be:qe}function qe(t,e){return Yn(U(t,e),N(t))}function Yn(t,e){return~~(.8*t.length*e)}function Be(t,e){return N(t)<=0||!(e=U(t,e))?0:Kn(e,Xt(t))}function Kn(t,e){const n="(".concat(e,") ").concat(t);let i=Fn.get(n);return i===void 0&&(W.font=e,i=W.measureText(t).width,Fn.set(n,i)),i}function N(t){return t.fontSize!=null?+t.fontSize||0:11}function j(t){return t.lineHeight!=null?t.lineHeight:N(t)+2}function Qs(t){return Z(t)?t.length>1?t:t[0]:t}function Mt(t){return Qs(t.lineBreak&&t.text&&!Z(t.text)?t.text.split(t.lineBreak):t.text)}function to(t){const e=Mt(t);return(Z(e)?e.length-1:0)*j(t)}function U(t,e){const n=e==null?"":(e+"").trim();return t.limit>0&&n.length?no(t,n):n}function eo(t){if(ft.width===Be){const e=Xt(t);return n=>Kn(n,e)}else{const e=N(t);return n=>Yn(n,e)}}function no(t,e){var n=+t.limit,i=eo(t);if(i(e)<n)return e;var r=t.ellipsis||"\u2026",s=t.dir==="rtl",o=0,l=e.length,a;if(n-=i(r),s){for(;o<l;)a=o+l>>>1,i(e.slice(a))>n?o=a+1:l=a;return r+e.slice(o)}else{for(;o<l;)a=1+(o+l>>>1),i(e.slice(0,a))<n?o=a:l=a-1;return e.slice(0,o)+r}}function Ct(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Xt(t,e){return""+(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+N(t)+"px "+Ct(t,e)}function Ge(t){var e=t.baseline,n=N(t);return Math.round(e==="top"?.79*n:e==="middle"?.3*n:e==="bottom"?-.21*n:e==="line-top"?.29*n+.5*j(t):e==="line-bottom"?.29*n-.5*j(t):0)}const io={left:"start",center:"middle",right:"end"},At=new z;function Ft(t){var e=t.x||0,n=t.y||0,i=t.radius||0,r;return i&&(r=(t.theta||0)-Q,e+=i*Math.cos(r),n+=i*Math.sin(r)),At.x1=e,At.y1=n,At}function ro(t,e){var n=e.dx||0,i=(e.dy||0)+Ge(e),r=Ft(e),s=r.x1,o=r.y1,l=e.angle||0,a;t("text-anchor",io[e.align]||"start"),l?(a=rt(s,o)+" "+Le(l),(n||i)&&(a+=" "+rt(n,i))):a=rt(s+n,o+i),t("transform",a)}function Ve(t,e,n){var i=ft.height(e),r=e.align,s=Ft(e),o=s.x1,l=s.y1,a=e.dx||0,h=(e.dy||0)+Ge(e)-Math.round(.8*i),c=Mt(e),u;if(Z(c)?(i+=j(e)*(c.length-1),u=c.reduce((f,d)=>Math.max(f,ft.width(e,d)),0)):u=ft.width(e,c),r==="center"?a-=u/2:r==="right"&&(a-=u),t.set(a+=o,h+=l,a+u,h+i),e.angle&&!n)t.rotate(e.angle*V,o,l);else if(n===2)return t.rotatedPoints(e.angle*V,o,l);return t}function so(t,e,n){L(e,i=>{var r=i.opacity==null?1:i.opacity,s,o,l,a,h,c,u;if(n&&!n.intersects(i.bounds)||r===0||i.fontSize<=0||i.text==null||i.text.length===0)return;if(t.font=Xt(i),t.textAlign=i.align||"left",s=Ft(i),o=s.x1,l=s.y1,i.angle&&(t.save(),t.translate(o,l),t.rotate(i.angle*V),o=l=0),o+=i.dx||0,l+=(i.dy||0)+Ge(i),c=Mt(i),ht(t,i),Z(c))for(h=j(i),a=0;a<c.length;++a)u=U(i,c[a]),i.fill&&Vt(t,i,r)&&t.fillText(u,o,l),i.stroke&&ut(t,i,r)&&t.strokeText(u,o,l),l+=h;else u=U(i,c),i.fill&&Vt(t,i,r)&&t.fillText(u,o,l),i.stroke&&ut(t,i,r)&&t.strokeText(u,o,l);i.angle&&t.restore()})}function oo(t,e,n,i,r,s){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var o=Ft(e),l=o.x1,a=o.y1,h=Ve(At,e,1),c=-e.angle*V,u=Math.cos(c),f=Math.sin(c),d=u*r-f*s+(l-u*l+f*a),p=f*r+u*s+(a-f*l-u*a);return h.contains(d,p)}function ao(t,e){const n=Ve(At,t,2);return ct(e,n[0],n[1],n[2],n[3])||ct(e,n[0],n[1],n[4],n[5])||ct(e,n[4],n[5],n[6],n[7])||ct(e,n[2],n[3],n[6],n[7])}var lo={type:"text",tag:"text",nested:!1,attr:ro,bound:Ve,draw:so,pick:Ht(oo),isect:ao},co=Ie("trail",os,ws),m={arc:ys,area:bs,group:Is,image:qs,line:Bs,path:$s,rect:js,rule:Ys,shape:Ks,symbol:Zs,text:lo,trail:co};function $e(t,e,n){var i=m[t.mark.marktype],r=e||i.bound;return i.nested&&(t=t.mark),r(t.bounds||(t.bounds=new z),t,n)}var Zn={mark:null};function Qn(t,e,n){var i=m[t.marktype],r=i.bound,s=t.items,o=s&&s.length,l,a,h,c;if(i.nested)return o?h=s[0]:(Zn.mark=t,h=Zn),c=$e(h,r,n),e=e&&e.union(c)||c,e;if(e=e||t.bounds&&t.bounds.clear()||new z,o)for(l=0,a=s.length;l<a;++l)e.union($e(s[l],r,n));return t.bounds=e}const ho=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function ti(t,e){return JSON.stringify(t,ho,e)}function ei(t){const e=typeof t=="string"?JSON.parse(t):t;return ni(e)}function ni(t){var e=t.marktype,n=t.items,i,r,s;if(n)for(r=0,s=n.length;r<s;++r)i=e?"mark":"group",n[r][i]=t,n[r].zindex&&(n[r][i].zdirty=!0),(e||i)==="group"&&ni(n[r]);return e&&Qn(t),t}function ii(t){arguments.length?this.root=ei(t):(this.root=ri({marktype:"group",name:"root",role:"frame"}),this.root.items=[new ke(this.root)])}ii.prototype={toJSON(t){return ti(this.root,t||0)},mark(t,e,n){e=e||this.root.items[0];const i=ri(t,e);return e.items[n]=i,i.zindex&&(i.group.zdirty=!0),i}};function ri(t,e){const n={bounds:new z,clip:!!t.clip,group:e,interactive:!(t.interactive===!1),items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0};return t.aria!=null&&(n.aria=t.aria),t.description&&(n.description=t.description),n}function X(t,e,n){return!t&&typeof document!="undefined"&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function He(t,e){e=e.toLowerCase();for(var n=t.childNodes,i=0,r=n.length;i<r;++i)if(n[i].tagName.toLowerCase()===e)return n[i]}function E(t,e,n,i){var r=t.childNodes[e],s;return(!r||r.tagName.toLowerCase()!==n.toLowerCase())&&(s=r||null,r=X(t.ownerDocument,n,i),t.insertBefore(r,s)),r}function I(t,e){for(var n=t.childNodes,i=n.length;i>e;)t.removeChild(n[--i]);return t}function si(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function We(t,e){const n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}function uo(t,e,n,i){var r=t&&t.mark,s,o;if(r&&(s=m[r.marktype]).tip){for(o=We(e,n),o[0]-=i[0],o[1]-=i[1];t=t.mark.group;)o[0]-=t.x||0,o[1]-=t.y||0;t=s.tip(r.items,o)}return t}function F(t,e){this._active=null,this._handlers={},this._loader=t||yn(),this._tooltip=e||fo}function fo(t,e,n,i){t.element().setAttribute("title",i||"")}F.prototype={initialize(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},scene(t){return arguments.length?(this._scene=t,this):this._scene},on(){},off(){},_handlerIndex(t,e,n){for(let i=t?t.length:0;--i>=0;)if(t[i].type===e&&(!n||t[i].handler===n))return i;return-1},handlers(t){const e=this._handlers,n=[];if(t)n.push(...e[this.eventName(t)]);else for(const i in e)n.push(...e[i]);return n},eventName(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)},handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then(i=>{const r=new MouseEvent(t.type,t),s=X(null,"a");for(const o in i)s.setAttribute(o,i[o]);s.dispatchEvent(r)}).catch(()=>{})},handleTooltip(t,e,n){if(e&&e.tooltip!=null){e=uo(e,t,this.canvas(),this._origin);const i=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,i)}},getItemBoundingClientRect(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),i=this._origin,r=t.bounds,s=r.width(),o=r.height();let l=r.x1+i[0]+n.left,a=r.y1+i[1]+n.top;for(;t.mark&&(t=t.mark.group);)l+=t.x||0,a+=t.y||0;return{x:l,y:a,width:s,height:o,left:l,top:a,right:l+s,bottom:a+o}}};function q(t){this._el=null,this._bgcolor=null,this._loader=new we(t)}q.prototype={initialize(t,e,n,i,r){return this._el=t,this.resize(e,n,i,r)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(t){return arguments.length===0?this._bgcolor:(this._bgcolor=t,this)},resize(t,e,n,i){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=i||1,this},dirty(){},render(t){const e=this;return e._call=function(){e._render(t)},e._call(),e._call=null,e},_render(){},renderAsync(t){const e=this.render(t);return this._ready?this._ready.then(()=>e):Promise.resolve(e)},_load(t,e){var n=this,i=n._loader[t](e);if(!n._ready){const r=n._call;n._ready=n._loader.ready().then(s=>{s&&r(),n._ready=null})}return i},sanitizeURL(t){return this._load("sanitizeURL",t)},loadImage(t){return this._load("loadImage",t)}};const po="keydown",go="keypress",vo="keyup",oi="dragenter",Jt="dragleave",ai="dragover",je="mousedown",yo="mouseup",Yt="mousemove",Rt="mouseout",li="mouseover",Kt="click",_o="dblclick",ko="wheel",ci="mousewheel",Zt="touchstart",Qt="touchmove",te="touchend",wo=[po,go,vo,oi,Jt,ai,je,yo,Yt,Rt,li,Kt,_o,ko,ci,Zt,Qt,te],Ue=Yt,zt=Rt,Xe=Kt;function Fe(t,e){F.call(this,t,e),this._down=null,this._touch=null,this._first=!0,this._events={}}const bo=t=>t===Zt||t===Qt||t===te?[Zt,Qt,te]:[t];function hi(t,e){bo(e).forEach(n=>xo(t,n))}function xo(t,e){const n=t.canvas();n&&!t._events[e]&&(t._events[e]=1,n.addEventListener(e,t[e]?i=>t[e](i):i=>t.fire(e,i)))}function ui(t,e,n){return function(i){const r=this._active,s=this.pickEvent(i);s===r?this.fire(t,i):((!r||!r.exit)&&this.fire(n,i),this._active=s,this.fire(e,i),this.fire(t,i))}}function fi(t){return function(e){this.fire(t,e),this._active=null}}ot(Fe,F,{initialize(t,e,n){return this._canvas=t&&He(t,"canvas"),[Kt,je,Yt,Rt,Jt].forEach(i=>hi(this,i)),F.prototype.initialize.call(this,t,e,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:wo,DOMMouseScroll(t){this.fire(ci,t)},mousemove:ui(Yt,li,Rt),dragover:ui(ai,oi,Jt),mouseout:fi(Rt),dragleave:fi(Jt),mousedown(t){this._down=this._active,this.fire(je,t)},click(t){this._down===this._active&&(this.fire(Kt,t),this._down=null)},touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(Zt,t,!0)},touchmove(t){this.fire(Qt,t,!0)},touchend(t){this.fire(te,t,!0),this._touch=null},fire(t,e,n){const i=n?this._touch:this._active,r=this._handlers[t];if(e.vegaType=t,t===Xe&&i&&i.href?this.handleHref(e,i,i.href):(t===Ue||t===zt)&&this.handleTooltip(e,i,t!==zt),r)for(let s=0,o=r.length;s<o;++s)r[s].handler.call(this._obj,e,i)},on(t,e){const n=this.eventName(t),i=this._handlers,r=this._handlerIndex(i[n],t,e);return r<0&&(hi(this,t),(i[n]||(i[n]=[])).push({type:t,handler:e})),this},off(t,e){const n=this.eventName(t),i=this._handlers[n],r=this._handlerIndex(i,t,e);return r>=0&&i.splice(r,1),this},pickEvent(t){const e=We(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},pick(t,e,n,i,r){const s=this.context(),o=m[t.marktype];return o.pick.call(this,s,t,e,n,i,r)}});function To(){return typeof window!="undefined"&&window.devicePixelRatio||1}var Mo=To();function Co(t,e,n,i,r,s){const o=typeof HTMLElement!="undefined"&&t instanceof HTMLElement&&t.parentNode!=null,l=t.getContext("2d"),a=o?Mo:r;t.width=e*a,t.height=n*a;for(const h in s)l[h]=s[h];return o&&a!==1&&(t.style.width=e+"px",t.style.height=n+"px"),l.pixelRatio=a,l.setTransform(a,0,0,a,a*i[0],a*i[1]),t}function ee(t){q.call(this,t),this._options={},this._redraw=!1,this._dirty=new z,this._tempb=new z}const di=q.prototype,Ao=(t,e,n)=>new z().set(0,0,e,n).translate(-t[0],-t[1]);function Ro(t,e,n){return e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio),e.translate(-(n[0]%1),-(n[1]%1)),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}ot(ee,q,{initialize(t,e,n,i,r,s){return this._options=s||{},this._canvas=this._options.externalContext?null:he(1,1,this._options.type),t&&this._canvas&&(I(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),di.initialize.call(this,t,e,n,i,r)},resize(t,e,n,i){if(di.resize.call(this,t,e,n,i),this._canvas)Co(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const r=this._options.externalContext;r||cn("CanvasRenderer is missing a valid canvas or context"),r.scale(this._scale,this._scale),r.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(t){const e=this._tempb.clear().union(t.bounds);let n=t.mark.group;for(;n;)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e)},_render(t){const e=this.context(),n=this._origin,i=this._width,r=this._height,s=this._dirty,o=Ao(n,i,r);e.save();const l=this._redraw||s.empty()?(this._redraw=!1,o.expand(1)):Ro(e,o.intersect(s),n);return this.clear(-n[0],-n[1],i,r),this.draw(e,t,l),e.restore(),s.clear(),this},draw(t,e,n){const i=m[e.marktype];e.clip&&xs(t,e),i.draw.call(this,t,e,n),e.clip&&t.restore()},clear(t,e,n,i){const r=this._options,s=this.context();r.type!=="pdf"&&!r.externalContext&&s.clearRect(t,e,n,i),this._bgcolor!=null&&(s.fillStyle=this._bgcolor,s.fillRect(t,e,n,i))}});function Je(t,e){F.call(this,t,e);const n=this;n._hrefHandler=Ye(n,(i,r)=>{r&&r.href&&n.handleHref(i,r,r.href)}),n._tooltipHandler=Ye(n,(i,r)=>{n.handleTooltip(i,r,i.type!==zt)})}const Ye=(t,e)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i,n.vegaType=n.type,e.call(t._obj,n,i)};ot(Je,F,{initialize(t,e,n){let i=this._svg;return i&&(i.removeEventListener(Xe,this._hrefHandler),i.removeEventListener(Ue,this._tooltipHandler),i.removeEventListener(zt,this._tooltipHandler)),this._svg=i=t&&He(t,"svg"),i&&(i.addEventListener(Xe,this._hrefHandler),i.addEventListener(Ue,this._tooltipHandler),i.addEventListener(zt,this._tooltipHandler)),F.prototype.initialize.call(this,t,e,n)},canvas(){return this._svg},on(t,e){const n=this.eventName(t),i=this._handlers,r=this._handlerIndex(i[n],t,e);if(r<0){const s={type:t,handler:e,listener:Ye(this,e)};(i[n]||(i[n]=[])).push(s),this._svg&&this._svg.addEventListener(n,s.listener)}return this},off(t,e){const n=this.eventName(t),i=this._handlers[n],r=this._handlerIndex(i,t,e);return r>=0&&(this._svg&&this._svg.removeEventListener(n,i[r].listener),i.splice(r,1)),this}});const pi="aria-hidden",Ke="aria-label",Ze="role",Qe="aria-roledescription",gi="graphics-object",tn="graphics-symbol",vi=(t,e,n)=>({[Ze]:t,[Qe]:e,[Ke]:n||void 0}),zo=Hi(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),yi={axis:{desc:"axis",caption:Po},legend:{desc:"legend",caption:Lo},"title-text":{desc:"title",caption:t=>"Title text '".concat(bi(t),"'")},"title-subtitle":{desc:"subtitle",caption:t=>"Subtitle text '".concat(bi(t),"'")}},_i={ariaRole:Ze,ariaRoleDescription:Qe,description:Ke};function ki(t,e){const n=e.aria===!1;if(t(pi,n||void 0),n||e.description==null)for(const i in _i)t(_i[i],void 0);else{const i=e.mark.marktype;t(Ke,e.description),t(Ze,e.ariaRole||(i==="group"?gi:tn)),t(Qe,e.ariaRoleDescription||"".concat(i," mark"))}}function wi(t){return t.aria===!1?{[pi]:!0}:zo[t.role]?null:yi[t.role]?So(t,yi[t.role]):Eo(t)}function Eo(t){const e=t.marktype,n=e==="group"||e==="text"||t.items.some(i=>i.description!=null&&i.aria!==!1);return vi(n?gi:tn,"".concat(e," mark container"),t.description)}function So(t,e){try{const n=t.items[0],i=e.caption||(()=>"");return vi(e.role||tn,e.desc,n.description||i(n))}catch(n){return null}}function bi(t){return dn(t.text).join(" ")}function Po(t){const e=t.datum,n=t.orient,i=e.title?xi(t):null,r=t.context,s=r.scales[e.scale].value,o=r.dataflow.locale(),l=s.type,a=n==="left"||n==="right"?"Y":"X";return"".concat(a,"-axis")+(i?" titled '".concat(i,"'"):"")+" for a ".concat(dr(l)?"discrete":l," scale")+" with ".concat(_n(o,s,t))}function Lo(t){const e=t.datum,n=e.title?xi(t):null,i="".concat(e.type||""," legend").trim(),r=e.scales,s=Object.keys(r),o=t.context,l=o.scales[r[s[0]]].value,a=o.dataflow.locale();return Io(i)+(n?" titled '".concat(n,"'"):"")+" for ".concat(mo(s))+" with ".concat(_n(a,l,t))}function xi(t){try{return dn(pn(t.items).items[0].text).join(" ")}catch(e){return null}}function mo(t){return t=t.map(e=>e+(e==="fill"||e==="stroke"?" color":"")),t.length<2?t[0]:t.slice(0,-1).join(", ")+" and "+pn(t)}function Io(t){return t.length?t[0].toUpperCase()+t.slice(1):t}const Ti=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Oo=t=>Ti(t).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function en(){let t="",e="",n="";const i=[],r=()=>e=n="",s=a=>{e&&(t+="".concat(e,">").concat(n),r()),i.push(a)},o=(a,h)=>(h!=null&&(e+=" ".concat(a,'="').concat(Oo(h),'"')),l),l={open(a){s(a),e="<"+a;for(var h=arguments.length,c=new Array(h>1?h-1:0),u=1;u<h;u++)c[u-1]=arguments[u];for(const f of c)for(const d in f)o(d,f[d]);return l},close(){const a=i.pop();return e?t+=e+(n?">".concat(n,"</").concat(a,">"):"/>"):t+="</".concat(a,">"),r(),l},attr:o,text:a=>(n+=Ti(a),l),toString:()=>t};return l}const Mi=t=>Ci(en(),t)+"";function Ci(t,e){if(t.open(e.tagName),e.hasAttributes()){const n=e.attributes,i=n.length;for(let r=0;r<i;++r)t.attr(n[r].name,n[r].value)}if(e.hasChildNodes()){const n=e.childNodes;for(const i of n)i.nodeType===3?t.text(i.nodeValue):Ci(t,i)}return t.close()}const ne={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},ie={blend:"mix-blend-mode"},Ai={fill:"none","stroke-miterlimit":10},Et=0,Ri="http://www.w3.org/2000/xmlns/",w=Tt.xmlns;function nn(t){q.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const rn=q.prototype;ot(nn,q,{initialize(t,e,n,i,r){return this._defs={},this._clearDefs(),t&&(this._svg=E(t,0,"svg",w),this._svg.setAttributeNS(Ri,"xmlns",w),this._svg.setAttributeNS(Ri,"xmlns:xlink",Tt["xmlns:xlink"]),this._svg.setAttribute("version",Tt.version),this._svg.setAttribute("class","marks"),I(t,1),this._root=E(this._svg,Et,"g",w),J(this._root,Ai),I(this._svg,Et+1)),this.background(this._bgcolor),rn.initialize.call(this,t,e,n,i,r)},background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),rn.background.apply(this,arguments)},resize(t,e,n,i){return rn.resize.call(this,t,e,n,i),this._svg&&(J(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}),this._root.setAttribute("transform","translate(".concat(this._origin,")"))),this._dirty=[],this},canvas(){return this._svg},svg(){const t=this._svg,e=this._bgcolor;if(!t)return null;let n;e&&(t.removeAttribute("style"),n=E(t,Et,"rect",w),J(n,{width:this._width,height:this._height,fill:e}));const i=Mi(t);return e&&(t.removeChild(n),this._svg.style.setProperty("background-color",e)),i},_render(t){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t),I(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},isDirty(t){return this._dirtyAll||!t._svg||!t._svg.ownerSVGElement||t.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const e=++this._dirtyID;let n,i,r,s,o,l,a;for(o=0,l=t.length;o<l;++o){if(n=t[o],i=n.mark,i.marktype!==r&&(r=i.marktype,s=m[r]),i.zdirty&&i.dirty!==e&&(this._dirtyAll=!1,zi(n,e),i.items.forEach(h=>{h.dirty=e})),i.zdirty)continue;if(n.exit){s.nested&&i.items.length?(a=i.items[0],a._svg&&this._update(s,a._svg,a)):n._svg&&(a=n._svg.parentNode,a&&a.removeChild(n._svg)),n._svg=null;continue}if(n=s.nested?i.items[0]:n,n._update===e)continue;!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,zi(n,e)):this._update(s,n._svg,n),n._update=e}return!this._dirtyAll},mark(t,e,n){if(!this.isDirty(e))return e._svg;const i=this._svg,r=m[e.marktype],s=e.interactive===!1?"none":null,o=r.tag==="g",l=Ei(e,t,n,"g",i);l.setAttribute("class",si(e));const a=wi(e);for(const f in a)M(l,f,a[f]);o||M(l,"pointer-events",s),M(l,"clip-path",e.clip?ye(this,e,e.group):null);let h=null,c=0;const u=f=>{const d=this.isDirty(f),p=Ei(f,l,h,r.tag,i);d&&(this._update(r,p,f),o&&qo(this,p,f)),h=p,++c};return r.nested?e.items.length&&u(e.items[0]):L(e,u),I(l,c),l},_update(t,e,n){G=e,T=e.__values__,ki(St,n),t.attr(St,n,this);const i=Go[t.type];i&&i.call(this,t,e,n),G&&this.style(G,n)},style(t,e){if(e==null)return;for(const n in ne){let i=n==="font"?Ct(e):e[n];if(i===T[n])continue;const r=ne[n];i==null?t.removeAttribute(r):(ue(i)&&(i=wn(i,this._defs.gradient,Si())),t.setAttribute(r,i+"")),T[n]=i}for(const n in ie)re(t,ie[n],e[n])},defs(){const t=this._svg,e=this._defs;let n=e.el,i=0;for(const r in e.gradient)n||(e.el=n=E(t,Et+1,"defs",w)),i=Do(n,e.gradient[r],i);for(const r in e.clipping)n||(e.el=n=E(t,Et+1,"defs",w)),i=No(n,e.clipping[r],i);n&&(i===0?(t.removeChild(n),e.el=null):I(n,i))},_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}});function zi(t,e){for(;t&&t.dirty!==e;t=t.mark.group)if(t.dirty=e,t.mark&&t.mark.dirty!==e)t.mark.dirty=e;else return}function Do(t,e,n){let i,r,s;if(e.gradient==="radial"){let o=E(t,n++,"pattern",w);J(o,{id:Lt+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),o=E(o,0,"rect",w),J(o,{width:1,height:1,fill:"url(".concat(Si(),"#").concat(e.id,")")}),t=E(t,n++,"radialGradient",w),J(t,{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else t=E(t,n++,"linearGradient",w),J(t,{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2});for(i=0,r=e.stops.length;i<r;++i)s=E(t,i,"stop",w),s.setAttribute("offset",e.stops[i].offset),s.setAttribute("stop-color",e.stops[i].color);return I(t,i),n}function No(t,e,n){let i;return t=E(t,n,"clipPath",w),t.setAttribute("id",e.id),e.path?(i=E(t,0,"path",w),i.setAttribute("d",e.path)):(i=E(t,0,"rect",w),J(i,{x:0,y:0,width:e.width,height:e.height})),I(t,1),n+1}function qo(t,e,n){e=e.lastChild.previousSibling;let i,r=0;L(n,s=>{i=t.mark(e,s,i),++r}),I(e,1+r)}function Ei(t,e,n,i,r){let s=t._svg,o;if(!s&&(o=e.ownerDocument,s=X(o,i,w),t._svg=s,t.mark&&(s.__data__=t,s.__values__={fill:"default"},i==="g"))){const l=X(o,"path",w);s.appendChild(l),l.__data__=t;const a=X(o,"g",w);s.appendChild(a),a.__data__=t;const h=X(o,"path",w);s.appendChild(h),h.__data__=t,h.__values__={fill:"default"}}return(s.ownerSVGElement!==r||Bo(s,n))&&e.insertBefore(s,n?n.nextSibling:e.firstChild),s}function Bo(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}let G=null,T=null;const Go={group(t,e,n){const i=G=e.childNodes[2];T=i.__values__,t.foreground(St,n,this),T=e.__values__,G=e.childNodes[1],t.content(St,n,this);const r=G=e.childNodes[0];t.background(St,n,this);const s=n.mark.interactive===!1?"none":null;if(s!==T.events&&(M(i,"pointer-events",s),M(r,"pointer-events",s),T.events=s),n.strokeForeground&&n.stroke){const o=n.fill;M(i,"display",null),this.style(r,n),M(r,"stroke",null),o&&(n.fill=null),T=i.__values__,this.style(i,n),o&&(n.fill=o),G=null}else M(i,"display","none")},image(t,e,n){n.smooth===!1?(re(e,"image-rendering","optimizeSpeed"),re(e,"image-rendering","pixelated")):re(e,"image-rendering",null)},text(t,e,n){const i=Mt(n);let r,s,o,l;Z(i)?(s=i.map(a=>U(n,a)),r=s.join(`
`),r!==T.text&&(I(e,0),o=e.ownerDocument,l=j(n),s.forEach((a,h)=>{const c=X(o,"tspan",w);c.__data__=n,c.textContent=a,h&&(c.setAttribute("x",0),c.setAttribute("dy",l)),e.appendChild(c)}),T.text=r)):(s=U(n,i),s!==T.text&&(e.textContent=s,T.text=s)),M(e,"font-family",Ct(n)),M(e,"font-size",N(n)+"px"),M(e,"font-style",n.fontStyle),M(e,"font-variant",n.fontVariant),M(e,"font-weight",n.fontWeight)}};function St(t,e,n){if(e===T[t])return;n?Vo(G,t,e,n):M(G,t,e),T[t]=e}function re(t,e,n){n!==T[e]&&(n==null?t.style.removeProperty(e):t.style.setProperty(e,n+""),T[e]=n)}function J(t,e){for(const n in e)M(t,n,e[n])}function M(t,e,n){n!=null?t.setAttribute(e,n):t.removeAttribute(e)}function Vo(t,e,n,i){n!=null?t.setAttributeNS(i,e,n):t.removeAttributeNS(i,e)}function Si(){let t;return typeof window=="undefined"?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function sn(t){q.call(this,t),this._text=null,this._defs={gradient:{},clipping:{}}}ot(sn,q,{svg(){return this._text},_render(t){const e=en();e.open("svg",Wi({},Tt,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&e.open("rect",{width:this._width,height:this._height,fill:n}).close(),e.open("g",Ai,{transform:"translate("+this._origin+")"}),this.mark(e,t),e.close(),this.defs(e),this._text=e.close()+"",this},mark(t,e){const n=m[e.marktype],i=n.tag,r=[ki,n.attr];t.open("g",{class:si(e),"clip-path":e.clip?ye(this,e,e.group):null},wi(e),{"pointer-events":i!=="g"&&e.interactive===!1?"none":null});const s=o=>{const l=this.href(o);if(l&&t.open("a",l),t.open(i,this.attr(e,o,r,i!=="g"?i:null)),i==="text"){const a=Mt(o);if(Z(a)){const h={x:0,dy:j(o)};for(let c=0;c<a.length;++c)t.open("tspan",c?h:null).text(U(o,a[c])).close()}else t.text(U(o,a))}else if(i==="g"){const a=o.strokeForeground,h=o.fill,c=o.stroke;a&&c&&(o.stroke=null),t.open("path",this.attr(e,o,n.background,"bgrect")).close(),t.open("g",this.attr(e,o,n.content)),L(o,u=>this.mark(t,u)),t.close(),a&&c?(h&&(o.fill=null),o.stroke=c,t.open("path",this.attr(e,o,n.foreground,"bgrect")).close(),h&&(o.fill=h)):t.open("path",this.attr(e,o,n.foreground,"bgfore")).close()}t.close(),l&&t.close()};return n.nested?e.items&&e.items.length&&s(e.items[0]):L(e,s),t.close()},href(t){const e=t.href;let n;if(e){if(n=this._hrefs&&this._hrefs[e])return n;this.sanitizeURL(e).then(i=>{i["xlink:href"]=i.href,i.href=null,(this._hrefs||(this._hrefs={}))[e]=i})}return null},attr(t,e,n,i){const r={},s=(o,l,a,h)=>{r[h||o]=l};return Array.isArray(n)?n.forEach(o=>o(s,e,this)):n(s,e,this),i&&$o(r,e,t,i,this._defs),r},defs(t){const e=this._defs.gradient,n=this._defs.clipping,i=Object.keys(e).length+Object.keys(n).length;if(i===0)return;t.open("defs");for(const r in e){const s=e[r],o=s.stops;s.gradient==="radial"?(t.open("pattern",{id:Lt+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+r+")"}).close(),t.close(),t.open("radialGradient",{id:r,fx:s.x1,fy:s.y1,fr:s.r1,cx:s.x2,cy:s.y2,r:s.r2})):t.open("linearGradient",{id:r,x1:s.x1,x2:s.x2,y1:s.y1,y2:s.y2});for(let l=0;l<o.length;++l)t.open("stop",{offset:o[l].offset,"stop-color":o[l].color}).close();t.close()}for(const r in n){const s=n[r];t.open("clipPath",{id:r}),s.path?t.open("path",{d:s.path}).close():t.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),t.close()}t.close()}});function $o(t,e,n,i,r){let s;if(e==null)return t;if(i==="bgrect"&&n.interactive===!1&&(t["pointer-events"]="none"),i==="bgfore"&&(n.interactive===!1&&(t["pointer-events"]="none"),t.display="none",e.fill!==null))return t;i==="image"&&e.smooth===!1&&(s=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),i==="text"&&(t["font-family"]=Ct(e),t["font-size"]=N(e)+"px",t["font-style"]=e.fontStyle,t["font-variant"]=e.fontVariant,t["font-weight"]=e.fontWeight);for(const o in ne){let l=e[o];const a=ne[o];l==="transparent"&&(a==="fill"||a==="stroke")||l!=null&&(ue(l)&&(l=wn(l,r.gradient,"")),t[a]=l)}for(const o in ie){const l=e[o];l!=null&&(s=s||[],s.push("".concat(ie[o],": ").concat(l,";")))}return s&&(t.style=s.join(" ")),t}const Pi="canvas",Li="png",mi="svg",Ii="none",Ho={Canvas:Pi,PNG:Li,SVG:mi,None:Ii},dt={};dt[Pi]=dt[Li]={renderer:ee,headless:ee,handler:Fe},dt[mi]={renderer:nn,headless:sn,handler:Je},dt[Ii]={};function Wo(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(dt[t]=e,this):dt[t]}function jo(t,e,n){const i=[],r=new z().union(e),s=t.marktype;return s?Oi(t,r,n,i):s==="group"?Di(t,r,n,i):cn("Intersect scene must be mark node or group item.")}function Oi(t,e,n,i){if(Uo(t,e,n)){const r=t.items,s=t.marktype,o=r.length;let l=0;if(s==="group")for(;l<o;++l)Di(r[l],e,n,i);else for(const a=m[s].isect;l<o;++l){const h=r[l];Ni(h,e,a)&&i.push(h)}}return i}function Uo(t,e,n){return t.bounds&&e.intersects(t.bounds)&&(t.marktype==="group"||t.interactive!==!1&&(!n||n(t)))}function Di(t,e,n,i){n&&n(t.mark)&&Ni(t,e,m.group.isect)&&i.push(t);const r=t.items,s=r&&r.length;if(s){const o=t.x||0,l=t.y||0;e.translate(-o,-l);for(let a=0;a<s;++a)Oi(r[a],e,n,i);e.translate(o,l)}return i}function Ni(t,e,n){const i=t.bounds;return e.encloses(i)||e.intersects(i)&&n(t,e)}const on=new z;function Xo(t){const e=t.clip;if(ce(e))e(wt(on.clear()));else if(e)on.set(0,0,t.group.width,t.group.height);else return;t.bounds.intersect(on)}const Fo=1e-9;function an(t,e,n){return t===e?!0:n==="path"?qi(t,e):t instanceof Date&&e instanceof Date?+t===+e:hn(t)&&hn(e)?Math.abs(t-e)<=Fo:!t||!e||!un(t)&&!un(e)?t==e:Jo(t,e)}function qi(t,e){return an(gt(t),gt(e))}function Jo(t,e){var n=Object.keys(t),i=Object.keys(e),r,s;if(n.length!==i.length)return!1;for(n.sort(),i.sort(),s=n.length-1;s>=0;s--)if(n[s]!=i[s])return!1;for(s=n.length-1;s>=0;s--)if(r=n[s],!an(t[r],e[r],r))return!1;return typeof t===typeof e}function Yo(){Sn(),pr()}export{z as Bounds,Fe as CanvasHandler,ee as CanvasRenderer,gr as Gradient,ke as GroupItem,F as Handler,_e as Item,m as Marks,Ho as RenderType,q as Renderer,we as ResourceLoader,Je as SVGHandler,nn as SVGRenderer,sn as SVGStringRenderer,ii as Scenegraph,Xo as boundClip,wt as boundContext,$e as boundItem,Qn as boundMark,tt as boundStroke,E as domChild,I as domClear,X as domCreate,He as domFind,Xt as font,Ct as fontFamily,N as fontSize,jo as intersect,ct as intersectBoxLine,Re as intersectPath,ze as intersectPoint,qn as intersectRule,j as lineHeight,en as markup,to as multiLineOffset,fe as pathCurves,qi as pathEqual,gt as pathParse,Rn as pathRectangle,mt as pathRender,An as pathSymbols,zn as pathTrail,We as point,Wo as renderModule,Sn as resetSVGClipId,Yo as resetSVGDefIds,an as sceneEqual,ei as sceneFromJSON,$t as scenePickVisit,ti as sceneToJSON,L as sceneVisit,Ee as sceneZOrder,Mi as serializeXML,ft as textMetrics};export default null;
