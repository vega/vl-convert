/**
 * Bundled by jsDelivr using Rollup v2.79.2 and Terser v5.39.0.
 * Original file: /npm/fast-json-patch@3.1.1/index.mjs
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */
var e,t=(e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)},function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),r=Object.prototype.hasOwnProperty;function n(e,t){return r.call(e,t)}function o(e){if(Array.isArray(e)){for(var t=new Array(e.length),r=0;r<t.length;r++)t[r]=""+r;return t}if(Object.keys)return Object.keys(e);var o=[];for(var a in e)n(e,a)&&o.push(a);return o}function a(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function i(e){for(var t,r=0,n=e.length;r<n;){if(!((t=e.charCodeAt(r))>=48&&t<=57))return!1;r++}return!0}function p(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function u(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function s(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var t=0,r=e.length;t<r;t++)if(s(e[t]))return!0}else if("object"==typeof e)for(var n=o(e),a=n.length,i=0;i<a;i++)if(s(e[n[i]]))return!0;return!1}function f(e,t){var r=[e];for(var n in t){var o="object"==typeof t[n]?JSON.stringify(t[n],null,2):t[n];void 0!==o&&r.push(n+": "+o)}return r.join("\n")}var c=function(e){function r(t,r,n,o,a){var i=this.constructor,p=e.call(this,f(t,{name:r,index:n,operation:o,tree:a}))||this;return p.name=r,p.index=n,p.operation=o,p.tree=a,Object.setPrototypeOf(p,i.prototype),p.message=f(t,{name:r,index:n,operation:o,tree:a}),p}return t(r,e),r}(Error),l=c,h=a,v={add:function(e,t,r){return e[t]=this.value,{newDocument:r}},remove:function(e,t,r){var n=e[t];return delete e[t],{newDocument:r,removed:n}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:function(e,t,r){var n=w(r,this.path);n&&(n=a(n));var o=y(r,{op:"remove",path:this.from}).removed;return y(r,{op:"add",path:this.path,value:o}),{newDocument:r,removed:n}},copy:function(e,t,r){var n=w(r,this.from);return y(r,{op:"add",path:this.path,value:a(n)}),{newDocument:r}},test:function(e,t,r){return{newDocument:r,test:E(e[t],this.value)}},_get:function(e,t,r){return this.value=e[t],{newDocument:r}}},d={add:function(e,t,r){return i(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:r,index:t}},remove:function(e,t,r){return{newDocument:r,removed:e.splice(t,1)[0]}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:v.move,copy:v.copy,test:v.test,_get:v._get};function w(e,t){if(""==t)return e;var r={op:"_get",path:t};return y(e,r),r.value}function y(e,t,r,n,o,p){if(void 0===r&&(r=!1),void 0===n&&(n=!0),void 0===o&&(o=!0),void 0===p&&(p=0),r&&("function"==typeof r?r(t,0,e,t.path):_(t,0)),""===t.path){var s={newDocument:e};if("add"===t.op)return s.newDocument=t.value,s;if("replace"===t.op)return s.newDocument=t.value,s.removed=e,s;if("move"===t.op||"copy"===t.op)return s.newDocument=w(e,t.from),"move"===t.op&&(s.removed=e),s;if("test"===t.op){if(s.test=E(e,t.value),!1===s.test)throw new l("Test operation failed","TEST_OPERATION_FAILED",p,t,e);return s.newDocument=e,s}if("remove"===t.op)return s.removed=e,s.newDocument=null,s;if("_get"===t.op)return t.value=e,s;if(r)throw new l("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",p,t,e);return s}n||(e=a(e));var f=(t.path||"").split("/"),c=e,h=1,y=f.length,O=void 0,A=void 0,m=void 0;for(m="function"==typeof r?r:_;;){if((A=f[h])&&-1!=A.indexOf("~")&&(A=u(A)),o&&("__proto__"==A||"prototype"==A&&h>0&&"constructor"==f[h-1]))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(r&&void 0===O&&(void 0===c[A]?O=f.slice(0,h).join("/"):h==y-1&&(O=t.path),void 0!==O&&m(t,0,e,O)),h++,Array.isArray(c)){if("-"===A)A=c.length;else{if(r&&!i(A))throw new l("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",p,t,e);i(A)&&(A=~~A)}if(h>=y){if(r&&"add"===t.op&&A>c.length)throw new l("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",p,t,e);if(!1===(s=d[t.op].call(t,c,A,e)).test)throw new l("Test operation failed","TEST_OPERATION_FAILED",p,t,e);return s}}else if(h>=y){if(!1===(s=v[t.op].call(t,c,A,e)).test)throw new l("Test operation failed","TEST_OPERATION_FAILED",p,t,e);return s}if(c=c[A],r&&h<y&&(!c||"object"!=typeof c))throw new l("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",p,t,e)}}function O(e,t,r,n,o){if(void 0===n&&(n=!0),void 0===o&&(o=!0),r&&!Array.isArray(t))throw new l("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");n||(e=a(e));for(var i=new Array(t.length),p=0,u=t.length;p<u;p++)i[p]=y(e,t[p],r,!0,o,p),e=i[p].newDocument;return i.newDocument=e,i}function A(e,t,r){var n=y(e,t);if(!1===n.test)throw new l("Test operation failed","TEST_OPERATION_FAILED",r,t,e);return n.newDocument}function _(e,t,r,n){if("object"!=typeof e||null===e||Array.isArray(e))throw new l("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,r);if(!v[e.op])throw new l("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,r);if("string"!=typeof e.path)throw new l("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,r);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new l('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,r);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new l("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,r);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new l("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,r);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&s(e.value))throw new l("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,r);if(r)if("add"==e.op){var o=e.path.split("/").length,a=n.split("/").length;if(o!==a+1&&o!==a)throw new l("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,r)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==n)throw new l("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,r)}else if("move"===e.op||"copy"===e.op){var i=m([{op:"_get",path:e.from,value:void 0}],r);if(i&&"OPERATION_PATH_UNRESOLVABLE"===i.name)throw new l("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,r)}}function m(e,t,r){try{if(!Array.isArray(e))throw new l("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)O(a(t),a(e),r||!0);else{r=r||_;for(var n=0;n<e.length;n++)r(e[n],n,t,void 0)}}catch(e){if(e instanceof l)return e;throw e}}function E(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var r,n,o,a=Array.isArray(e),i=Array.isArray(t);if(a&&i){if((n=e.length)!=t.length)return!1;for(r=n;0!=r--;)if(!E(e[r],t[r]))return!1;return!0}if(a!=i)return!1;var p=Object.keys(e);if((n=p.length)!==Object.keys(t).length)return!1;for(r=n;0!=r--;)if(!t.hasOwnProperty(p[r]))return!1;for(r=n;0!=r--;)if(!E(e[o=p[r]],t[o]))return!1;return!0}return e!=e&&t!=t}var g=Object.freeze({__proto__:null,JsonPatchError:l,deepClone:h,getValueByPointer:w,applyOperation:y,applyPatch:O,applyReducer:A,validator:_,validate:m,_areEquals:E}),T=new WeakMap,N=function(e){this.observers=new Map,this.obj=e},b=function(e,t){this.callback=e,this.observer=t};
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */function P(e,t){t.unobserve()}function R(e,t){var r,n=function(e){return T.get(e)}(e);if(n){var o=function(e,t){return e.observers.get(t)}(n,t);r=o&&o.observer}else n=new N(e),T.set(e,n);if(r)return r;if(r={},n.value=a(e),t){r.callback=t,r.next=null;var i=function(){I(r)},p=function(){clearTimeout(r.next),r.next=setTimeout(i)};"undefined"!=typeof window&&(window.addEventListener("mouseup",p),window.addEventListener("keyup",p),window.addEventListener("mousedown",p),window.addEventListener("keydown",p),window.addEventListener("change",p))}return r.patches=[],r.object=e,r.unobserve=function(){I(r),clearTimeout(r.next),function(e,t){e.observers.delete(t.callback)}(n,r),"undefined"!=typeof window&&(window.removeEventListener("mouseup",p),window.removeEventListener("keyup",p),window.removeEventListener("mousedown",p),window.removeEventListener("keydown",p),window.removeEventListener("change",p))},n.observers.set(t,new b(t,r)),r}function I(e,t){void 0===t&&(t=!1);var r=T.get(e.object);D(r.value,e.object,e.patches,"",t),e.patches.length&&O(r.value,e.patches);var n=e.patches;return n.length>0&&(e.patches=[],e.callback&&e.callback(n)),n}function D(e,t,r,i,u){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var s=o(t),f=o(e),c=!1,l=f.length-1;l>=0;l--){var h=e[d=f[l]];if(!n(t,d)||void 0===t[d]&&void 0!==h&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(u&&r.push({op:"test",path:i+"/"+p(d),value:a(h)}),r.push({op:"remove",path:i+"/"+p(d)}),c=!0):(u&&r.push({op:"test",path:i,value:e}),r.push({op:"replace",path:i,value:t}));else{var v=t[d];"object"==typeof h&&null!=h&&"object"==typeof v&&null!=v&&Array.isArray(h)===Array.isArray(v)?D(h,v,r,i+"/"+p(d),u):h!==v&&(u&&r.push({op:"test",path:i+"/"+p(d),value:a(h)}),r.push({op:"replace",path:i+"/"+p(d),value:a(v)}))}}if(c||s.length!=f.length)for(l=0;l<s.length;l++){var d;n(e,d=s[l])||void 0===t[d]||r.push({op:"add",path:i+"/"+p(d),value:a(t[d])})}}}function L(e,t,r){void 0===r&&(r=!1);var n=[];return D(e,t,n,"",r),n}var j=Object.freeze({__proto__:null,unobserve:P,observe:R,generate:I,compare:L}),x=Object.assign({},g,j,{JsonPatchError:c,deepClone:a,escapePathComponent:p,unescapePathComponent:u});export{c as JsonPatchError,E as _areEquals,y as applyOperation,O as applyPatch,A as applyReducer,L as compare,a as deepClone,x as default,p as escapePathComponent,I as generate,w as getValueByPointer,R as observe,u as unescapePathComponent,P as unobserve,m as validate,_ as validator};
//# sourceMappingURL=/sm/0712a4ade0e1aa1bde9b3aa2748bd09fcf33fe3241aed7ddc56346712514ebcb.map