import{t as Ze,L as et,N as tt,O as st,P as nt,Q as it,R as rt,T as at,U as lt,W as ot,X as ct,Y as ut,Z as dt,_ as ht,$ as pt,a0 as ft,a1 as yt,a2 as mt,a3 as gt,a4 as vt,n as wt,D as $,V as T,b as ye,m as f,a5 as Bt,a6 as bt,a7 as me,a8 as _t,a9 as Tt,aa as Y,ab as ge,ac as Ct,ad as ve,ae as It,af as we,ag as Be,ah as Vt}from"./vector-2228b801.js";import{Type as z}from"../apache-arrow/enum.js";import{__asyncGenerator as St,__asyncValues as xt,__await as j}from"/-/tslib@v2.6.2-OVagwiLDRFa7T0n3eDR1/dist=es2020,mode=imports,min/optimized/tslib.js";import{Field as C,Schema as w}from"../apache-arrow/schema.js";import{G as be,M as Mt,L as _e,O as At,S as v,A as Dt,D as q,N as G,j as Ft,k as Ut,c as kt,d as Lt,B as Ot,p as Nt}from"./type-9c6ae821.js";import{Visitor as Te}from"../apache-arrow/visitor.js";import{V as E,a as Ce,B as M,b as zt,F as V,O as jt,D as Ie}from"./builder-7443288c.js";class K extends E{constructor(e){super(e);this._values=new Ce(new Uint8Array(0))}get byteLength(){let e=this._pendingLength+this.length*4;return this._offsets&&(e+=this._offsets.byteLength),this._values&&(e+=this._values.byteLength),this._nulls&&(e+=this._nulls.byteLength),e}setValue(e,t){return super.setValue(e,Ze(t))}_flushPending(e,t){const n=this._offsets,i=this._values.reserve(t).buffer;let r=0;for(const[a,l]of e)if(l===void 0)n.set(a,0);else{const o=l.length;i.set(l,r),n.set(a,o),r+=o}}}class Ve extends M{constructor(e){super(e);this._values=new zt}setValue(e,t){this._values.set(e,+t)}}class F extends V{}F.prototype._setValue=et;class H extends F{}H.prototype._setValue=tt;class J extends F{}J.prototype._setValue=st;class Q extends V{}Q.prototype._setValue=nt;class Se extends M{constructor({type:e,nullValues:t,dictionaryHashFunction:n}){super({type:new be(e.dictionary,e.indices,e.id,e.isOrdered)});this._nulls=null,this._dictionaryOffset=0,this._keysToIndices=Object.create(null),this.indices=A({type:this.type.indices,nullValues:t}),this.dictionary=A({type:this.type.dictionary,nullValues:null}),typeof n=="function"&&(this.valueToKey=n)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(e){return this.indices.isValid(e)}setValid(e,t){const n=this.indices;return t=n.setValid(e,t),this.length=n.length,t}setValue(e,t){const n=this._keysToIndices,i=this.valueToKey(t);let r=n[i];return r===void 0&&(n[i]=r=this._dictionaryOffset+this.dictionary.append(t).length-1),this.indices.setValue(e,r)}flush(){const e=this.type,t=this._dictionary,n=this.dictionary.toVector(),i=this.indices.flush().clone(e);return i.dictionary=t?t.concat(n):n,this.finished||(this._dictionaryOffset+=n.length),this._dictionary=i.dictionary,this.clear(),i}finish(){return this.indices.finish(),this.dictionary.finish(),this._dictionaryOffset=0,this._keysToIndices=Object.create(null),super.finish()}clear(){return this.indices.clear(),this.dictionary.clear(),super.clear()}valueToKey(e){return typeof e=="string"?e:`${e}`}}class X extends V{}X.prototype._setValue=it;class xe extends M{setValue(e,t){const[n]=this.children,i=e*this.stride;for(let r=-1,a=t.length;++r<a;)n.set(i+r,t[r])}addChild(e,t="0"){if(this.numChildren>0)throw new Error("FixedSizeListBuilder can only have one child.");const n=this.children.push(e);return this.type=new Mt(this.type.listSize,new C(t,e.type,!0)),n}}class U extends V{setValue(e,t){this._values.set(e,t)}}class Me extends U{setValue(e,t){super.setValue(e,rt(t))}}class Ae extends U{}class De extends U{}class k extends V{}k.prototype._setValue=at;class Z extends k{}Z.prototype._setValue=lt;class ee extends k{}ee.prototype._setValue=ot;class B extends V{setValue(e,t){this._values.set(e,t)}}class Fe extends B{}class Ue extends B{}class ke extends B{}class Le extends B{}class Oe extends B{}class Ne extends B{}class ze extends B{}class je extends B{}class Ee extends E{constructor(e){super(e);this._offsets=new jt}addChild(e,t="0"){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=e,this.type=new _e(new C(t,e.type,!0)),this.numChildren-1}_flushPending(e){const t=this._offsets,[n]=this.children;for(const[i,r]of e)if(typeof r=="undefined")t.set(i,0);else{const a=r,l=a.length,o=t.set(i,l).buffer[i];for(let c=-1;++c<l;)n.set(o+c,a[c])}}}class Re extends E{set(e,t){return super.set(e,t)}setValue(e,t){const n=t instanceof Map?t:new Map(Object.entries(t)),i=this._pending||(this._pending=new Map),r=i.get(e);r&&(this._pendingLength-=r.size),this._pendingLength+=n.size,i.set(e,n)}addChild(e,t=`${this.numChildren}`){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=e,this.type=new At(new C(t,e.type,!0),this.type.keysSorted),this.numChildren-1}_flushPending(e){const t=this._offsets,[n]=this.children;for(const[i,r]of e)if(r===void 0)t.set(i,0);else{let{[i]:a,[i+1]:l}=t.set(i,r.size).buffer;for(const o of r.entries())if(n.set(a,o),++a>=l)break}}}class Pe extends M{setValue(e,t){}setValid(e,t){return this.length=Math.max(e+1,this.length),t}}class We extends M{setValue(e,t){const{children:n,type:i}=this;switch(Array.isArray(t)||t.constructor){case!0:return i.children.forEach((r,a)=>n[a].set(e,t[a]));case Map:return i.children.forEach((r,a)=>n[a].set(e,t.get(r.name)));default:return i.children.forEach((r,a)=>n[a].set(e,t[r.name]))}}setValid(e,t){return super.setValid(e,t)||this.children.forEach(n=>n.setValid(e,t)),t}addChild(e,t=`${this.numChildren}`){const n=this.children.push(e);return this.type=new v([...this.type.children,new C(t,e.type,!0)]),n}}class S extends V{}S.prototype._setValue=ct;class te extends S{}te.prototype._setValue=ut;class se extends S{}se.prototype._setValue=dt;class ne extends S{}ne.prototype._setValue=ht;class ie extends S{}ie.prototype._setValue=pt;class x extends V{}x.prototype._setValue=ft;class re extends x{}re.prototype._setValue=yt;class ae extends x{}ae.prototype._setValue=mt;class le extends x{}le.prototype._setValue=gt;class oe extends x{}oe.prototype._setValue=vt;class R extends M{constructor(e){super(e);this._typeIds=new Ie(new Int8Array(0),1),typeof e.valueToChildTypeId=="function"&&(this._valueToChildTypeId=e.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(e,t){return this.set(this.length,e,t)}set(e,t,n){return n===void 0&&(n=this._valueToChildTypeId(this,t,e)),this.setValid(e,this.isValid(t))&&this.setValue(e,t,n),this}setValue(e,t,n){this._typeIds.set(e,n);const i=this.type.typeIdToChildIndex[n],r=this.children[i];r==null||r.set(e,t)}addChild(e,t=`${this.children.length}`){const n=this.children.push(e),{type:{children:i,mode:r,typeIds:a}}=this,l=[...i,new C(t,e.type)];return this.type=new Dt(r,[...a,n],l),n}_valueToChildTypeId(e,t,n){throw new Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.")}}class $e extends R{}class Ye extends R{constructor(e){super(e);this._offsets=new Ie(new Int32Array(0))}setValue(e,t,n){const i=this._typeIds.set(e,n).buffer[e],r=this.getChildAt(this.type.typeIdToChildIndex[i]),a=this._offsets.set(e,r.length).buffer[e];r==null||r.set(a,t)}}class ce extends E{constructor(e){super(e);this._values=new Ce(new Uint8Array(0))}get byteLength(){let e=this._pendingLength+this.length*4;return this._offsets&&(e+=this._offsets.byteLength),this._values&&(e+=this._values.byteLength),this._nulls&&(e+=this._nulls.byteLength),e}setValue(e,t){return super.setValue(e,wt(t))}_flushPending(e,t){}}ce.prototype._flushPending=K.prototype._flushPending;class Et extends Te{visitNull(){return Pe}visitBool(){return Ve}visitInt(){return B}visitInt8(){return Fe}visitInt16(){return Ue}visitInt32(){return ke}visitInt64(){return Le}visitUint8(){return Oe}visitUint16(){return Ne}visitUint32(){return ze}visitUint64(){return je}visitFloat(){return U}visitFloat16(){return Me}visitFloat32(){return Ae}visitFloat64(){return De}visitUtf8(){return ce}visitBinary(){return K}visitFixedSizeBinary(){return X}visitDate(){return F}visitDateDay(){return H}visitDateMillisecond(){return J}visitTimestamp(){return S}visitTimestampSecond(){return te}visitTimestampMillisecond(){return se}visitTimestampMicrosecond(){return ne}visitTimestampNanosecond(){return ie}visitTime(){return x}visitTimeSecond(){return re}visitTimeMillisecond(){return ae}visitTimeMicrosecond(){return le}visitTimeNanosecond(){return oe}visitDecimal(){return Q}visitList(){return Ee}visitStruct(){return We}visitUnion(){return R}visitDenseUnion(){return Ye}visitSparseUnion(){return $e}visitDictionary(){return Se}visitInterval(){return k}visitIntervalDayTime(){return Z}visitIntervalYearMonth(){return ee}visitFixedSizeList(){return xe}visitMap(){return Re}}const Rt=new Et;class u extends Te{compareSchemas(e,t){return e===t||t instanceof e.constructor&&this.compareManyFields(e.fields,t.fields)}compareManyFields(e,t){return e===t||Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every((n,i)=>this.compareFields(n,t[i]))}compareFields(e,t){return e===t||t instanceof e.constructor&&e.name===t.name&&e.nullable===t.nullable&&this.visit(e.type,t.type)}}function y(s,e){return e instanceof s.constructor}function L(s,e){return s===e||y(s,e)}function I(s,e){return s===e||y(s,e)&&s.bitWidth===e.bitWidth&&s.isSigned===e.isSigned}function P(s,e){return s===e||y(s,e)&&s.precision===e.precision}function Pt(s,e){return s===e||y(s,e)&&s.byteWidth===e.byteWidth}function ue(s,e){return s===e||y(s,e)&&s.unit===e.unit}function O(s,e){return s===e||y(s,e)&&s.unit===e.unit&&s.timezone===e.timezone}function N(s,e){return s===e||y(s,e)&&s.unit===e.unit&&s.bitWidth===e.bitWidth}function Wt(s,e){return s===e||y(s,e)&&s.children.length===e.children.length&&b.compareManyFields(s.children,e.children)}function $t(s,e){return s===e||y(s,e)&&s.children.length===e.children.length&&b.compareManyFields(s.children,e.children)}function de(s,e){return s===e||y(s,e)&&s.mode===e.mode&&s.typeIds.every((t,n)=>t===e.typeIds[n])&&b.compareManyFields(s.children,e.children)}function Yt(s,e){return s===e||y(s,e)&&s.id===e.id&&s.isOrdered===e.isOrdered&&b.visit(s.indices,e.indices)&&b.visit(s.dictionary,e.dictionary)}function he(s,e){return s===e||y(s,e)&&s.unit===e.unit}function qt(s,e){return s===e||y(s,e)&&s.listSize===e.listSize&&s.children.length===e.children.length&&b.compareManyFields(s.children,e.children)}function Gt(s,e){return s===e||y(s,e)&&s.keysSorted===e.keysSorted&&s.children.length===e.children.length&&b.compareManyFields(s.children,e.children)}u.prototype.visitNull=L,u.prototype.visitBool=L,u.prototype.visitInt=I,u.prototype.visitInt8=I,u.prototype.visitInt16=I,u.prototype.visitInt32=I,u.prototype.visitInt64=I,u.prototype.visitUint8=I,u.prototype.visitUint16=I,u.prototype.visitUint32=I,u.prototype.visitUint64=I,u.prototype.visitFloat=P,u.prototype.visitFloat16=P,u.prototype.visitFloat32=P,u.prototype.visitFloat64=P,u.prototype.visitUtf8=L,u.prototype.visitBinary=L,u.prototype.visitFixedSizeBinary=Pt,u.prototype.visitDate=ue,u.prototype.visitDateDay=ue,u.prototype.visitDateMillisecond=ue,u.prototype.visitTimestamp=O,u.prototype.visitTimestampSecond=O,u.prototype.visitTimestampMillisecond=O,u.prototype.visitTimestampMicrosecond=O,u.prototype.visitTimestampNanosecond=O,u.prototype.visitTime=N,u.prototype.visitTimeSecond=N,u.prototype.visitTimeMillisecond=N,u.prototype.visitTimeMicrosecond=N,u.prototype.visitTimeNanosecond=N,u.prototype.visitDecimal=L,u.prototype.visitList=Wt,u.prototype.visitStruct=$t,u.prototype.visitUnion=de,u.prototype.visitDenseUnion=de,u.prototype.visitSparseUnion=de,u.prototype.visitDictionary=Yt,u.prototype.visitInterval=he,u.prototype.visitIntervalDayTime=he,u.prototype.visitIntervalYearMonth=he,u.prototype.visitFixedSizeList=qt,u.prototype.visitMap=Gt;const b=new u;function qe(s,e){return b.compareSchemas(s,e)}function Kt(s,e){return b.compareFields(s,e)}function Ge(s,e){return b.visit(s,e)}function A(s){const e=s.type,t=new(Rt.getVisitFn(e)())(s);if(e.children&&e.children.length>0){const n=s.children||[],i={nullValues:s.nullValues},r=Array.isArray(n)?(a,l)=>n[l]||i:({name:a})=>n[a]||i;for(const[a,l]of e.children.entries()){const{type:o}=l,c=r(l,a);t.children.push(A(Object.assign(Object.assign({},c),{type:o})))}}return t}function pe(s,e){if(s instanceof $||s instanceof T||s.type instanceof q||ArrayBuffer.isView(s))return ye(s);const t={type:e??W(s),nullValues:[null]},n=[...Ke(t)(s)],i=n.length===1?n[0]:n.reduce((r,a)=>r.concat(a));return q.isDictionary(i.type)?i.memoize():i}function Ht(s){const e=pe(s),t=new p(new w(e.type.children),e.data[0]);return new m(t)}function W(s){if(s.length===0)return new G;let e=0,t=0,n=0,i=0,r=0,a=0,l=0,o=0;for(const c of s){if(c==null){++e;continue}switch(typeof c){case"bigint":++a;continue;case"boolean":++l;continue;case"number":++i;continue;case"string":++r;continue;case"object":Array.isArray(c)?++t:Object.prototype.toString.call(c)==="[object Date]"?++o:++n;continue}throw new TypeError("Unable to infer Vector type from input values, explicit type declaration expected.")}if(i+e===s.length)return new Ft;if(r+e===s.length)return new be(new Ut,new kt);if(a+e===s.length)return new Lt;if(l+e===s.length)return new Ot;if(o+e===s.length)return new Nt;if(t+e===s.length){const c=s,d=W(c[c.findIndex(h=>h!=null)]);if(c.every(h=>h==null||Ge(d,W(h))))return new _e(new C("",d,!0))}else if(n+e===s.length){const c=new Map;for(const d of s)for(const h of Object.keys(d))!c.has(h)&&d[h]!=null&&c.set(h,new C(h,W([d[h]]),!0));return new v([...c.values()])}throw new TypeError("Unable to infer Vector type from input values, explicit type declaration expected.")}function Ke(s){const{["queueingStrategy"]:e="count"}=s,{["highWaterMark"]:t=e!=="bytes"?Number.POSITIVE_INFINITY:Math.pow(2,14)}=s,n=e!=="bytes"?"length":"byteLength";return function*(i){let r=0;const a=A(s);for(const l of i)a.append(l)[n]>=t&&(++r&&(yield a.toVector()));(a.finish().length>0||r===0)&&(yield a.toVector())}}function Jt(s){const{["queueingStrategy"]:e="count"}=s,{["highWaterMark"]:t=e!=="bytes"?Number.POSITIVE_INFINITY:Math.pow(2,14)}=s,n=e!=="bytes"?"length":"byteLength";return function(i){return St(this,arguments,function*(){var r,a,l,o;let c=0;const d=A(s);try{for(var h=!0,g=xt(i),_;_=yield j(g.next()),r=_.done,!r;h=!0){o=_.value,h=!1;const D=o;d.append(D)[n]>=t&&(++c&&(yield yield j(d.toVector())))}}catch(D){a={error:D}}finally{try{!h&&!r&&(l=g.return)&&(yield j(l.call(g)))}finally{if(a)throw a.error}}(d.finish().length>0||c===0)&&(yield yield j(d.toVector()))})}}function fe(s,e){return Qt(s,e.map(t=>t.data.concat()))}function Qt(s,e){const t=[...s.fields],n=[],i={numBatches:e.reduce((h,g)=>Math.max(h,g.length),0)};let r=0,a=0,l=-1;const o=e.length;let c,d=[];for(;i.numBatches-- >0;){for(a=Number.POSITIVE_INFINITY,l=-1;++l<o;)d[l]=c=e[l].shift(),a=Math.min(a,c?c.length:a);Number.isFinite(a)&&(d=Xt(t,a,d,e,i),a>0&&(n[r++]=f({type:new v(t),length:a,nullCount:0,children:d.slice()})))}return[s=s.assign(t),n.map(h=>new p(s,h))]}function Xt(s,e,t,n,i){var r;const a=(e+63&~63)>>3;for(let l=-1,o=n.length;++l<o;){const c=t[l],d=c==null?void 0:c.length;if(d>=e)d===e?t[l]=c:(t[l]=c.slice(0,e),i.numBatches=Math.max(i.numBatches,n[l].unshift(c.slice(e,d-e))));else{const h=s[l];s[l]=h.clone({nullable:!0}),t[l]=(r=c==null?void 0:c._changeLengthAndBackfillNullBitmap(e))!==null&&r!==void 0?r:f({type:h.type,length:e,nullCount:e,nullBitmap:new Uint8Array(a)})}}return t}var He;class m{constructor(...e){var t,n;if(e.length===0)return this.batches=[],this.schema=new w([]),this._offsets=[0],this;let i,r;e[0]instanceof w&&(i=e.shift()),e.at(-1)instanceof Uint32Array&&(r=e.pop());const a=o=>{if(o){if(o instanceof p)return[o];if(o instanceof m)return o.batches;if(o instanceof $){if(o.type instanceof v)return[new p(new w(o.type.children),o)]}else{if(Array.isArray(o))return o.flatMap(c=>a(c));if(typeof o[Symbol.iterator]=="function")return[...o].flatMap(c=>a(c));if(typeof o=="object"){const c=Object.keys(o),d=c.map(_=>new T([o[_]])),h=new w(c.map((_,D)=>new C(String(_),d[D].type))),[,g]=fe(h,d);return g.length===0?[new p(o)]:g}}}return[]},l=e.flatMap(o=>a(o));if(i=(n=i??((t=l[0])===null||t===void 0?void 0:t.schema))!==null&&n!==void 0?n:new w([]),!(i instanceof w))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const o of l){if(!(o instanceof p))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!qe(i,o.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=i,this.batches=l,this._offsets=r??Bt(this.data)}get data(){return this.batches.map(({data:e})=>e)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce((e,t)=>e+t.length,0)}get nullCount(){return this._nullCount===-1&&(this._nullCount=bt(this.data)),this._nullCount}isValid(e){return!1}get(e){return null}set(e,t){return}indexOf(e,t){return-1}getByteLength(e){return 0}[Symbol.iterator](){return this.batches.length>0?me.visit(new T(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return`[
  ${this.toArray().join(`,
  `)}
]`}concat(...e){const t=this.schema,n=this.data.concat(e.flatMap(({data:i})=>i));return new m(t,n.map(i=>new p(t,i)))}slice(e,t){const n=this.schema;[e,t]=_t({length:this.numRows},e,t);const i=Tt(this.data,this._offsets,e,t);return new m(n,i.map(r=>new p(n,r)))}getChild(e){return this.getChildAt(this.schema.fields.findIndex(t=>t.name===e))}getChildAt(e){if(e>-1&&e<this.schema.fields.length){const t=this.data.map(n=>n.children[e]);if(t.length===0){const{type:n}=this.schema.fields[e],i=f({type:n,length:0,nullCount:0});t.push(i._changeLengthAndBackfillNullBitmap(this.numRows))}return new T(t)}return null}setChild(e,t){var n;return this.setChildAt((n=this.schema.fields)===null||n===void 0?void 0:n.findIndex(i=>i.name===e),t)}setChildAt(e,t){let n=this.schema,i=[...this.batches];if(e>-1&&e<this.numCols){t||(t=new T([f({type:new G,length:this.numRows})]));const r=n.fields.slice(),a=r[e].clone({type:t.type}),l=this.schema.fields.map((o,c)=>this.getChildAt(c));[r[e],l[e]]=[a,t],[n,i]=fe(n,l)}return new m(n,i)}select(e){const t=this.schema.fields.reduce((n,i,r)=>n.set(i.name,r),new Map);return this.selectAt(e.map(n=>t.get(n)).filter(n=>n>-1))}selectAt(e){const t=this.schema.selectAt(e),n=this.batches.map(i=>i.selectAt(e));return new m(t,n)}assign(e){const t=this.schema.fields,[n,i]=e.schema.fields.reduce((l,o,c)=>{const[d,h]=l,g=t.findIndex(_=>_.name===o.name);return~g?h[g]=c:d.push(c),l},[[],[]]),r=this.schema.assign(e.schema),a=[...t.map((l,o)=>[o,i[o]]).map(([l,o])=>o===void 0?this.getChildAt(l):e.getChildAt(o)),...n.map(l=>e.getChildAt(l))].filter(Boolean);return new m(...fe(r,a))}}He=Symbol.toStringTag,m[He]=(s=>(s.schema=null,s.batches=[],s._offsets=new Uint32Array([0]),s._nullCount=-1,s[Symbol.isConcatSpreadable]=!0,s.isValid=Y(Vt),s.get=Y(ge.getVisitFn(z.Struct)),s.set=Ct(ve.getVisitFn(z.Struct)),s.indexOf=It(we.getVisitFn(z.Struct)),s.getByteLength=Y(Be.getVisitFn(z.Struct)),"Table"))(m.prototype);function Zt(s){const e={},t=Object.entries(s);for(const[n,i]of t)e[n]=ye(i);return new m(e)}function es(s){const e={},t=Object.entries(s);for(const[n,i]of t)e[n]=pe(i);return new m(e)}var Je;class p{constructor(...e){switch(e.length){case 2:{if([this.schema]=e,!(this.schema instanceof w))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=f({nullCount:0,type:new v(this.schema.fields),children:this.schema.fields.map(t=>f({type:t.type,nullCount:0}))})]=e,!(this.data instanceof $))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=Qe(this.schema,this.data.children);break}case 1:{const[t]=e,{fields:n,children:i,length:r}=Object.keys(t).reduce((o,c,d)=>(o.children[d]=t[c],o.length=Math.max(o.length,t[c].length),o.fields[d]=C.new({name:c,type:t[c].type,nullable:!0}),o),{length:0,fields:new Array,children:new Array}),a=new w(n),l=f({type:new v(n),length:r,children:i,nullCount:0});[this.schema,this.data]=Qe(a,l.children,r);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=Xe(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(e){return this.data.getValid(e)}get(e){return ge.visit(this.data,e)}set(e,t){return ve.visit(this.data,e,t)}indexOf(e,t){return we.visit(this.data,e,t)}getByteLength(e){return Be.visit(this.data,e)}[Symbol.iterator](){return me.visit(new T([this.data]))}toArray(){return[...this]}concat(...e){return new m(this.schema,[this,...e])}slice(e,t){const[n]=new T([this.data]).slice(e,t).data;return new p(this.schema,n)}getChild(e){var t;return this.getChildAt((t=this.schema.fields)===null||t===void 0?void 0:t.findIndex(n=>n.name===e))}getChildAt(e){return e>-1&&e<this.schema.fields.length?new T([this.data.children[e]]):null}setChild(e,t){var n;return this.setChildAt((n=this.schema.fields)===null||n===void 0?void 0:n.findIndex(i=>i.name===e),t)}setChildAt(e,t){let n=this.schema,i=this.data;if(e>-1&&e<this.numCols){t||(t=new T([f({type:new G,length:this.numRows})]));const r=n.fields.slice(),a=i.children.slice(),l=r[e].clone({type:t.type});[r[e],a[e]]=[l,t.data[0]],n=new w(r,new Map(this.schema.metadata)),i=f({type:new v(r),children:a})}return new p(n,i)}select(e){const t=this.schema.select(e),n=new v(t.fields),i=[];for(const r of e){const a=this.schema.fields.findIndex(l=>l.name===r);~a&&(i[a]=this.data.children[a])}return new p(t,f({type:n,length:this.numRows,children:i}))}selectAt(e){const t=this.schema.selectAt(e),n=e.map(r=>this.data.children[r]).filter(Boolean),i=f({type:new v(t.fields),length:this.numRows,children:n});return new p(t,i)}}Je=Symbol.toStringTag,p[Je]=(s=>(s._nullCount=-1,s[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(p.prototype);function Qe(s,e,t=e.reduce((n,i)=>Math.max(n,i.length),0)){var n;const i=[...s.fields],r=[...e],a=(t+63&~63)>>3;for(const[l,o]of s.fields.entries()){const c=e[l];(!c||c.length!==t)&&(i[l]=o.clone({nullable:!0}),r[l]=(n=c==null?void 0:c._changeLengthAndBackfillNullBitmap(t))!==null&&n!==void 0?n:f({type:o.type,length:t,nullCount:t,nullBitmap:new Uint8Array(a)}))}return[s.assign(i),f({type:new v(i),length:t,children:r})]}function Xe(s,e,t=new Map){for(let n=-1,i=s.length;++n<i;){const r=s[n],a=r.type,l=e[n];if(q.isDictionary(a)){if(!t.has(a.id))l.dictionary&&t.set(a.id,l.dictionary);else if(t.get(a.id)!==l.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}a.children&&a.children.length>0&&Xe(a.children,l.children,t)}return t}class ts extends p{constructor(e){const t=e.fields.map(i=>f({type:i.type})),n=f({type:new v(e.fields),nullCount:0,children:t});super(e,n)}}export{qe as $,je as A,K as B,S as C,F as D,te as E,X as F,se as G,ne as H,k as I,ie as J,x as K,Ee as L,Re as M,Pe as N,re as O,ae as P,le as Q,p as R,We as S,m as T,Oe as U,oe as V,R as W,Ye as X,$e as Y,ce as Z,ts as _,Zt as a,Kt as a0,Ge as a1,Ht as b,Ke as c,Jt as d,Ve as e,H as f,J as g,Q as h,Se as i,xe as j,U as k,Me as l,A as m,Ae as n,De as o,Z as p,ee as q,B as r,Fe as s,es as t,Ue as u,pe as v,ke as w,Le as x,Ne as y,ze as z};export default null;
