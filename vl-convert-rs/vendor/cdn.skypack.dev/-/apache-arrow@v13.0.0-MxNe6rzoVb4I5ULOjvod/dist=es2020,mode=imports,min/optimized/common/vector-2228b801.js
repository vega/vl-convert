import{DateUnit as Gt,TimeUnit as O,IntervalUnit as Qt,Precision as et,UnionMode as mt,Type as _,BufferType as $}from"../apache-arrow/enum.js";import{Q as E,D as W,I as on,u as an,F as ln,a as cn,b as un,c as yn,d as pn,U as fn,e as hn,f as dn,g as gn,i as mn,j as vn}from"./type-9c6ae821.js";import{Visitor as K}from"../apache-arrow/visitor.js";import{__asyncGenerator as ot,__await as j,__asyncDelegator as vt,__asyncValues as bt}from"/-/tslib@v2.6.2-OVagwiLDRFa7T0n3eDR1/dist=es2020,mode=imports,min/optimized/tslib.js";const bn=new TextDecoder("utf-8"),qt=e=>bn.decode(e),In=new TextEncoder,It=e=>In.encode(e),An=e=>typeof e=="number",Xt=e=>typeof e=="boolean",w=e=>typeof e=="function",S=e=>e!=null&&Object(e)===e,Zt=e=>S(e)&&w(e.then),At=e=>S(e)&&w(e[Symbol.iterator]),te=e=>S(e)&&w(e[Symbol.asyncIterator]),Bn=e=>S(e)&&S(e.schema),ee=e=>S(e)&&"done"in e&&"value"in e,wn=e=>S(e)&&w(e.stat)&&An(e.fd),On=e=>S(e)&&ne(e.body),at=e=>"_getDOMStream"in e&&"_getNodeStream"in e,Tn=e=>S(e)&&w(e.abort)&&w(e.getWriter)&&!at(e),ne=e=>S(e)&&w(e.cancel)&&w(e.getReader)&&!at(e),Sn=e=>S(e)&&w(e.end)&&w(e.write)&&Xt(e.writable)&&!at(e),Un=e=>S(e)&&w(e.read)&&w(e.pipe)&&Xt(e.readable)&&!at(e),Fn=e=>S(e)&&w(e.clear)&&w(e.bytes)&&w(e.position)&&w(e.setPosition)&&w(e.capacity)&&w(e.getBufferIdentifier)&&w(e.createLong),Bt=typeof SharedArrayBuffer!="undefined"?SharedArrayBuffer:ArrayBuffer;function _n(e){const t=e[0]?[e[0]]:[];let n,i,r,s;for(let o,a,l=0,m=0,B=e.length;++l<B;){if(o=t[m],a=e[l],!o||!a||o.buffer!==a.buffer||a.byteOffset<o.byteOffset){a&&(t[++m]=a);continue}if({byteOffset:n,byteLength:r}=o,{byteOffset:i,byteLength:s}=a,n+r<i||i+s<n){a&&(t[++m]=a);continue}t[m]=new Uint8Array(o.buffer,n,i-n+s)}return t}function lt(e,t,n=0,i=t.byteLength){const r=e.byteLength,s=new Uint8Array(e.buffer,e.byteOffset,r),o=new Uint8Array(t.buffer,t.byteOffset,Math.min(i,r));return s.set(o,n),e}function ie(e,t){const n=_n(e),i=n.reduce((B,T)=>B+T.byteLength,0);let r,s,o,a=0,l=-1;const m=Math.min(t||Number.POSITIVE_INFINITY,i);for(const B=n.length;++l<B;){if(r=n[l],s=r.subarray(0,Math.min(r.length,m-a)),m<=a+s.length){s.length<r.length?n[l]=r.subarray(s.length):s.length===r.length&&l++,o?lt(o,s,a):o=s;break}lt(o||(o=new Uint8Array(m)),s,a),a+=s.length}return[o||new Uint8Array(0),n.slice(l),i-(o?o.byteLength:0)]}function b(e,t){let n=ee(t)?t.value:t;return n instanceof e?e===Uint8Array?new e(n.buffer,n.byteOffset,n.byteLength):n:n?(typeof n=="string"&&(n=It(n)),n instanceof ArrayBuffer?new e(n):n instanceof Bt?new e(n):Fn(n)?b(e,n.bytes()):ArrayBuffer.isView(n)?n.byteLength<=0?new e(0):new e(n.buffer,n.byteOffset,n.byteLength/e.BYTES_PER_ELEMENT):e.from(n)):new e(0)}const Cn=e=>b(Int8Array,e),Dn=e=>b(Int16Array,e),J=e=>b(Int32Array,e),Mn=e=>b(BigInt64Array,e),A=e=>b(Uint8Array,e),Nn=e=>b(Uint16Array,e),Ln=e=>b(Uint32Array,e),jn=e=>b(BigUint64Array,e),Vn=e=>b(Float32Array,e),xn=e=>b(Float64Array,e),En=e=>b(Uint8ClampedArray,e),wt=e=>(e.next(),e);function*V(e,t){const n=function*(r){yield r},i=typeof t=="string"||(ArrayBuffer.isView(t)||(t instanceof ArrayBuffer||t instanceof Bt))?n(t):At(t)?t:n(t);return yield*wt(function*(r){let s=null;do s=r.next(yield b(e,s));while(!s.done)}(i[Symbol.iterator]())),new e}const kn=e=>V(Int8Array,e),zn=e=>V(Int16Array,e),Rn=e=>V(Int32Array,e),re=e=>V(Uint8Array,e),Pn=e=>V(Uint16Array,e),$n=e=>V(Uint32Array,e),Yn=e=>V(Float32Array,e),Wn=e=>V(Float64Array,e),Kn=e=>V(Uint8ClampedArray,e);function C(e,t){return ot(this,arguments,function*(){if(Zt(t))return yield j(yield j(yield*vt(bt(C(e,yield j(t))))));const i=function(o){return ot(this,arguments,function*(){yield yield j(yield j(o))})},r=function(o){return ot(this,arguments,function*(){yield j(yield*vt(bt(wt(function*(a){let l=null;do l=a.next(yield l==null?void 0:l.value);while(!l.done)}(o[Symbol.iterator]())))))})},s=typeof t=="string"||(ArrayBuffer.isView(t)||(t instanceof ArrayBuffer||t instanceof Bt))?i(t):At(t)?r(t):te(t)?t:i(t);return yield j(yield*vt(bt(wt(function(o){return ot(this,arguments,function*(){let a=null;do a=yield j(o.next(yield yield j(b(e,a))));while(!a.done)})}(s[Symbol.asyncIterator]()))))),yield j(new e)})}const Jn=e=>C(Int8Array,e),Hn=e=>C(Int16Array,e),Gn=e=>C(Int32Array,e),se=e=>C(Uint8Array,e),Qn=e=>C(Uint16Array,e),qn=e=>C(Uint32Array,e),Xn=e=>C(Float32Array,e),Zn=e=>C(Float64Array,e),ti=e=>C(Uint8ClampedArray,e);function oe(e,t,n){if(e!==0){n=n.slice(0,t+1);for(let i=-1;++i<=t;)n[i]+=e}return n}function ae(e,t){let n=0;const i=e.length;if(i!==t.length)return!1;if(i>0)do if(e[n]!==t[n])return!1;while(++n<i);return!0}var ei=Object.freeze({__proto__:null,memcpy:lt,joinUint8Arrays:ie,toArrayBufferView:b,toInt8Array:Cn,toInt16Array:Dn,toInt32Array:J,toBigInt64Array:Mn,toUint8Array:A,toUint16Array:Nn,toUint32Array:Ln,toBigUint64Array:jn,toFloat32Array:Vn,toFloat64Array:xn,toUint8ClampedArray:En,toArrayBufferViewIterator:V,toInt8ArrayIterator:kn,toInt16ArrayIterator:zn,toInt32ArrayIterator:Rn,toUint8ArrayIterator:re,toUint16ArrayIterator:Pn,toUint32ArrayIterator:$n,toFloat32ArrayIterator:Yn,toFloat64ArrayIterator:Wn,toUint8ClampedArrayIterator:Kn,toArrayBufferViewAsyncIterator:C,toInt8ArrayAsyncIterator:Jn,toInt16ArrayAsyncIterator:Hn,toInt32ArrayAsyncIterator:Gn,toUint8ArrayAsyncIterator:se,toUint16ArrayAsyncIterator:Qn,toUint32ArrayAsyncIterator:qn,toFloat32ArrayAsyncIterator:Xn,toFloat64ArrayAsyncIterator:Zn,toUint8ClampedArrayAsyncIterator:ti,rebaseValueOffsets:oe,compareArrayLike:ae});const ni=void 0;function H(e){if(e===null)return"null";if(e===ni)return"undefined";switch(typeof e){case"number":return`${e}`;case"bigint":return`${e}`;case"string":return`"${e}"`}return typeof e[Symbol.toPrimitive]=="function"?e[Symbol.toPrimitive]("string"):ArrayBuffer.isView(e)?e instanceof BigInt64Array||e instanceof BigUint64Array?`[${[...e].map(t=>H(t))}]`:`[${e}]`:ArrayBuffer.isView(e)?`[${e}]`:JSON.stringify(e,(t,n)=>typeof n=="bigint"?`${n}`:n)}const le=Symbol.for("isArrowBigNum");function D(e,...t){return t.length===0?Object.setPrototypeOf(b(this.TypedArray,e),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(e,...t),this.constructor.prototype)}D.prototype[le]=!0,D.prototype.toJSON=function(){return`"${q(this)}"`},D.prototype.valueOf=function(){return ce(this)},D.prototype.toString=function(){return q(this)},D.prototype[Symbol.toPrimitive]=function(e="default"){switch(e){case"number":return ce(this);case"string":return q(this);case"default":return ue(this)}return q(this)};function G(...e){return D.apply(this,e)}function Q(...e){return D.apply(this,e)}function nt(...e){return D.apply(this,e)}Object.setPrototypeOf(G.prototype,Object.create(Int32Array.prototype)),Object.setPrototypeOf(Q.prototype,Object.create(Uint32Array.prototype)),Object.setPrototypeOf(nt.prototype,Object.create(Uint32Array.prototype)),Object.assign(G.prototype,D.prototype,{constructor:G,signed:!0,TypedArray:Int32Array,BigIntArray:BigInt64Array}),Object.assign(Q.prototype,D.prototype,{constructor:Q,signed:!1,TypedArray:Uint32Array,BigIntArray:BigUint64Array}),Object.assign(nt.prototype,D.prototype,{constructor:nt,signed:!0,TypedArray:Uint32Array,BigIntArray:BigUint64Array});function ce(e){const{buffer:t,byteOffset:n,length:i,signed:r}=e,s=new BigUint64Array(t,n,i),o=r&&s.at(-1)&BigInt(1)<<BigInt(63);let a=o?BigInt(1):BigInt(0),l=BigInt(0);if(o){for(const m of s)a+=~m*(BigInt(1)<<BigInt(32)*l++);a*=BigInt(-1)}else for(const m of s)a+=m*(BigInt(1)<<BigInt(32)*l++);return a}const q=e=>{if(e.byteLength===8){const s=new e.BigIntArray(e.buffer,e.byteOffset,1);return`${s[0]}`}if(!e.signed)return Ot(e);let t=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2);const n=new Int16Array([t.at(-1)])[0];if(n>=0)return Ot(e);t=t.slice();let i=1;for(let s=0;s<t.length;s++){const o=t[s],a=~o+i;t[s]=a,i&=o===0?1:0}const r=Ot(t);return`-${r}`},ue=e=>{if(e.byteLength===8){const t=new e.BigIntArray(e.buffer,e.byteOffset,1);return t[0]}else return q(e)};function Ot(e){let t="";const n=new Uint32Array(2);let i=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2);const r=new Uint32Array((i=new Uint16Array(i).reverse()).buffer);let s=-1;const o=i.length-1;do{for(n[0]=i[s=0];s<o;)i[s++]=n[1]=n[0]/10,n[0]=(n[0]-n[1]*10<<16)+i[s];i[s]=n[1]=n[0]/10,n[0]=n[0]-n[1]*10,t=`${n[0]}${t}`}while(r[0]||r[1]||r[2]||r[3]);return t??"0"}class it{static new(t,n){switch(n){case!0:return new G(t);case!1:return new Q(t)}switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:case BigInt64Array:return new G(t)}return t.byteLength===16?new nt(t):new Q(t)}static signed(t){return new G(t)}static unsigned(t){return new Q(t)}static decimal(t){return new nt(t)}constructor(t,n){return it.new(t,n)}}var ii=Object.freeze({__proto__:null,isArrowBigNumSymbol:le,bigNumToString:q,bigNumToBigInt:ue,BN:it});const ye=new Float64Array(1),X=new Uint32Array(ye.buffer);function Tt(e){const t=(e&31744)>>10,n=(e&1023)/1024,i=Math.pow(-1,(e&32768)>>15);switch(t){case 31:return i*(n?Number.NaN:1/0);case 0:return i*(n?6103515625e-14*n:0)}return i*Math.pow(2,t-15)*(1+n)}function St(e){if(e!==e)return 32256;ye[0]=e;const t=(X[1]&2147483648)>>16&65535;let n=X[1]&2146435072,i=0;return n>=1089470464?X[0]>0?n=31744:(n=(n&2080374784)>>16,i=(X[1]&1048575)>>10):n<=1056964608?(i=1048576+(X[1]&1048575),i=1048576+(i<<(n>>20)-998)>>21,n=0):(n=n-1056964608>>10,i=(X[1]&1048575)+512>>10),t|n|i&65535}var ri=Object.freeze({__proto__:null,uint16ToFloat64:Tt,float64ToUint16:St});class p extends K{}function d(e){return(t,n,i)=>{if(t.setValid(n,i!=null))return e(t,n,i)}}const si=(e,t,n)=>{e[t]=Math.trunc(n/864e5)},Ut=(e,t,n)=>{e[t]=Math.trunc(n%4294967296),e[t+1]=Math.trunc(n/4294967296)},oi=(e,t,n)=>{e[t]=Math.trunc(n*1e3%4294967296),e[t+1]=Math.trunc(n*1e3/4294967296)},ai=(e,t,n)=>{e[t]=Math.trunc(n*1e6%4294967296),e[t+1]=Math.trunc(n*1e6/4294967296)},pe=(e,t,n,i)=>{if(n+1<t.length){const{[n]:r,[n+1]:s}=t;e.set(i.subarray(0,s-r),r)}},li=({offset:e,values:t},n,i)=>{const r=e+n;i?t[r>>3]|=1<<r%8:t[r>>3]&=~(1<<r%8)},k=({values:e},t,n)=>{e[t]=n},Ft=({values:e},t,n)=>{e[t]=n},fe=({values:e},t,n)=>{e[t]=St(n)},ci=(e,t,n)=>{switch(e.type.precision){case et.HALF:return fe(e,t,n);case et.SINGLE:case et.DOUBLE:return Ft(e,t,n)}},_t=({values:e},t,n)=>{si(e,t,n.valueOf())},Ct=({values:e},t,n)=>{Ut(e,t*2,n.valueOf())},he=({stride:e,values:t},n,i)=>{t.set(i.subarray(0,e),e*n)},ui=({values:e,valueOffsets:t},n,i)=>pe(e,t,n,i),yi=({values:e,valueOffsets:t},n,i)=>{pe(e,t,n,It(i))},de=(e,t,n)=>{e.type.unit===Gt.DAY?_t(e,t,n):Ct(e,t,n)},Dt=({values:e},t,n)=>Ut(e,t*2,n/1e3),Mt=({values:e},t,n)=>Ut(e,t*2,n),Nt=({values:e},t,n)=>oi(e,t*2,n),Lt=({values:e},t,n)=>ai(e,t*2,n),ge=(e,t,n)=>{switch(e.type.unit){case O.SECOND:return Dt(e,t,n);case O.MILLISECOND:return Mt(e,t,n);case O.MICROSECOND:return Nt(e,t,n);case O.NANOSECOND:return Lt(e,t,n)}},jt=({values:e},t,n)=>{e[t]=n},Vt=({values:e},t,n)=>{e[t]=n},xt=({values:e},t,n)=>{e[t]=n},Et=({values:e},t,n)=>{e[t]=n},me=(e,t,n)=>{switch(e.type.unit){case O.SECOND:return jt(e,t,n);case O.MILLISECOND:return Vt(e,t,n);case O.MICROSECOND:return xt(e,t,n);case O.NANOSECOND:return Et(e,t,n)}},ve=({values:e,stride:t},n,i)=>{e.set(i.subarray(0,t),t*n)},pi=(e,t,n)=>{const i=e.children[0],r=e.valueOffsets,s=M.getVisitFn(i);if(Array.isArray(n))for(let o=-1,a=r[t],l=r[t+1];a<l;)s(i,a++,n[++o]);else for(let o=-1,a=r[t],l=r[t+1];a<l;)s(i,a++,n.get(++o))},fi=(e,t,n)=>{const i=e.children[0],{valueOffsets:r}=e,s=M.getVisitFn(i);let{[t]:o,[t+1]:a}=r;const l=n instanceof Map?n.entries():Object.entries(n);for(const m of l)if(s(i,o,m),++o>=a)break},hi=(e,t)=>(n,i,r,s)=>i&&n(i,e,t[s]),di=(e,t)=>(n,i,r,s)=>i&&n(i,e,t.get(s)),gi=(e,t)=>(n,i,r,s)=>i&&n(i,e,t.get(r.name)),mi=(e,t)=>(n,i,r,s)=>i&&n(i,e,t[r.name]),vi=(e,t,n)=>{const i=e.type.children.map(s=>M.getVisitFn(s.type)),r=n instanceof Map?gi(t,n):n instanceof v?di(t,n):Array.isArray(n)?hi(t,n):mi(t,n);e.type.children.forEach((s,o)=>r(i[o],e.children[o],s,o))},bi=(e,t,n)=>{e.type.mode===mt.Dense?be(e,t,n):Ie(e,t,n)},be=(e,t,n)=>{const i=e.type.typeIdToChildIndex[e.typeIds[t]],r=e.children[i];M.visit(r,e.valueOffsets[t],n)},Ie=(e,t,n)=>{const i=e.type.typeIdToChildIndex[e.typeIds[t]],r=e.children[i];M.visit(r,t,n)},Ii=(e,t,n)=>{var i;(i=e.dictionary)===null||i===void 0||i.set(e.values[t],n)},Ae=(e,t,n)=>{e.type.unit===Qt.DAY_TIME?kt(e,t,n):zt(e,t,n)},kt=({values:e},t,n)=>{e.set(n.subarray(0,2),2*t)},zt=({values:e},t,n)=>{e[t]=n[0]*12+n[1]%12},Ai=(e,t,n)=>{const{stride:i}=e,r=e.children[0],s=M.getVisitFn(r);if(Array.isArray(n))for(let o=-1,a=t*i;++o<i;)s(r,a+o,n[o]);else for(let o=-1,a=t*i;++o<i;)s(r,a+o,n.get(o))};p.prototype.visitBool=d(li),p.prototype.visitInt=d(k),p.prototype.visitInt8=d(k),p.prototype.visitInt16=d(k),p.prototype.visitInt32=d(k),p.prototype.visitInt64=d(k),p.prototype.visitUint8=d(k),p.prototype.visitUint16=d(k),p.prototype.visitUint32=d(k),p.prototype.visitUint64=d(k),p.prototype.visitFloat=d(ci),p.prototype.visitFloat16=d(fe),p.prototype.visitFloat32=d(Ft),p.prototype.visitFloat64=d(Ft),p.prototype.visitUtf8=d(yi),p.prototype.visitBinary=d(ui),p.prototype.visitFixedSizeBinary=d(he),p.prototype.visitDate=d(de),p.prototype.visitDateDay=d(_t),p.prototype.visitDateMillisecond=d(Ct),p.prototype.visitTimestamp=d(ge),p.prototype.visitTimestampSecond=d(Dt),p.prototype.visitTimestampMillisecond=d(Mt),p.prototype.visitTimestampMicrosecond=d(Nt),p.prototype.visitTimestampNanosecond=d(Lt),p.prototype.visitTime=d(me),p.prototype.visitTimeSecond=d(jt),p.prototype.visitTimeMillisecond=d(Vt),p.prototype.visitTimeMicrosecond=d(xt),p.prototype.visitTimeNanosecond=d(Et),p.prototype.visitDecimal=d(ve),p.prototype.visitList=d(pi),p.prototype.visitStruct=d(vi),p.prototype.visitUnion=d(bi),p.prototype.visitDenseUnion=d(be),p.prototype.visitSparseUnion=d(Ie),p.prototype.visitDictionary=d(Ii),p.prototype.visitInterval=d(Ae),p.prototype.visitIntervalDayTime=d(kt),p.prototype.visitIntervalYearMonth=d(zt),p.prototype.visitFixedSizeList=d(Ai),p.prototype.visitMap=d(fi);const M=new p,N=Symbol.for("parent"),Z=Symbol.for("rowIndex");class ct{constructor(t,n){return this[N]=t,this[Z]=n,new Proxy(this,new wi)}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[Z],n=this[N],i=n.type.children,r={};for(let s=-1,o=i.length;++s<o;)r[i[s].name]=U.visit(n.children[s],t);return r}toString(){return`{${[...this].map(([t,n])=>`${H(t)}: ${H(n)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new Bi(this[N],this[Z])}}class Bi{constructor(t,n){this.childIndex=0,this.children=t.children,this.rowIndex=n,this.childFields=t.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){const t=this.childIndex;return t<this.numChildren?(this.childIndex=t+1,{done:!1,value:[this.childFields[t].name,U.visit(this.children[t],this.rowIndex)]}):{done:!0,value:null}}}Object.defineProperties(ct.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[N]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Z]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});class wi{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[N].type.children.map(n=>n.name)}has(t,n){return t[N].type.children.findIndex(i=>i.name===n)!==-1}getOwnPropertyDescriptor(t,n){return t[N].type.children.findIndex(i=>i.name===n)!==-1?{writable:!0,enumerable:!0,configurable:!0}:void 0}get(t,n){if(Reflect.has(t,n))return t[n];const i=t[N].type.children.findIndex(r=>r.name===n);if(i!==-1){const r=U.visit(t[N].children[i],t[Z]);return Reflect.set(t,n,r),r}}set(t,n,i){const r=t[N].type.children.findIndex(s=>s.name===n);return r!==-1?(M.visit(t[N].children[r],t[Z],i),Reflect.set(t,n,i)):Reflect.has(t,n)||typeof n=="symbol"?Reflect.set(t,n,i):!1}}class c extends K{}function f(e){return(t,n)=>t.getValid(n)?e(t,n):null}const Oi=(e,t)=>864e5*e[t],Rt=(e,t)=>4294967296*e[t+1]+(e[t]>>>0),Ti=(e,t)=>4294967296*(e[t+1]/1e3)+(e[t]>>>0)/1e3,Si=(e,t)=>4294967296*(e[t+1]/1e6)+(e[t]>>>0)/1e6,Be=e=>new Date(e),Ui=(e,t)=>Be(Oi(e,t)),Fi=(e,t)=>Be(Rt(e,t)),_i=(e,t)=>null,we=(e,t,n)=>{if(n+1>=t.length)return null;const i=t[n],r=t[n+1];return e.subarray(i,r)},Ci=({offset:e,values:t},n)=>{const i=e+n,r=t[i>>3];return(r&1<<i%8)!==0},Oe=({values:e},t)=>Ui(e,t),Te=({values:e},t)=>Fi(e,t*2),R=({stride:e,values:t},n)=>t[e*n],Di=({stride:e,values:t},n)=>Tt(t[e*n]),Se=({values:e},t)=>e[t],Mi=({stride:e,values:t},n)=>t.subarray(e*n,e*(n+1)),Ni=({values:e,valueOffsets:t},n)=>we(e,t,n),Li=({values:e,valueOffsets:t},n)=>{const i=we(e,t,n);return i!==null?qt(i):null},ji=({values:e},t)=>e[t],Vi=({type:e,values:t},n)=>e.precision!==et.HALF?t[n]:Tt(t[n]),xi=(e,t)=>e.type.unit===Gt.DAY?Oe(e,t):Te(e,t),Ue=({values:e},t)=>1e3*Rt(e,t*2),Fe=({values:e},t)=>Rt(e,t*2),_e=({values:e},t)=>Ti(e,t*2),Ce=({values:e},t)=>Si(e,t*2),Ei=(e,t)=>{switch(e.type.unit){case O.SECOND:return Ue(e,t);case O.MILLISECOND:return Fe(e,t);case O.MICROSECOND:return _e(e,t);case O.NANOSECOND:return Ce(e,t)}},De=({values:e},t)=>e[t],Me=({values:e},t)=>e[t],Ne=({values:e},t)=>e[t],Le=({values:e},t)=>e[t],ki=(e,t)=>{switch(e.type.unit){case O.SECOND:return De(e,t);case O.MILLISECOND:return Me(e,t);case O.MICROSECOND:return Ne(e,t);case O.NANOSECOND:return Le(e,t)}},zi=({values:e,stride:t},n)=>it.decimal(e.subarray(t*n,t*(n+1))),Ri=(e,t)=>{const{valueOffsets:n,stride:i,children:r}=e,{[t*i]:s,[t*i+1]:o}=n,a=r[0],l=a.slice(s,o-s);return new v([l])},Pi=(e,t)=>{const{valueOffsets:n,children:i}=e,{[t]:r,[t+1]:s}=n,o=i[0];return new ut(o.slice(r,s-r))},$i=(e,t)=>new ct(e,t),Yi=(e,t)=>e.type.mode===mt.Dense?je(e,t):Ve(e,t),je=(e,t)=>{const n=e.type.typeIdToChildIndex[e.typeIds[t]],i=e.children[n];return U.visit(i,e.valueOffsets[t])},Ve=(e,t)=>{const n=e.type.typeIdToChildIndex[e.typeIds[t]],i=e.children[n];return U.visit(i,t)},Wi=(e,t)=>{var n;return(n=e.dictionary)===null||n===void 0?void 0:n.get(e.values[t])},Ki=(e,t)=>e.type.unit===Qt.DAY_TIME?xe(e,t):Ee(e,t),xe=({values:e},t)=>e.subarray(2*t,2*(t+1)),Ee=({values:e},t)=>{const n=e[t],i=new Int32Array(2);return i[0]=Math.trunc(n/12),i[1]=Math.trunc(n%12),i},Ji=(e,t)=>{const{stride:n,children:i}=e,r=i[0],s=r.slice(t*n,n);return new v([s])};c.prototype.visitNull=f(_i),c.prototype.visitBool=f(Ci),c.prototype.visitInt=f(ji),c.prototype.visitInt8=f(R),c.prototype.visitInt16=f(R),c.prototype.visitInt32=f(R),c.prototype.visitInt64=f(Se),c.prototype.visitUint8=f(R),c.prototype.visitUint16=f(R),c.prototype.visitUint32=f(R),c.prototype.visitUint64=f(Se),c.prototype.visitFloat=f(Vi),c.prototype.visitFloat16=f(Di),c.prototype.visitFloat32=f(R),c.prototype.visitFloat64=f(R),c.prototype.visitUtf8=f(Li),c.prototype.visitBinary=f(Ni),c.prototype.visitFixedSizeBinary=f(Mi),c.prototype.visitDate=f(xi),c.prototype.visitDateDay=f(Oe),c.prototype.visitDateMillisecond=f(Te),c.prototype.visitTimestamp=f(Ei),c.prototype.visitTimestampSecond=f(Ue),c.prototype.visitTimestampMillisecond=f(Fe),c.prototype.visitTimestampMicrosecond=f(_e),c.prototype.visitTimestampNanosecond=f(Ce),c.prototype.visitTime=f(ki),c.prototype.visitTimeSecond=f(De),c.prototype.visitTimeMillisecond=f(Me),c.prototype.visitTimeMicrosecond=f(Ne),c.prototype.visitTimeNanosecond=f(Le),c.prototype.visitDecimal=f(zi),c.prototype.visitList=f(Ri),c.prototype.visitStruct=f($i),c.prototype.visitUnion=f(Yi),c.prototype.visitDenseUnion=f(je),c.prototype.visitSparseUnion=f(Ve),c.prototype.visitDictionary=f(Wi),c.prototype.visitInterval=f(Ki),c.prototype.visitIntervalDayTime=f(xe),c.prototype.visitIntervalYearMonth=f(Ee),c.prototype.visitFixedSizeList=f(Ji),c.prototype.visitMap=f(Pi);const U=new c,L=Symbol.for("keys"),tt=Symbol.for("vals");class ut{constructor(t){return this[L]=new v([t.children[0]]).memoize(),this[tt]=t.children[1],new Proxy(this,new Gi)}[Symbol.iterator](){return new Hi(this[L],this[tt])}get size(){return this[L].length}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[L],n=this[tt],i={};for(let r=-1,s=t.length;++r<s;)i[t.get(r)]=U.visit(n,r);return i}toString(){return`{${[...this].map(([t,n])=>`${H(t)}: ${H(n)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}class Hi{constructor(t,n){this.keys=t,this.vals=n,this.keyIndex=0,this.numKeys=t.length}[Symbol.iterator](){return this}next(){const t=this.keyIndex;return t===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(t),U.visit(this.vals,t)]})}}class Gi{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[L].toArray().map(String)}has(t,n){return t[L].includes(n)}getOwnPropertyDescriptor(t,n){const i=t[L].indexOf(n);return i!==-1?{writable:!0,enumerable:!0,configurable:!0}:void 0}get(t,n){if(Reflect.has(t,n))return t[n];const i=t[L].indexOf(n);if(i!==-1){const r=U.visit(Reflect.get(t,tt),i);return Reflect.set(t,n,r),r}}set(t,n,i){const r=t[L].indexOf(n);return r!==-1?(M.visit(Reflect.get(t,tt),r,i),Reflect.set(t,n,i)):Reflect.has(t,n)?Reflect.set(t,n,i):!1}}Object.defineProperties(ut.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[L]:{writable:!0,enumerable:!1,configurable:!1,value:null},[tt]:{writable:!0,enumerable:!1,configurable:!1,value:null}});function Qi(e,t,n){const i=e.length,r=t>-1?t:i+t%i;return n?n(e,r):r}let ke;function Pt(e,t,n,i){const{length:r=0}=e;let s=typeof t!="number"?0:t,o=typeof n!="number"?r:n;return s<0&&(s=(s%r+r)%r),o<0&&(o=(o%r+r)%r),o<s&&(ke=s,s=o,o=ke),o>r&&(o=r),i?i(e,s,o):[s,o]}const ze=e=>e!==e;function Y(e){const t=typeof e;if(t!=="object"||e===null)return ze(e)?ze:n=>n===e;if(e instanceof Date){const n=e.valueOf();return i=>i instanceof Date?i.valueOf()===n:!1}return ArrayBuffer.isView(e)?n=>n?ae(e,n):!1:e instanceof Map?Xi(e):Array.isArray(e)?qi(e):e instanceof v?Zi(e):tr(e,!0)}function qi(e){const t=[];for(let n=-1,i=e.length;++n<i;)t[n]=Y(e[n]);return yt(t)}function Xi(e){let t=-1;const n=[];for(const i of e.values())n[++t]=Y(i);return yt(n)}function Zi(e){const t=[];for(let n=-1,i=e.length;++n<i;)t[n]=Y(e.get(n));return yt(t)}function tr(e,t=!1){const n=Object.keys(e);if(!t&&n.length===0)return()=>!1;const i=[];for(let r=-1,s=n.length;++r<s;)i[r]=Y(e[n[r]]);return yt(i,n)}function yt(e,t){return n=>{if(!n||typeof n!="object")return!1;switch(n.constructor){case Array:return er(e,n);case Map:return Re(e,n,n.keys());case ut:case ct:case Object:case void 0:return Re(e,n,t||Object.keys(n))}return n instanceof v?nr(e,n):!1}}function er(e,t){const n=e.length;if(t.length!==n)return!1;for(let i=-1;++i<n;)if(!e[i](t[i]))return!1;return!0}function nr(e,t){const n=e.length;if(t.length!==n)return!1;for(let i=-1;++i<n;)if(!e[i](t.get(i)))return!1;return!0}function Re(e,t,n){const i=n[Symbol.iterator](),r=t instanceof Map?t.keys():Object.keys(t)[Symbol.iterator](),s=t instanceof Map?t.values():Object.values(t)[Symbol.iterator]();let o=0;const a=e.length;let l=s.next(),m=i.next(),B=r.next();for(;o<a&&!m.done&&!B.done&&!l.done&&!(m.value!==B.value||!e[o](l.value));++o,m=i.next(),B=r.next(),l=s.next());return o===a&&m.done&&B.done&&l.done?!0:(i.return&&i.return(),r.return&&r.return(),s.return&&s.return(),!1)}var ir=Object.freeze({__proto__:null,clampIndex:Qi,clampRange:Pt,createElementComparator:Y});function pt(e,t,n,i){return(n&1<<i)!==0}function $t(e,t,n,i){return(n&1<<i)>>i}function rr(e,t,n){return n?!!(e[t>>3]|=1<<t%8)||!0:!(e[t>>3]&=~(1<<t%8))&&!1}function Yt(e,t,n){const i=n.byteLength+7&~7;if(e>0||n.byteLength<i){const r=new Uint8Array(i);return r.set(e%8===0?n.subarray(e>>3):Wt(new rt(n,e,t,null,pt)).subarray(0,i)),r}return n}function Wt(e){const t=[];let n=0,i=0,r=0;for(const o of e)o&&(r|=1<<i),++i===8&&(t[n++]=r,r=i=0);(n===0||i>0)&&(t[n++]=r);const s=new Uint8Array(t.length+7&~7);return s.set(t),s}class rt{constructor(t,n,i,r,s){this.bytes=t,this.length=i,this.context=r,this.get=s,this.bit=n%8,this.byteIndex=n>>3,this.byte=t[this.byteIndex++],this.index=0}next(){return this.index<this.length?(this.bit===8&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}function ft(e,t,n){if(n-t<=0)return 0;if(n-t<8){let s=0;for(const o of new rt(e,t,n-t,e,$t))s+=o;return s}const i=n>>3<<3,r=t+(t%8===0?0:8-t%8);return ft(e,t,r)+ft(e,i,n)+Pe(e,r>>3,i-r>>3)}function Pe(e,t,n){let i=0,r=Math.trunc(t);const s=new DataView(e.buffer,e.byteOffset,e.byteLength),o=n===void 0?e.byteLength:r+n;for(;o-r>=4;)i+=ht(s.getUint32(r)),r+=4;for(;o-r>=2;)i+=ht(s.getUint16(r)),r+=2;for(;o-r>=1;)i+=ht(s.getUint8(r)),r+=1;return i}function ht(e){let t=Math.trunc(e);return t=t-(t>>>1&1431655765),t=(t&858993459)+(t>>>2&858993459),(t+(t>>>4)&252645135)*16843009>>>24}var sr=Object.freeze({__proto__:null,getBool:pt,getBit:$t,setBool:rr,truncateBitmap:Yt,packBools:Wt,BitIterator:rt,popcnt_bit_range:ft,popcnt_array:Pe,popcnt_uint32:ht});const $e=-1;class I{get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let t=0;const{valueOffsets:n,values:i,nullBitmap:r,typeIds:s}=this;return n&&(t+=n.byteLength),i&&(t+=i.byteLength),r&&(t+=r.byteLength),s&&(t+=s.byteLength),this.children.reduce((o,a)=>o+a.byteLength,t)}get nullCount(){let t=this._nullCount,n;return t<=$e&&(n=this.nullBitmap)&&(this._nullCount=t=this.length-ft(n,this.offset,this.offset+this.length)),t}constructor(t,n,i,r,s,o=[],a){this.type=t,this.children=o,this.dictionary=a,this.offset=Math.floor(Math.max(n||0,0)),this.length=Math.floor(Math.max(i||0,0)),this._nullCount=Math.floor(Math.max(r||0,-1));let l;s instanceof I?(this.stride=s.stride,this.values=s.values,this.typeIds=s.typeIds,this.nullBitmap=s.nullBitmap,this.valueOffsets=s.valueOffsets):(this.stride=E(t),s&&((l=s[0])&&(this.valueOffsets=l),(l=s[1])&&(this.values=l),(l=s[2])&&(this.nullBitmap=l),(l=s[3])&&(this.typeIds=l))),this.nullable=this._nullCount!==0&&this.nullBitmap&&this.nullBitmap.byteLength>0}getValid(t){if(this.nullable&&this.nullCount>0){const n=this.offset+t,i=this.nullBitmap[n>>3];return(i&1<<n%8)!==0}return!0}setValid(t,n){if(!this.nullable)return n;if(!this.nullBitmap||this.nullBitmap.byteLength<=t>>3){const{nullBitmap:l}=this._changeLengthAndBackfillNullBitmap(this.length);Object.assign(this,{nullBitmap:l,_nullCount:0})}const{nullBitmap:i,offset:r}=this,s=r+t>>3,o=(r+t)%8,a=i[s]>>o&1;return n?a===0&&(i[s]|=1<<o,this._nullCount=this.nullCount+1):a===1&&(i[s]&=~(1<<o),this._nullCount=this.nullCount-1),n}clone(t=this.type,n=this.offset,i=this.length,r=this._nullCount,s=this,o=this.children){return new I(t,n,i,r,s,o,this.dictionary)}slice(t,n){const{stride:i,typeId:r,children:s}=this,o=+(this._nullCount===0)-1,a=r===16?i:1,l=this._sliceBuffers(t,n,i,r);return this.clone(this.type,this.offset+t,n,o,l,s.length===0||this.valueOffsets?s:this._sliceChildren(s,a*t,a*n))}_changeLengthAndBackfillNullBitmap(t){if(this.typeId===_.Null)return this.clone(this.type,0,t,0);const{length:n,nullCount:i}=this,r=new Uint8Array((t+63&~63)>>3).fill(255,0,n>>3);r[n>>3]=(1<<n-(n&~7))-1,i>0&&r.set(Yt(this.offset,n,this.nullBitmap),0);const s=this.buffers;return s[$.VALIDITY]=r,this.clone(this.type,0,t,i+(t-n),s)}_sliceBuffers(t,n,i,r){let s;const{buffers:o}=this;return(s=o[$.TYPE])&&(o[$.TYPE]=s.subarray(t,t+n)),(s=o[$.OFFSET])&&(o[$.OFFSET]=s.subarray(t,t+n+1))||(s=o[$.DATA])&&(o[$.DATA]=r===6?s:s.subarray(i*t,i*(t+n))),o}_sliceChildren(t,n,i){return t.map(r=>r.slice(n,i))}}I.prototype.children=Object.freeze([]);class st extends K{visit(t){return this.getVisitFn(t.type).call(this,t)}visitNull(t){const{["type"]:n,["offset"]:i=0,["length"]:r=0}=t;return new I(n,i,r,0)}visitBool(t){const{["type"]:n,["offset"]:i=0}=t,r=A(t.nullBitmap),s=b(n.ArrayType,t.data),{["length"]:o=s.length>>3,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new I(n,i,o,a,[void 0,s,r])}visitInt(t){const{["type"]:n,["offset"]:i=0}=t,r=A(t.nullBitmap),s=b(n.ArrayType,t.data),{["length"]:o=s.length,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new I(n,i,o,a,[void 0,s,r])}visitFloat(t){const{["type"]:n,["offset"]:i=0}=t,r=A(t.nullBitmap),s=b(n.ArrayType,t.data),{["length"]:o=s.length,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new I(n,i,o,a,[void 0,s,r])}visitUtf8(t){const{["type"]:n,["offset"]:i=0}=t,r=A(t.data),s=A(t.nullBitmap),o=J(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:l=t.nullBitmap?-1:0}=t;return new I(n,i,a,l,[o,r,s])}visitBinary(t){const{["type"]:n,["offset"]:i=0}=t,r=A(t.data),s=A(t.nullBitmap),o=J(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:l=t.nullBitmap?-1:0}=t;return new I(n,i,a,l,[o,r,s])}visitFixedSizeBinary(t){const{["type"]:n,["offset"]:i=0}=t,r=A(t.nullBitmap),s=b(n.ArrayType,t.data),{["length"]:o=s.length/E(n),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new I(n,i,o,a,[void 0,s,r])}visitDate(t){const{["type"]:n,["offset"]:i=0}=t,r=A(t.nullBitmap),s=b(n.ArrayType,t.data),{["length"]:o=s.length/E(n),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new I(n,i,o,a,[void 0,s,r])}visitTimestamp(t){const{["type"]:n,["offset"]:i=0}=t,r=A(t.nullBitmap),s=b(n.ArrayType,t.data),{["length"]:o=s.length/E(n),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new I(n,i,o,a,[void 0,s,r])}visitTime(t){const{["type"]:n,["offset"]:i=0}=t,r=A(t.nullBitmap),s=b(n.ArrayType,t.data),{["length"]:o=s.length/E(n),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new I(n,i,o,a,[void 0,s,r])}visitDecimal(t){const{["type"]:n,["offset"]:i=0}=t,r=A(t.nullBitmap),s=b(n.ArrayType,t.data),{["length"]:o=s.length/E(n),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new I(n,i,o,a,[void 0,s,r])}visitList(t){const{["type"]:n,["offset"]:i=0,["child"]:r}=t,s=A(t.nullBitmap),o=J(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:l=t.nullBitmap?-1:0}=t;return new I(n,i,a,l,[o,void 0,s],[r])}visitStruct(t){const{["type"]:n,["offset"]:i=0,["children"]:r=[]}=t,s=A(t.nullBitmap),{length:o=r.reduce((l,{length:m})=>Math.max(l,m),0),nullCount:a=t.nullBitmap?-1:0}=t;return new I(n,i,o,a,[void 0,void 0,s],r)}visitUnion(t){const{["type"]:n,["offset"]:i=0,["children"]:r=[]}=t,s=A(t.nullBitmap),o=b(n.ArrayType,t.typeIds),{["length"]:a=o.length,["nullCount"]:l=t.nullBitmap?-1:0}=t;if(W.isSparseUnion(n))return new I(n,i,a,l,[void 0,void 0,s,o],r);const m=J(t.valueOffsets);return new I(n,i,a,l,[m,void 0,s,o],r)}visitDictionary(t){const{["type"]:n,["offset"]:i=0}=t,r=A(t.nullBitmap),s=b(n.indices.ArrayType,t.data),{["dictionary"]:o=new v([new st().visit({type:n.dictionary})])}=t,{["length"]:a=s.length,["nullCount"]:l=t.nullBitmap?-1:0}=t;return new I(n,i,a,l,[void 0,s,r],[],o)}visitInterval(t){const{["type"]:n,["offset"]:i=0}=t,r=A(t.nullBitmap),s=b(n.ArrayType,t.data),{["length"]:o=s.length/E(n),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new I(n,i,o,a,[void 0,s,r])}visitFixedSizeList(t){const{["type"]:n,["offset"]:i=0,["child"]:r=new st().visit({type:n.valueType})}=t,s=A(t.nullBitmap),{["length"]:o=r.length/E(n),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new I(n,i,o,a,[void 0,void 0,s],[r])}visitMap(t){const{["type"]:n,["offset"]:i=0,["child"]:r=new st().visit({type:n.childType})}=t,s=A(t.nullBitmap),o=J(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:l=t.nullBitmap?-1:0}=t;return new I(n,i,a,l,[o,void 0,s],[r])}}function F(e){return new st().visit(e)}class Ye{constructor(t=0,n){this.numChunks=t,this.getChunkIterator=n,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){const t=this.chunkIterator.next();if(!t.done)return t;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function We(e){return e.reduce((t,n)=>t+n.nullCount,0)}function Ke(e){return e.reduce((t,n,i)=>(t[i+1]=t[i]+n.length,t),new Uint32Array(e.length+1))}function Je(e,t,n,i){const r=[];for(let s=-1,o=e.length;++s<o;){const a=e[s],l=t[s],{length:m}=a;if(l>=i)break;if(n>=l+m)continue;if(l>=n&&l+m<=i){r.push(a);continue}const B=Math.max(0,n-l),T=Math.min(i-l,m);r.push(a.slice(B,T-B))}return r.length===0&&r.push(e[0].slice(0,0)),r}function Kt(e,t,n,i){let r=0,s=0,o=t.length-1;do{if(r>=o-1)return n<t[o]?i(e,r,n-t[r]):null;s=r+Math.trunc((o-r)*.5),n<t[s]?o=s:r=s}while(r<o)}function Jt(e,t){return e.getValid(t)}function dt(e){function t(n,i,r){return e(n[i],r)}return function(n){const i=this.data;return Kt(i,this._offsets,n,t)}}function He(e){let t;function n(i,r,s){return e(i[r],s,t)}return function(i,r){const s=this.data;t=r;const o=Kt(s,this._offsets,i,n);return t=void 0,o}}function Ge(e){let t;function n(i,r,s){let o=s,a=0,l=0;for(let m=r-1,B=i.length;++m<B;){const T=i[m];if(~(a=e(T,t,o)))return l+a;o=0,l+=T.length}return-1}return function(i,r){t=i;const s=this.data,o=typeof r!="number"?n(s,0,0):Kt(s,this._offsets,r,n);return t=void 0,o}}class u extends K{}function or(e,t){return t===null&&e.length>0?0:-1}function ar(e,t){const{nullBitmap:n}=e;if(!n||e.nullCount<=0)return-1;let i=0;for(const r of new rt(n,e.offset+(t||0),e.length,n,pt)){if(!r)return i;++i}return-1}function g(e,t,n){if(t===void 0)return-1;if(t===null)return ar(e,n);const i=U.getVisitFn(e),r=Y(t);for(let s=(n||0)-1,o=e.length;++s<o;)if(r(i(e,s)))return s;return-1}function Qe(e,t,n){const i=U.getVisitFn(e),r=Y(t);for(let s=(n||0)-1,o=e.length;++s<o;)if(r(i(e,s)))return s;return-1}u.prototype.visitNull=or,u.prototype.visitBool=g,u.prototype.visitInt=g,u.prototype.visitInt8=g,u.prototype.visitInt16=g,u.prototype.visitInt32=g,u.prototype.visitInt64=g,u.prototype.visitUint8=g,u.prototype.visitUint16=g,u.prototype.visitUint32=g,u.prototype.visitUint64=g,u.prototype.visitFloat=g,u.prototype.visitFloat16=g,u.prototype.visitFloat32=g,u.prototype.visitFloat64=g,u.prototype.visitUtf8=g,u.prototype.visitBinary=g,u.prototype.visitFixedSizeBinary=g,u.prototype.visitDate=g,u.prototype.visitDateDay=g,u.prototype.visitDateMillisecond=g,u.prototype.visitTimestamp=g,u.prototype.visitTimestampSecond=g,u.prototype.visitTimestampMillisecond=g,u.prototype.visitTimestampMicrosecond=g,u.prototype.visitTimestampNanosecond=g,u.prototype.visitTime=g,u.prototype.visitTimeSecond=g,u.prototype.visitTimeMillisecond=g,u.prototype.visitTimeMicrosecond=g,u.prototype.visitTimeNanosecond=g,u.prototype.visitDecimal=g,u.prototype.visitList=g,u.prototype.visitStruct=g,u.prototype.visitUnion=g,u.prototype.visitDenseUnion=Qe,u.prototype.visitSparseUnion=Qe,u.prototype.visitDictionary=g,u.prototype.visitInterval=g,u.prototype.visitIntervalDayTime=g,u.prototype.visitIntervalYearMonth=g,u.prototype.visitFixedSizeList=g,u.prototype.visitMap=g;const Ht=new u;class y extends K{}function h(e){const{type:t}=e;if(e.nullCount===0&&e.stride===1&&(t.typeId===_.Timestamp||t instanceof on&&t.bitWidth!==64||t instanceof an&&t.bitWidth!==64||t instanceof ln&&t.precision!==et.HALF))return new Ye(e.data.length,i=>{const r=e.data[i];return r.values.subarray(0,r.length)[Symbol.iterator]()});let n=0;return new Ye(e.data.length,i=>{const r=e.data[i],s=r.length,o=e.slice(n,n+s);return n+=s,new lr(o)})}class lr{constructor(t){this.vector=t,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}y.prototype.visitNull=h,y.prototype.visitBool=h,y.prototype.visitInt=h,y.prototype.visitInt8=h,y.prototype.visitInt16=h,y.prototype.visitInt32=h,y.prototype.visitInt64=h,y.prototype.visitUint8=h,y.prototype.visitUint16=h,y.prototype.visitUint32=h,y.prototype.visitUint64=h,y.prototype.visitFloat=h,y.prototype.visitFloat16=h,y.prototype.visitFloat32=h,y.prototype.visitFloat64=h,y.prototype.visitUtf8=h,y.prototype.visitBinary=h,y.prototype.visitFixedSizeBinary=h,y.prototype.visitDate=h,y.prototype.visitDateDay=h,y.prototype.visitDateMillisecond=h,y.prototype.visitTimestamp=h,y.prototype.visitTimestampSecond=h,y.prototype.visitTimestampMillisecond=h,y.prototype.visitTimestampMicrosecond=h,y.prototype.visitTimestampNanosecond=h,y.prototype.visitTime=h,y.prototype.visitTimeSecond=h,y.prototype.visitTimeMillisecond=h,y.prototype.visitTimeMicrosecond=h,y.prototype.visitTimeNanosecond=h,y.prototype.visitDecimal=h,y.prototype.visitList=h,y.prototype.visitStruct=h,y.prototype.visitUnion=h,y.prototype.visitDenseUnion=h,y.prototype.visitSparseUnion=h,y.prototype.visitDictionary=h,y.prototype.visitInterval=h,y.prototype.visitIntervalDayTime=h,y.prototype.visitIntervalYearMonth=h,y.prototype.visitFixedSizeList=h,y.prototype.visitMap=h;const qe=new y,cr=(e,t)=>e+t;class P extends K{visitNull(t,n){return 0}visitInt(t,n){return t.type.bitWidth/8}visitFloat(t,n){return t.type.ArrayType.BYTES_PER_ELEMENT}visitBool(t,n){return 1/8}visitDecimal(t,n){return t.type.bitWidth/8}visitDate(t,n){return(t.type.unit+1)*4}visitTime(t,n){return t.type.bitWidth/8}visitTimestamp(t,n){return t.type.unit===O.SECOND?4:8}visitInterval(t,n){return(t.type.unit+1)*4}visitStruct(t,n){return t.children.reduce((i,r)=>i+z.visit(r,n),0)}visitFixedSizeBinary(t,n){return t.type.byteWidth}visitMap(t,n){return 8+t.children.reduce((i,r)=>i+z.visit(r,n),0)}visitDictionary(t,n){var i;return t.type.indices.bitWidth/8+(((i=t.dictionary)===null||i===void 0?void 0:i.getByteLength(t.values[n]))||0)}}const ur=({valueOffsets:e},t)=>8+(e[t+1]-e[t]),yr=({valueOffsets:e},t)=>8+(e[t+1]-e[t]),pr=({valueOffsets:e,stride:t,children:n},i)=>{const r=n[0],{[i*t]:s}=e,{[i*t+1]:o}=e,a=z.getVisitFn(r.type),l=r.slice(s,o-s);let m=8;for(let B=-1,T=o-s;++B<T;)m+=a(l,B);return m},fr=({stride:e,children:t},n)=>{const i=t[0],r=i.slice(n*e,e),s=z.getVisitFn(i.type);let o=0;for(let a=-1,l=r.length;++a<l;)o+=s(r,a);return o},hr=(e,t)=>e.type.mode===mt.Dense?Xe(e,t):Ze(e,t),Xe=({type:e,children:t,typeIds:n,valueOffsets:i},r)=>{const s=e.typeIdToChildIndex[n[r]];return 8+z.visit(t[s],i[r])},Ze=({children:e},t)=>4+z.visitMany(e,e.map(()=>t)).reduce(cr,0);P.prototype.visitUtf8=ur,P.prototype.visitBinary=yr,P.prototype.visitList=pr,P.prototype.visitFixedSizeList=fr,P.prototype.visitUnion=hr,P.prototype.visitDenseUnion=Xe,P.prototype.visitSparseUnion=Ze;const z=new P;var tn;const en={},nn={};class v{constructor(t){var n,i,r;const s=t[0]instanceof v?t.flatMap(a=>a.data):t;if(s.length===0||s.some(a=>!(a instanceof I)))throw new TypeError("Vector constructor expects an Array of Data instances.");const o=(n=s[0])===null||n===void 0?void 0:n.type;switch(s.length){case 0:this._offsets=[0];break;case 1:{const{get:a,set:l,indexOf:m,byteLength:B}=en[o.typeId],T=s[0];this.isValid=x=>Jt(T,x),this.get=x=>a(T,x),this.set=(x,sn)=>l(T,x,sn),this.indexOf=x=>m(T,x),this.getByteLength=x=>B(T,x),this._offsets=[0,T.length];break}default:Object.setPrototypeOf(this,nn[o.typeId]),this._offsets=Ke(s);break}this.data=s,this.type=o,this.stride=E(o),this.numChildren=(r=(i=o.children)===null||i===void 0?void 0:i.length)!==null&&r!==void 0?r:0,this.length=this._offsets.at(-1)}get byteLength(){return this._byteLength===-1&&(this._byteLength=this.data.reduce((t,n)=>t+n.byteLength,0)),this._byteLength}get nullCount(){return this._nullCount===-1&&(this._nullCount=We(this.data)),this._nullCount}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${_[this.type.typeId]}Vector`}isValid(t){return!1}get(t){return null}set(t,n){return}indexOf(t,n){return-1}includes(t,n){return this.indexOf(t,n)>0}getByteLength(t){return 0}[Symbol.iterator](){return qe.visit(this)}concat(...t){return new v(this.data.concat(t.flatMap(n=>n.data).flat(Number.POSITIVE_INFINITY)))}slice(t,n){return new v(Pt(this,t,n,({data:i,_offsets:r},s,o)=>Je(i,r,s,o)))}toJSON(){return[...this]}toArray(){const{type:t,data:n,length:i,stride:r,ArrayType:s}=this;switch(t.typeId){case _.Int:case _.Float:case _.Decimal:case _.Time:case _.Timestamp:switch(n.length){case 0:return new s;case 1:return n[0].values.subarray(0,i*r);default:return n.reduce((o,{values:a,length:l})=>(o.array.set(a.subarray(0,l*r),o.offset),o.offset+=l*r,o),{array:new s(i*r),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(t){var n;return this.getChildAt((n=this.type.children)===null||n===void 0?void 0:n.findIndex(i=>i.name===t))}getChildAt(t){return t>-1&&t<this.numChildren?new v(this.data.map(({children:n})=>n[t])):null}get isMemoized(){return W.isDictionary(this.type)?this.data[0].dictionary.isMemoized:!1}memoize(){if(W.isDictionary(this.type)){const t=new gt(this.data[0].dictionary),n=this.data.map(i=>{const r=i.clone();return r.dictionary=t,r});return new v(n)}return new gt(this)}unmemoize(){if(W.isDictionary(this.type)&&this.isMemoized){const t=this.data[0].dictionary.unmemoize(),n=this.data.map(i=>{const r=i.clone();return r.dictionary=t,r});return new v(n)}return this}}tn=Symbol.toStringTag,v[tn]=(e=>{e.type=W.prototype,e.data=[],e.length=0,e.stride=1,e.numChildren=0,e._nullCount=-1,e._byteLength=-1,e._offsets=new Uint32Array([0]),e[Symbol.isConcatSpreadable]=!0;const t=Object.keys(_).map(n=>_[n]).filter(n=>typeof n=="number"&&n!==_.NONE);for(const n of t){const i=U.getVisitFnByTypeId(n),r=M.getVisitFnByTypeId(n),s=Ht.getVisitFnByTypeId(n),o=z.getVisitFnByTypeId(n);en[n]={get:i,set:r,indexOf:s,byteLength:o},nn[n]=Object.create(e,{["isValid"]:{value:dt(Jt)},["get"]:{value:dt(U.getVisitFnByTypeId(n))},["set"]:{value:He(M.getVisitFnByTypeId(n))},["indexOf"]:{value:Ge(Ht.getVisitFnByTypeId(n))},["getByteLength"]:{value:dt(z.getVisitFnByTypeId(n))}})}return"Vector"})(v.prototype);class gt extends v{constructor(t){super(t.data);const n=this.get,i=this.set,r=this.slice,s=new Array(this.length);Object.defineProperty(this,"get",{value(o){const a=s[o];if(a!==void 0)return a;const l=n.call(this,o);return s[o]=l,l}}),Object.defineProperty(this,"set",{value(o,a){i.call(this,o,a),s[o]=a}}),Object.defineProperty(this,"slice",{value:(o,a)=>new gt(r.call(this,o,a))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new v(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}}function rn(e){if(e){if(e instanceof I)return new v([e]);if(e instanceof v)return new v(e.data);if(e.type instanceof W)return new v([F(e)]);if(Array.isArray(e))return new v(e.flatMap(t=>dr(t)));if(ArrayBuffer.isView(e)){e instanceof DataView&&(e=new Uint8Array(e.buffer));const t={offset:0,length:e.length,nullCount:0,data:e};if(e instanceof Int8Array)return new v([F(Object.assign(Object.assign({},t),{type:new cn}))]);if(e instanceof Int16Array)return new v([F(Object.assign(Object.assign({},t),{type:new un}))]);if(e instanceof Int32Array)return new v([F(Object.assign(Object.assign({},t),{type:new yn}))]);if(e instanceof BigInt64Array)return new v([F(Object.assign(Object.assign({},t),{type:new pn}))]);if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return new v([F(Object.assign(Object.assign({},t),{type:new fn}))]);if(e instanceof Uint16Array)return new v([F(Object.assign(Object.assign({},t),{type:new hn}))]);if(e instanceof Uint32Array)return new v([F(Object.assign(Object.assign({},t),{type:new dn}))]);if(e instanceof BigUint64Array)return new v([F(Object.assign(Object.assign({},t),{type:new gn}))]);if(e instanceof Float32Array)return new v([F(Object.assign(Object.assign({},t),{type:new mn}))]);if(e instanceof Float64Array)return new v([F(Object.assign(Object.assign({},t),{type:new vn}))]);throw new Error("Unrecognized input")}}throw new Error("Unrecognized input")}function dr(e){return e instanceof I?[e]:e instanceof v?e.data:rn(e).data}export{Lt as $,S as A,rt as B,ii as C,I as D,sr as E,ri as F,ei as G,ir as H,H as I,lt as J,L as K,de as L,ut as M,_t as N,Ct as O,ve as P,he as Q,St as R,ct as S,Ae as T,kt as U,v as V,zt as W,ge as X,Dt as Y,Mt as Z,Nt as _,At as a,me as a0,jt as a1,Vt as a2,xt as a3,Et as a4,Ke as a5,We as a6,qe as a7,Pt as a8,Je as a9,dt as aa,U as ab,He as ac,M as ad,Ge as ae,Ht as af,z as ag,Jt as ah,$e as ai,rn as b,se as c,re as d,qt as e,Un as f,ne as g,On as h,te as i,ie as j,Zt as k,b as l,F as m,It as n,wn as o,Wt as p,Bn as q,ee as r,Yt as s,A as t,oe as u,$t as v,pt as w,it as x,Tn as y,Sn as z};export default null;
