import{truthy as W,error as h,hasOwnProperty as y,extend as $,isArray as p,field as ee,isString as b,isFunction as k,peek as D,isBoolean as ne,isDate as re,isNumber as ie,isObject as j,isRegExp as oe,toBoolean as ae,toDate as se,toNumber as ue,toString as ce,flush as fe,lerp as le,pad as de,span as me,inrange as pe,truncate as ge,quarter as he,utcquarter as ve,extent as xe,clampRange as we,panLinear as ye,panLog as be,panPow as Se,panSymlog as Ne,zoomLinear as Ae,zoomLog as Ee,zoomPow as Pe,zoomSymlog as ze,stringValue as S,identity as Fe,array as N}from"/-/vega-util@v1.17.1-uwuqwLZrXXBeO0DFYRgh/dist=es2020,mode=imports,min/optimized/vega-util.js";import{Literal as v,constants as Re,codegenExpression as Me,functions as $e,parseExpression as De,CallExpression as je}from"/-/vega-expression@v5.0.1-M3HJnXNS0AVPna9ohQFr/dist=es2020,mode=imports,min/optimized/vega-expression.js";import{bandSpace as Ie,scale as H,scaleFraction as Te,isRegisteredScale as Le}from"/-/vega-scale@v7.3.0-RE8rHwByiw8oUoAe4pNs/dist=es2020,mode=imports,min/optimized/vega-scale.js";import{geoBounds as Xe,geoCentroid as qe,geoArea as Be}from"/-/d3-geo@v3.1.0-6gCuCN3p6hXOeZDWcbjw/dist=es2020,mode=imports,min/optimized/d3-geo.js";import{rgb as U,lab as Ve,hcl as Oe,hsl as Ye}from"/-/d3-color@v3.1.0-MWHDMwd2Pvp3NFjvrHgn/dist=es2020,mode=imports,min/optimized/d3-color.js";import{isTuple as Q}from"/-/vega-dataflow@v5.7.5-asKYS4gpPLMPf64pSozt/dist=es2020,mode=imports,min/optimized/vega-dataflow.js";import{Gradient as Ce,pathRender as Ge,pathParse as We,Bounds as Z,intersect as ke}from"/-/vega-scenegraph@v4.10.2-W1dltMWN7mO3TARazJA1/dist=es2020,mode=imports,min/optimized/vega-scenegraph.js";import{selectionVisitor as I,selectionTest as He,selectionIdTest as Ue,selectionResolve as Qe,selectionTuples as Ze}from"/-/vega-selections@v5.4.1-4yIDtA9NY6vzeN00RWao/dist=es2020,mode=imports,min/optimized/vega-selections.js";import{random as Je,cumulativeNormal as Ke,cumulativeLogNormal as _e,cumulativeUniform as tn,densityNormal as en,densityLogNormal as nn,densityUniform as rn,quantileNormal as on,quantileLogNormal as an,quantileUniform as sn,sampleNormal as un,sampleLogNormal as cn,sampleUniform as fn}from"/-/vega-statistics@v1.8.1-mXKADMfVQufwILOgkTiI/dist=es2020,mode=imports,min/optimized/vega-statistics.js";import{utcOffset as ln,utcSequence as dn,timeOffset as mn,timeSequence as pn,timeUnitSpecifier as gn,week as hn,utcweek as vn,dayofyear as xn,utcdayofyear as wn}from"/-/vega-time@v2.1.1-Q1TxQbneCNdh5ryZm2Gf/dist=es2020,mode=imports,min/optimized/vega-time.js";import{range as yn}from"/-/d3-array@v3.2.2-mREp9VYvdluM4XTkemzD/dist=es2020,mode=imports,min/optimized/d3-array.js";function T(t){const e=this.context.data[t];return e?e.values.value:[]}function J(t,e,n){const r=this.context.data[t]["index:"+e],i=r?r.value.get(n):void 0;return i&&i.count}function K(t,e){const n=this.context.dataflow,r=this.context.data[t],i=r.input;return n.pulse(i,n.changeset().remove(W).insert(e)),1}function _(t,e,n){if(t){const r=this.context.dataflow,i=t.mark.source;r.pulse(i,r.changeset().encode(t,e))}return n!==void 0?n:t}const x=t=>function(e,n){const r=this.context.dataflow.locale();return r[t](n)(e)},tt=x("format"),L=x("timeFormat"),et=x("utcFormat"),nt=x("timeParse"),rt=x("utcParse"),A=new Date(2e3,0,1);function E(t,e,n){return!Number.isInteger(t)||!Number.isInteger(e)?"":(A.setYear(2e3),A.setMonth(t),A.setDate(e),L.call(this,A,n))}function it(t){return E.call(this,t,1,"%B")}function ot(t){return E.call(this,t,1,"%b")}function at(t){return E.call(this,0,2+t,"%A")}function st(t){return E.call(this,0,2+t,"%a")}const ut=":",ct="@",P="%",X="$";function z(t,e,n,r){e[0].type!==v&&h("First argument to data functions must be a string literal.");const i=e[0].value,o=ut+i;if(!y(o,r))try{r[o]=n.getData(i).tuplesRef()}catch(a){}}function ft(t,e,n,r){e[0].type!==v&&h("First argument to indata must be a string literal."),e[1].type!==v&&h("Second argument to indata must be a string literal.");const i=e[0].value,o=e[1].value,a=ct+o;y(a,r)||(r[a]=n.getData(i).indataRef(n,o))}function f(t,e,n,r){if(e[0].type===v)lt(n,r,e[0].value);else for(t in n.scales)lt(n,r,t)}function lt(t,e,n){const r=P+n;if(!y(e,r))try{e[r]=t.scaleRef(n)}catch(i){}}function m(t,e){if(k(t))return t;if(b(t)){const n=e.scales[t];return n&&Le(n.value)?n.value:void 0}return}function bn(t,e,n){e.__bandwidth=i=>i&&i.bandwidth?i.bandwidth():0,n._bandwidth=f,n._range=f,n._scale=f;const r=i=>"_["+(i.type===v?S(P+i.value):S(P)+"+"+t(i))+"]";return{_bandwidth:i=>`this.__bandwidth(${r(i[0])})`,_range:i=>`${r(i[0])}.range()`,_scale:i=>`${r(i[0])}(${t(i[1])})`}}function q(t,e){return function(n,r,i){if(n){const o=m(n,(i||this).context);return o&&o.path[t](r)}else return e(r)}}const dt=q("area",Be),mt=q("bounds",Xe),pt=q("centroid",qe);function gt(t){const e=this.context.group;let n=!1;if(e)for(;t;){if(t===e){n=!0;break}t=t.mark.group}return n}function B(t,e,n){try{t[e].apply(t,["EXPRESSION"].concat([].slice.call(n)))}catch(r){t.warn(r)}return n[n.length-1]}function ht(){return B(this.context.dataflow,"warn",arguments)}function vt(){return B(this.context.dataflow,"info",arguments)}function xt(){return B(this.context.dataflow,"debug",arguments)}function V(t){const e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}function F(t){const e=U(t),n=V(e.r),r=V(e.g),i=V(e.b);return .2126*n+.7152*r+.0722*i}function wt(t,e){const n=F(t),r=F(e),i=Math.max(n,r),o=Math.min(n,r);return(i+.05)/(o+.05)}function yt(){const t=[].slice.call(arguments);return t.unshift({}),$(...t)}function bt(t,e){return t===e||t!==t&&e!==e?!0:p(t)?p(e)&&t.length===e.length?Sn(t,e):!1:j(t)&&j(e)?St(t,e):!1}function Sn(t,e){for(let n=0,r=t.length;n<r;++n)if(!bt(t[n],e[n]))return!1;return!0}function St(t,e){for(const n in t)if(!bt(t[n],e[n]))return!1;return!0}function Nt(t){return e=>St(t,e)}function At(t,e,n,r,i,o){const a=this.context.dataflow,c=this.context.data[t],s=c.input,l=a.stamp();let d=c.changes,g,M;if(a._trigger===!1||!(s.value.length||e||r))return 0;if((!d||d.stamp<l)&&(c.changes=d=a.changeset(),d.stamp=l,a.runAfter(()=>{c.modified=!0,a.pulse(s,d).run()},!0,1)),n&&(g=n===!0?W:p(n)||Q(n)?n:Nt(n),d.remove(g)),e&&d.insert(e),r&&(g=Nt(r),s.value.some(g)?d.remove(g):d.insert(r)),i)for(M in o)d.modify(i,M,o[M]);return 1}function Et(t){const e=t.touches,n=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.sqrt(n*n+r*r)}function Pt(t){const e=t.touches;return Math.atan2(e[0].clientY-e[1].clientY,e[0].clientX-e[1].clientX)}const zt={};function Ft(t,e){const n=zt[e]||(zt[e]=ee(e));return p(t)?t.map(n):n(t)}function O(t){return p(t)||ArrayBuffer.isView(t)?t:null}function Y(t){return O(t)||(b(t)?t:null)}function Rt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return O(t).join(...n)}function Mt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Y(t).indexOf(...n)}function $t(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Y(t).lastIndexOf(...n)}function Dt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Y(t).slice(...n)}function jt(t,e,n){return k(n)&&h("Function argument passed to replace."),String(t).replace(e,n)}function It(t){return O(t).slice().reverse()}function Tt(t,e,n){return Ie(t||0,e||0,n||0)}function Lt(t,e){const n=m(t,(e||this).context);return n&&n.bandwidth?n.bandwidth():0}function Xt(t,e){const n=m(t,(e||this).context);return n?n.copy():void 0}function qt(t,e){const n=m(t,(e||this).context);return n?n.domain():[]}function Bt(t,e,n){const r=m(t,(n||this).context);return r?p(e)?(r.invertRange||r.invert)(e):(r.invert||r.invertExtent)(e):void 0}function Vt(t,e){const n=m(t,(e||this).context);return n&&n.range?n.range():[]}function Ot(t,e,n){const r=m(t,(n||this).context);return r?r(e):void 0}function Yt(t,e,n,r,i){t=m(t,(i||this).context);const o=Ce(e,n);let a=t.domain(),c=a[0],s=D(a),l=Fe;return s-c?l=Te(t,c,s):t=(t.interpolator?H("sequential")().interpolator(t.interpolator()):H("linear")().interpolate(t.interpolate()).range(t.range())).domain([c=0,s=1]),t.ticks&&(a=t.ticks(+r||15),c!==a[0]&&a.unshift(c),s!==D(a)&&a.push(s)),a.forEach(d=>o.stop(l(d),t(d))),o}function Ct(t,e,n){const r=m(t,(n||this).context);return function(i){return r?r.path.context(i)(e):""}}function Gt(t){let e=null;return function(n){return n?Ge(n,e=e||We(t)):t}}const Wt=t=>t.data;function kt(t,e){const n=T.call(e,t);return n.root&&n.root.lookup||{}}function Ht(t,e,n){const r=kt(t,this),i=r[e],o=r[n];return i&&o?i.path(o).map(Wt):void 0}function Ut(t,e){const n=kt(t,this)[e];return n?n.ancestors().map(Wt):void 0}const Qt=()=>typeof window!="undefined"&&window||null;function Zt(){const t=Qt();return t?t.screen:{}}function Jt(){const t=Qt();return t?[t.innerWidth,t.innerHeight]:[void 0,void 0]}function Kt(){const t=this.context.dataflow,e=t.container&&t.container();return e?[e.clientWidth,e.clientHeight]:[void 0,void 0]}function _t(t,e,n){if(!t)return[];const[r,i]=t,o=new Z().set(r[0],r[1],i[0],i[1]),a=n||this.context.dataflow.scenegraph().root;return ke(a,o,Nn(e))}function Nn(t){let e=null;if(t){const n=N(t.marktype),r=N(t.markname);e=i=>(!n.length||n.some(o=>i.marktype===o))&&(!r.length||r.some(o=>i.name===o))}return e}function An(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5;t=N(t);const i=t[t.length-1];return i===void 0||Math.sqrt((i[0]-e)**2+(i[1]-n)**2)>r?[...t,[e,n]]:t}function En(t){return N(t).reduce((e,n,r)=>{let[i,o]=n;return e+=r==0?`M ${i},${o} `:r===t.length-1?" Z":`L ${i},${o} `},"")}function Pn(t,e,n){const{x:r,y:i,mark:o}=n,a=new Z().set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[s,l]of e)s<a.x1&&(a.x1=s),s>a.x2&&(a.x2=s),l<a.y1&&(a.y1=l),l>a.y2&&(a.y2=l);a.translate(r,i);const c=_t([[a.x1,a.y1],[a.x2,a.y2]],t,o);return c.filter(s=>zn(s.x,s.y,e))}function zn(t,e,n){let r=0;for(let i=0,o=n.length-1;i<n.length;o=i++){const[a,c]=n[o],[s,l]=n[i];l>e!=c>e&&t<(a-s)*(e-l)/(c-l)+s&&r++}return r&1}const w={random(){return Je()},cumulativeNormal:Ke,cumulativeLogNormal:_e,cumulativeUniform:tn,densityNormal:en,densityLogNormal:nn,densityUniform:rn,quantileNormal:on,quantileLogNormal:an,quantileUniform:sn,sampleNormal:un,sampleLogNormal:cn,sampleUniform:fn,isArray:p,isBoolean:ne,isDate:re,isDefined(t){return t!==void 0},isNumber:ie,isObject:j,isRegExp:oe,isString:b,isTuple:Q,isValid(t){return t!=null&&t===t},toBoolean:ae,toDate(t){return se(t)},toNumber:ue,toString:ce,indexof:Mt,join:Rt,lastindexof:$t,replace:jt,reverse:It,slice:Dt,flush:fe,lerp:le,merge:yt,pad:de,peek:D,pluck:Ft,span:me,inrange:pe,truncate:ge,rgb:U,lab:Ve,hcl:Oe,hsl:Ye,luminance:F,contrast:wt,sequence:yn,format:tt,utcFormat:et,utcParse:rt,utcOffset:ln,utcSequence:dn,timeFormat:L,timeParse:nt,timeOffset:mn,timeSequence:pn,timeUnitSpecifier:gn,monthFormat:it,monthAbbrevFormat:ot,dayFormat:at,dayAbbrevFormat:st,quarter:he,utcquarter:ve,week:hn,utcweek:vn,dayofyear:xn,utcdayofyear:wn,warn:ht,info:vt,debug:xt,extent(t){return xe(t)},inScope:gt,intersect:_t,clampRange:we,pinchDistance:Et,pinchAngle:Pt,screen:Zt,containerSize:Kt,windowSize:Jt,bandspace:Tt,setdata:K,pathShape:Gt,panLinear:ye,panLog:be,panPow:Se,panSymlog:Ne,zoomLinear:Ae,zoomLog:Ee,zoomPow:Pe,zoomSymlog:ze,encode:_,modify:At,lassoAppend:An,lassoPath:En,intersectLasso:Pn},Fn=["view","item","group","xy","x","y"],Rn="event.vega.",te="this.",C={},G={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:t=>`_[${S(X+t)}]`,functions:Mn,constants:Re,visitors:C},R=Me(G);function Mn(t){const e=$e(t);Fn.forEach(n=>e[n]=Rn+n);for(const n in w)e[n]=te+n;return $(e,bn(t,w,C)),e}function u(t,e,n){return arguments.length===1?w[t]:(w[t]=e,n&&(C[t]=n),R&&(R.functions[t]=te+t),this)}u("bandwidth",Lt,f),u("copy",Xt,f),u("domain",qt,f),u("range",Vt,f),u("invert",Bt,f),u("scale",Ot,f),u("gradient",Yt,f),u("geoArea",dt,f),u("geoBounds",mt,f),u("geoCentroid",pt,f),u("geoShape",Ct,f),u("indata",J,ft),u("data",T,z),u("treePath",Ht,z),u("treeAncestors",Ut,z),u("vlSelectionTest",He,I),u("vlSelectionIdTest",Ue,I),u("vlSelectionResolve",Qe,I),u("vlSelectionTuples",Ze);function $n(t,e){const n={};let r;try{t=b(t)?t:S(t)+"",r=De(t)}catch(o){h("Expression parse error: "+t)}r.visit(o=>{if(o.type!==je)return;const a=o.callee.name,c=G.visitors[a];c&&c(a,o.arguments,e,n)});const i=R(r);return i.globals.forEach(o=>{const a=X+o;!y(n,a)&&e.getSignal(o)&&(n[a]=e.signalRef(o))}),{$expr:$({code:i.code},e.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}export{ut as DataPrefix,ct as IndexPrefix,P as ScalePrefix,X as SignalPrefix,Tt as bandspace,Lt as bandwidth,R as codeGenerator,G as codegenParams,Kt as containerSize,wt as contrast,Xt as copy,T as data,z as dataVisitor,st as dayAbbrevFormat,at as dayFormat,xt as debug,qt as domain,_ as encode,u as expressionFunction,tt as format,w as functionContext,dt as geoArea,mt as geoBounds,pt as geoCentroid,Ct as geoShape,gt as inScope,J as indata,ft as indataVisitor,Mt as indexof,vt as info,Bt as invert,Rt as join,$t as lastindexof,F as luminance,yt as merge,At as modify,ot as monthAbbrevFormat,it as monthFormat,$n as parseExpression,Gt as pathShape,Pt as pinchAngle,Et as pinchDistance,Ft as pluck,Vt as range,jt as replace,It as reverse,Ot as scale,Yt as scaleGradient,f as scaleVisitor,Zt as screen,K as setdata,Dt as slice,L as timeFormat,nt as timeParse,Ut as treeAncestors,Ht as treePath,et as utcFormat,rt as utcParse,ht as warn,Jt as windowSize};export default null;
