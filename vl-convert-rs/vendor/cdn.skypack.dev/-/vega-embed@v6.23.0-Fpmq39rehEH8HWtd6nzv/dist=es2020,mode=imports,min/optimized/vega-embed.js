import{applyPatch as ht}from"/-/fast-json-patch@v3.1.1-IjacxII42OC4A6OXhkDe/dist=es2020,mode=imports,min/optimized/fast-json-patch.js";import Oe from"/-/json-stringify-pretty-compact@v3.0.0-RM0i5NMwoiFhg7YNuXef/dist=es2020,mode=imports,min/optimized/json-stringify-pretty-compact.js";import*as ft from"/-/vega@v5.25.0-r16knbfAAfBFDoUvoc7K/dist=es2020,mode=imports,min/optimized/vega.js";import{isString as fe,mergeConfig as _e,isBoolean as pt,isObject as dt,writeConfig as mt}from"/-/vega@v5.25.0-r16knbfAAfBFDoUvoc7K/dist=es2020,mode=imports,min/optimized/vega.js";import{expressionInterpreter as vt}from"/-/vega-interpreter@v1.0.5-xGayK8haM1EVgaoW7oOi/dist=es2020,mode=imports,min/optimized/vega-interpreter.js";import*as Et from"/-/vega-lite@v5.15.0-l27jdbpFztiLqmj2Waun/dist=es2020,mode=imports,min/optimized/vega-lite.js";import je from"/-/vega-schema-url-parser@v2.2.0-YmXJGRcKOXOac3VG4xfw/dist=es2020,mode=imports,min/optimized/vega-schema-url-parser.js";import*as gt from"/-/vega-themes@v2.14.0-RvUmNETlVH2y3yQM1y36/dist=es2020,mode=imports,min/optimized/vega-themes.js";import{Handler as yt}from"/-/vega-tooltip@v0.33.0-DfMhYyd4NOGdbNfmDNiw/dist=es2020,mode=imports,min/optimized/vega-tooltip.js";function Fe(){throw new Error("setTimeout has not been defined")}function Ge(){throw new Error("clearTimeout has not been defined")}var W=Fe,q=Ge,Z;typeof window!="undefined"?Z=window:typeof self!="undefined"?Z=self:Z={},typeof Z.setTimeout=="function"&&(W=setTimeout),typeof Z.clearTimeout=="function"&&(q=clearTimeout);function Ue(t){if(W===setTimeout)return setTimeout(t,0);if((W===Fe||!W)&&setTimeout)return W=setTimeout,setTimeout(t,0);try{return W(t,0)}catch(e){try{return W.call(null,t,0)}catch(r){return W.call(this,t,0)}}}function $t(t){if(q===clearTimeout)return clearTimeout(t);if((q===Ge||!q)&&clearTimeout)return q=clearTimeout,clearTimeout(t);try{return q(t)}catch(e){try{return q.call(null,t)}catch(r){return q.call(this,t)}}}var z=[],ee=!1,B,pe=-1;function bt(){if(!ee||!B)return;ee=!1,B.length?z=B.concat(z):pe=-1,z.length&&Xe()}function Xe(){if(ee)return;var t=Ue(bt);ee=!0;for(var e=z.length;e;){for(B=z,z=[];++pe<e;)B&&B[pe].run();pe=-1,e=z.length}B=null,ee=!1,$t(t)}function It(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];z.push(new Ve(t,e)),z.length===1&&!ee&&Ue(Xe)}function Ve(t,e){this.fun=t,this.array=e}Ve.prototype.run=function(){this.fun.apply(null,this.array)};var Rt="browser",Ot="browser",Lt=!0,Nt=[],Tt="",At={},wt={},St={};function K(){}var xt=K,Ct=K,Dt=K,Pt=K,_t=K,jt=K,Ft=K;function Gt(t){throw new Error("process.binding is not supported")}function Ut(){return"/"}function Xt(t){throw new Error("process.chdir is not supported")}function Vt(){return 0}var te=Z.performance||{},zt=te.now||te.mozNow||te.msNow||te.oNow||te.webkitNow||function(){return new Date().getTime()};function Ht(t){var e=zt.call(te)*.001,r=Math.floor(e),i=Math.floor(e%1*1e9);return t&&(r=r-t[0],i=i-t[1],i<0&&(r--,i+=1e9)),[r,i]}var Mt=new Date;function Wt(){var t=new Date,e=t-Mt;return e/1e3}var de={nextTick:It,title:Rt,browser:Lt,env:{NODE_ENV:"production"},argv:Nt,version:Tt,versions:At,on:xt,addListener:Ct,once:Dt,off:Pt,removeListener:_t,removeAllListeners:jt,emit:Ft,binding:Gt,cwd:Ut,chdir:Xt,umask:Vt,hrtime:Ht,platform:Ot,release:wt,config:St,uptime:Wt};function le(t){return le=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},le(t)}function qt(t,e){if(le(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(le(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yt(t){var e=qt(t,"string");return le(e)==="symbol"?e:String(e)}function Bt(t,e,r){return e=Yt(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Kt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Le,ze;function kt(){return ze||(ze=1,Le=function(t){t.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}),Le}var Jt=$;$.Node=k,$.create=$;function $(t){var e=this;if(e instanceof $||(e=new $),e.tail=null,e.head=null,e.length=0,t&&typeof t.forEach=="function")t.forEach(function(n){e.push(n)});else if(arguments.length>0)for(var r=0,i=arguments.length;r<i;r++)e.push(arguments[r]);return e}$.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,r=t.prev;return e&&(e.prev=r),r&&(r.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=r),t.list.length--,t.next=null,t.prev=null,t.list=null,e},$.prototype.unshiftNode=function(t){if(t===this.head)return;t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++},$.prototype.pushNode=function(t){if(t===this.tail)return;t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++},$.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)Zt(this,arguments[t]);return this.length},$.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)er(this,arguments[t]);return this.length},$.prototype.pop=function(){if(!this.tail)return;var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t},$.prototype.shift=function(){if(!this.head)return;var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t},$.prototype.forEach=function(t,e){e=e||this;for(var r=this.head,i=0;r!==null;i++)t.call(e,r.value,i,this),r=r.next},$.prototype.forEachReverse=function(t,e){e=e||this;for(var r=this.tail,i=this.length-1;r!==null;i--)t.call(e,r.value,i,this),r=r.prev},$.prototype.get=function(t){for(var e=0,r=this.head;r!==null&&e<t;e++)r=r.next;if(e===t&&r!==null)return r.value},$.prototype.getReverse=function(t){for(var e=0,r=this.tail;r!==null&&e<t;e++)r=r.prev;if(e===t&&r!==null)return r.value},$.prototype.map=function(t,e){e=e||this;for(var r=new $,i=this.head;i!==null;)r.push(t.call(e,i.value,this)),i=i.next;return r},$.prototype.mapReverse=function(t,e){e=e||this;for(var r=new $,i=this.tail;i!==null;)r.push(t.call(e,i.value,this)),i=i.prev;return r},$.prototype.reduce=function(t,e){var r,i=this.head;if(arguments.length>1)r=e;else if(this.head)i=this.head.next,r=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var n=0;i!==null;n++)r=t(r,i.value,n),i=i.next;return r},$.prototype.reduceReverse=function(t,e){var r,i=this.tail;if(arguments.length>1)r=e;else if(this.tail)i=this.tail.prev,r=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var n=this.length-1;i!==null;n--)r=t(r,i.value,n),i=i.prev;return r},$.prototype.toArray=function(){for(var t=new Array(this.length),e=0,r=this.head;r!==null;e++)t[e]=r.value,r=r.next;return t},$.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,r=this.tail;r!==null;e++)t[e]=r.value,r=r.prev;return t},$.prototype.slice=function(t,e){e=e||this.length,e<0&&(e+=this.length),t=t||0,t<0&&(t+=this.length);var r=new $;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=0,n=this.head;n!==null&&i<t;i++)n=n.next;for(;n!==null&&i<e;i++,n=n.next)r.push(n.value);return r},$.prototype.sliceReverse=function(t,e){e=e||this.length,e<0&&(e+=this.length),t=t||0,t<0&&(t+=this.length);var r=new $;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=this.length,n=this.tail;n!==null&&i>e;i--)n=n.prev;for(;n!==null&&i>t;i--,n=n.prev)r.push(n.value);return r},$.prototype.splice=function(t,e,...r){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var i=0,n=this.head;n!==null&&i<t;i++)n=n.next;for(var a=[],i=0;n&&i<e;i++)a.push(n.value),n=this.removeNode(n);n===null&&(n=this.tail),n!==this.head&&n!==this.tail&&(n=n.prev);for(var i=0;i<r.length;i++)n=Qt(this,n,r[i]);return a},$.prototype.reverse=function(){for(var t=this.head,e=this.tail,r=t;r!==null;r=r.prev){var i=r.prev;r.prev=r.next,r.next=i}return this.head=e,this.tail=t,this};function Qt(t,e,r){var i=e===t.head?new k(r,null,e,t):new k(r,e,e.next,t);return i.next===null&&(t.tail=i),i.prev===null&&(t.head=i),t.length++,i}function Zt(t,e){t.tail=new k(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function er(t,e){t.head=new k(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function k(t,e,r,i){if(!(this instanceof k))return new k(t,e,r,i);this.list=i,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}try{kt()($)}catch(t){}const tr=Jt,J=Symbol("max"),H=Symbol("length"),re=Symbol("lengthCalculator"),ce=Symbol("allowStale"),Q=Symbol("maxAge"),M=Symbol("dispose"),He=Symbol("noDisposeOnSet"),C=Symbol("lruList"),U=Symbol("cache"),Me=Symbol("updateAgeOnGet"),Ne=()=>1;class rr{constructor(e){if(typeof e=="number"&&(e={max:e}),e||(e={}),e.max&&(typeof e.max!="number"||e.max<0))throw new TypeError("max must be a non-negative number");this[J]=e.max||Infinity;const r=e.length||Ne;if(this[re]=typeof r!="function"?Ne:r,this[ce]=e.stale||!1,e.maxAge&&typeof e.maxAge!="number")throw new TypeError("maxAge must be a number");this[Q]=e.maxAge||0,this[M]=e.dispose,this[He]=e.noDisposeOnSet||!1,this[Me]=e.updateAgeOnGet||!1,this.reset()}set max(e){if(typeof e!="number"||e<0)throw new TypeError("max must be a non-negative number");this[J]=e||Infinity,ue(this)}get max(){return this[J]}set allowStale(e){this[ce]=!!e}get allowStale(){return this[ce]}set maxAge(e){if(typeof e!="number")throw new TypeError("maxAge must be a non-negative number");this[Q]=e,ue(this)}get maxAge(){return this[Q]}set lengthCalculator(e){typeof e!="function"&&(e=Ne),e!==this[re]&&(this[re]=e,this[H]=0,this[C].forEach(r=>{r.length=this[re](r.value,r.key),this[H]+=r.length})),ue(this)}get lengthCalculator(){return this[re]}get length(){return this[H]}get itemCount(){return this[C].length}rforEach(e,r){r=r||this;for(let i=this[C].tail;i!==null;){const n=i.prev;We(this,e,i,r),i=n}}forEach(e,r){r=r||this;for(let i=this[C].head;i!==null;){const n=i.next;We(this,e,i,r),i=n}}keys(){return this[C].toArray().map(e=>e.key)}values(){return this[C].toArray().map(e=>e.value)}reset(){this[M]&&this[C]&&this[C].length&&this[C].forEach(e=>this[M](e.key,e.value)),this[U]=new Map,this[C]=new tr,this[H]=0}dump(){return this[C].map(e=>me(this,e)?!1:{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[C]}set(e,r,i){if(i=i||this[Q],i&&typeof i!="number")throw new TypeError("maxAge must be a number");const n=i?Date.now():0,a=this[re](r,e);if(this[U].has(e)){if(a>this[J])return ie(this,this[U].get(e)),!1;const b=this[U].get(e),s=b.value;return this[M]&&(this[He]||this[M](e,s.value)),s.now=n,s.maxAge=i,s.value=r,this[H]+=a-s.length,s.length=a,this.get(e),ue(this),!0}const I=new ir(e,r,a,n,i);return I.length>this[J]?(this[M]&&this[M](e,r),!1):(this[H]+=I.length,this[C].unshift(I),this[U].set(e,this[C].head),ue(this),!0)}has(e){if(!this[U].has(e))return!1;const r=this[U].get(e).value;return!me(this,r)}get(e){return Te(this,e,!0)}peek(e){return Te(this,e,!1)}pop(){const e=this[C].tail;return e?(ie(this,e),e.value):null}del(e){ie(this,this[U].get(e))}load(e){this.reset();const r=Date.now();for(let i=e.length-1;i>=0;i--){const n=e[i],a=n.e||0;if(a===0)this.set(n.k,n.v);else{const I=a-r;I>0&&this.set(n.k,n.v,I)}}}prune(){this[U].forEach((e,r)=>Te(this,r,!1))}}const Te=(t,e,r)=>{const i=t[U].get(e);if(i){const n=i.value;if(me(t,n)){if(ie(t,i),!t[ce])return}else r&&(t[Me]&&(i.value.now=Date.now()),t[C].unshiftNode(i));return n.value}},me=(t,e)=>{if(!e||!e.maxAge&&!t[Q])return!1;const r=Date.now()-e.now;return e.maxAge?r>e.maxAge:t[Q]&&r>t[Q]},ue=t=>{if(t[H]>t[J])for(let e=t[C].tail;t[H]>t[J]&&e!==null;){const r=e.prev;ie(t,e),e=r}},ie=(t,e)=>{if(e){const r=e.value;t[M]&&t[M](r.key,r.value),t[H]-=r.length,t[U].delete(r.key),t[C].removeNode(e)}};class ir{constructor(e,r,i,n,a){this.key=e,this.value=r,this.length=i,this.now=n,this.maxAge=a||0}}const We=(t,e,r,i)=>{let n=r.value;me(t,n)&&(ie(t,r),t[ce]||(n=void 0)),n&&e.call(i,n.value,n.key,t)};var nr=rr;const sr=Object.freeze({loose:!0}),ar=Object.freeze({}),or=t=>t?typeof t!="object"?sr:t:ar;var Ae=or,we={exports:{}};const lr="2.0.0",qe=256,cr=Number.MAX_SAFE_INTEGER||9007199254740991,ur=16,hr=qe-6,fr=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var Se={MAX_LENGTH:qe,MAX_SAFE_COMPONENT_LENGTH:ur,MAX_SAFE_BUILD_LENGTH:hr,MAX_SAFE_INTEGER:cr,RELEASE_TYPES:fr,SEMVER_SPEC_VERSION:lr,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2};const pr=typeof de=="object"&&de.env&&de.env.NODE_DEBUG&&/\bsemver\b/i.test(de.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};var ve=pr;(function(t,e){const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:n}=Se,a=ve;e=t.exports={};const I=e.re=[],b=e.safeRe=[],s=e.src=[],o=e.t={};let h=0;const g="[a-zA-Z0-9-]",S=[["\\s",1],["\\d",n],[g,i]],_=G=>{for(const[D,x]of S)G=G.split(`${D}*`).join(`${D}{0,${x}}`).split(`${D}+`).join(`${D}{1,${x}}`);return G},f=(G,D,x)=>{const O=_(D),j=h++;a(G,j,D),o[G]=j,s[j]=D,I[j]=new RegExp(D,x?"g":void 0),b[j]=new RegExp(O,x?"g":void 0)};f("NUMERICIDENTIFIER","0|[1-9]\\d*"),f("NUMERICIDENTIFIERLOOSE","\\d+"),f("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${g}*`),f("MAINVERSION",`(${s[o.NUMERICIDENTIFIER]})\\.(${s[o.NUMERICIDENTIFIER]})\\.(${s[o.NUMERICIDENTIFIER]})`),f("MAINVERSIONLOOSE",`(${s[o.NUMERICIDENTIFIERLOOSE]})\\.(${s[o.NUMERICIDENTIFIERLOOSE]})\\.(${s[o.NUMERICIDENTIFIERLOOSE]})`),f("PRERELEASEIDENTIFIER",`(?:${s[o.NUMERICIDENTIFIER]}|${s[o.NONNUMERICIDENTIFIER]})`),f("PRERELEASEIDENTIFIERLOOSE",`(?:${s[o.NUMERICIDENTIFIERLOOSE]}|${s[o.NONNUMERICIDENTIFIER]})`),f("PRERELEASE",`(?:-(${s[o.PRERELEASEIDENTIFIER]}(?:\\.${s[o.PRERELEASEIDENTIFIER]})*))`),f("PRERELEASELOOSE",`(?:-?(${s[o.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[o.PRERELEASEIDENTIFIERLOOSE]})*))`),f("BUILDIDENTIFIER",`${g}+`),f("BUILD",`(?:\\+(${s[o.BUILDIDENTIFIER]}(?:\\.${s[o.BUILDIDENTIFIER]})*))`),f("FULLPLAIN",`v?${s[o.MAINVERSION]}${s[o.PRERELEASE]}?${s[o.BUILD]}?`),f("FULL",`^${s[o.FULLPLAIN]}$`),f("LOOSEPLAIN",`[v=\\s]*${s[o.MAINVERSIONLOOSE]}${s[o.PRERELEASELOOSE]}?${s[o.BUILD]}?`),f("LOOSE",`^${s[o.LOOSEPLAIN]}$`),f("GTLT","((?:<|>)?=?)"),f("XRANGEIDENTIFIERLOOSE",`${s[o.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),f("XRANGEIDENTIFIER",`${s[o.NUMERICIDENTIFIER]}|x|X|\\*`),f("XRANGEPLAIN",`[v=\\s]*(${s[o.XRANGEIDENTIFIER]})(?:\\.(${s[o.XRANGEIDENTIFIER]})(?:\\.(${s[o.XRANGEIDENTIFIER]})(?:${s[o.PRERELEASE]})?${s[o.BUILD]}?)?)?`),f("XRANGEPLAINLOOSE",`[v=\\s]*(${s[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[o.XRANGEIDENTIFIERLOOSE]})(?:${s[o.PRERELEASELOOSE]})?${s[o.BUILD]}?)?)?`),f("XRANGE",`^${s[o.GTLT]}\\s*${s[o.XRANGEPLAIN]}$`),f("XRANGELOOSE",`^${s[o.GTLT]}\\s*${s[o.XRANGEPLAINLOOSE]}$`),f("COERCE",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?(?:$|[^\\d])`),f("COERCERTL",s[o.COERCE],!0),f("LONETILDE","(?:~>?)"),f("TILDETRIM",`(\\s*)${s[o.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",f("TILDE",`^${s[o.LONETILDE]}${s[o.XRANGEPLAIN]}$`),f("TILDELOOSE",`^${s[o.LONETILDE]}${s[o.XRANGEPLAINLOOSE]}$`),f("LONECARET","(?:\\^)"),f("CARETTRIM",`(\\s*)${s[o.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",f("CARET",`^${s[o.LONECARET]}${s[o.XRANGEPLAIN]}$`),f("CARETLOOSE",`^${s[o.LONECARET]}${s[o.XRANGEPLAINLOOSE]}$`),f("COMPARATORLOOSE",`^${s[o.GTLT]}\\s*(${s[o.LOOSEPLAIN]})$|^$`),f("COMPARATOR",`^${s[o.GTLT]}\\s*(${s[o.FULLPLAIN]})$|^$`),f("COMPARATORTRIM",`(\\s*)${s[o.GTLT]}\\s*(${s[o.LOOSEPLAIN]}|${s[o.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",f("HYPHENRANGE",`^\\s*(${s[o.XRANGEPLAIN]})\\s+-\\s+(${s[o.XRANGEPLAIN]})\\s*$`),f("HYPHENRANGELOOSE",`^\\s*(${s[o.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[o.XRANGEPLAINLOOSE]})\\s*$`),f("STAR","(<|>)?=?\\s*\\*"),f("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),f("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(we,we.exports);var xe=we.exports;const Ye=/^[0-9]+$/,Be=(t,e)=>{const r=Ye.test(t),i=Ye.test(e);return r&&i&&(t=+t,e=+e),t===e?0:r&&!i?-1:i&&!r?1:t<e?-1:1},dr=(t,e)=>Be(e,t);var mr={compareIdentifiers:Be,rcompareIdentifiers:dr};const Ee=ve,{MAX_LENGTH:Ke,MAX_SAFE_INTEGER:ge}=Se,{safeRe:ke,t:Je}=xe,vr=Ae,{compareIdentifiers:ne}=mr;let Er=class V{constructor(e,r){if(r=vr(r),e instanceof V){if(e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>Ke)throw new TypeError(`version is longer than ${Ke} characters`);Ee("SemVer",e,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;const i=e.trim().match(r.loose?ke[Je.LOOSE]:ke[Je.FULL]);if(!i)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>ge||this.major<0)throw new TypeError("Invalid major version");if(this.minor>ge||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>ge||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map(n=>{if(/^[0-9]+$/.test(n)){const a=+n;if(a>=0&&a<ge)return a}return n}):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(Ee("SemVer.compare",this.version,this.options,e),!(e instanceof V)){if(typeof e=="string"&&e===this.version)return 0;e=new V(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof V||(e=new V(e,this.options)),ne(this.major,e.major)||ne(this.minor,e.minor)||ne(this.patch,e.patch)}comparePre(e){if(e instanceof V||(e=new V(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let r=0;do{const i=this.prerelease[r],n=e.prerelease[r];if(Ee("prerelease compare",r,i,n),i===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(i===void 0)return-1;if(i===n)continue;return ne(i,n)}while(++r)}compareBuild(e){e instanceof V||(e=new V(e,this.options));let r=0;do{const i=this.build[r],n=e.build[r];if(Ee("prerelease compare",r,i,n),i===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(i===void 0)return-1;if(i===n)continue;return ne(i,n)}while(++r)}inc(e,r,i){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,i);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,i);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,i),this.inc("pre",r,i);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,i),this.inc("pre",r,i);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const n=Number(i)?1:0;if(!r&&i===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[n];else{let a=this.prerelease.length;for(;--a>=0;)typeof this.prerelease[a]=="number"&&(this.prerelease[a]++,a=-2);if(a===-1){if(r===this.prerelease.join(".")&&i===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(n)}}if(r){let a=[r,n];i===!1&&(a=[r]),ne(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=a):this.prerelease=a}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var Ce=Er;const Qe=Ce,gr=(t,e,r)=>new Qe(t,r).compare(new Qe(e,r));var se=gr;const yr=se,$r=(t,e,r)=>yr(t,e,r)===0;var br=$r;const Ir=se,Rr=(t,e,r)=>Ir(t,e,r)!==0;var Or=Rr;const Lr=se,Nr=(t,e,r)=>Lr(t,e,r)>0;var Tr=Nr;const Ar=se,wr=(t,e,r)=>Ar(t,e,r)>=0;var Sr=wr;const xr=se,Cr=(t,e,r)=>xr(t,e,r)<0;var Dr=Cr;const Pr=se,_r=(t,e,r)=>Pr(t,e,r)<=0;var jr=_r;const Fr=br,Gr=Or,Ur=Tr,Xr=Sr,Vr=Dr,zr=jr,Hr=(t,e,r,i)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return Fr(t,r,i);case"!=":return Gr(t,r,i);case">":return Ur(t,r,i);case">=":return Xr(t,r,i);case"<":return Vr(t,r,i);case"<=":return zr(t,r,i);default:throw new TypeError(`Invalid operator: ${e}`)}};var Mr=Hr,De,Ze;function Wr(){if(Ze)return De;Ze=1;const t=Symbol("SemVer ANY");class e{static get ANY(){return t}constructor(h,g){if(g=r(g),h instanceof e){if(h.loose===!!g.loose)return h;h=h.value}h=h.trim().split(/\s+/).join(" "),I("comparator",h,g),this.options=g,this.loose=!!g.loose,this.parse(h),this.semver===t?this.value="":this.value=this.operator+this.semver.version,I("comp",this)}parse(h){const g=this.options.loose?i[n.COMPARATORLOOSE]:i[n.COMPARATOR],S=h.match(g);if(!S)throw new TypeError(`Invalid comparator: ${h}`);this.operator=S[1]!==void 0?S[1]:"",this.operator==="="&&(this.operator=""),S[2]?this.semver=new b(S[2],this.options.loose):this.semver=t}toString(){return this.value}test(h){if(I("Comparator.test",h,this.options.loose),this.semver===t||h===t)return!0;if(typeof h=="string")try{h=new b(h,this.options)}catch(g){return!1}return a(h,this.operator,this.semver,this.options)}intersects(h,g){if(!(h instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new s(h.value,g).test(this.value):h.operator===""?h.value===""?!0:new s(this.value,g).test(h.semver):(g=r(g),g.includePrerelease&&(this.value==="<0.0.0-0"||h.value==="<0.0.0-0")||!g.includePrerelease&&(this.value.startsWith("<0.0.0")||h.value.startsWith("<0.0.0"))?!1:this.operator.startsWith(">")&&h.operator.startsWith(">")||(this.operator.startsWith("<")&&h.operator.startsWith("<")||(this.semver.version===h.semver.version&&this.operator.includes("=")&&h.operator.includes("=")||a(this.semver,"<",h.semver,g)&&this.operator.startsWith(">")&&h.operator.startsWith("<")))?!0:!!(a(this.semver,">",h.semver,g)&&this.operator.startsWith("<")&&h.operator.startsWith(">")))}}De=e;const r=Ae,{safeRe:i,t:n}=xe,a=Mr,I=ve,b=Ce,s=tt();return De}var Pe,et;function tt(){if(et)return Pe;et=1;class t{constructor(l,m){if(m=i(m),l instanceof t)return l.loose===!!m.loose&&l.includePrerelease===!!m.includePrerelease?l:new t(l.raw,m);if(l instanceof n)return this.raw=l.value,this.set=[[l]],this.format(),this;if(this.options=m,this.loose=!!m.loose,this.includePrerelease=!!m.includePrerelease,this.raw=l.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(p=>this.parseRange(p.trim())).filter(p=>p.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const p=this.set[0];if(this.set=this.set.filter(d=>!f(d[0])),this.set.length===0)this.set=[p];else if(this.set.length>1){for(const d of this.set)if(d.length===1&&G(d[0])){this.set=[d];break}}}this.format()}format(){return this.range=this.set.map(l=>l.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(l){const m=(this.options.includePrerelease&&S)|(this.options.loose&&_),p=m+":"+l,d=r.get(p);if(d)return d;const u=this.options.loose,v=u?b[s.HYPHENRANGELOOSE]:b[s.HYPHENRANGE];l=l.replace(v,Ie(this.options.includePrerelease)),a("hyphen replace",l),l=l.replace(b[s.COMPARATORTRIM],o),a("comparator trim",l),l=l.replace(b[s.TILDETRIM],h),a("tilde trim",l),l=l.replace(b[s.CARETTRIM],g),a("caret trim",l);let R=l.split(" ").map(A=>x(A,this.options)).join(" ").split(/\s+/).map(A=>be(A,this.options));u&&(R=R.filter(A=>(a("loose invalid filter",A,this.options),!!A.match(b[s.COMPARATORLOOSE])))),a("range list",R);const E=new Map,N=R.map(A=>new n(A,this.options));for(const A of N){if(f(A))return[A];E.set(A.value,A)}E.size>1&&E.has("")&&E.delete("");const P=[...E.values()];return r.set(p,P),P}intersects(l,m){if(!(l instanceof t))throw new TypeError("a Range is required");return this.set.some(p=>D(p,m)&&l.set.some(d=>D(d,m)&&p.every(u=>d.every(v=>u.intersects(v,m)))))}test(l){if(!l)return!1;if(typeof l=="string")try{l=new I(l,this.options)}catch(m){return!1}for(let m=0;m<this.set.length;m++)if(Re(this.set[m],l,this.options))return!0;return!1}}Pe=t;const e=nr,r=new e({max:1e3}),i=Ae,n=Wr(),a=ve,I=Ce,{safeRe:b,t:s,comparatorTrimReplace:o,tildeTrimReplace:h,caretTrimReplace:g}=xe,{FLAG_INCLUDE_PRERELEASE:S,FLAG_LOOSE:_}=Se,f=c=>c.value==="<0.0.0-0",G=c=>c.value==="",D=(c,l)=>{let m=!0;const p=c.slice();let d=p.pop();for(;m&&p.length;)m=p.every(u=>d.intersects(u,l)),d=p.pop();return m},x=(c,l)=>(a("comp",c,l),c=L(c,l),a("caret",c),c=j(c,l),a("tildes",c),c=y(c,l),a("xrange",c),c=F(c,l),a("stars",c),c),O=c=>!c||c.toLowerCase()==="x"||c==="*",j=(c,l)=>c.trim().split(/\s+/).map(m=>$e(m,l)).join(" "),$e=(c,l)=>{const m=l.loose?b[s.TILDELOOSE]:b[s.TILDE];return c.replace(m,(p,d,u,v,R)=>{a("tilde",c,p,d,u,v,R);let E;return O(d)?E="":O(u)?E=`>=${d}.0.0 <${+d+1}.0.0-0`:O(v)?E=`>=${d}.${u}.0 <${d}.${+u+1}.0-0`:R?(a("replaceTilde pr",R),E=`>=${d}.${u}.${v}-${R} <${d}.${+u+1}.0-0`):E=`>=${d}.${u}.${v} <${d}.${+u+1}.0-0`,a("tilde return",E),E})},L=(c,l)=>c.trim().split(/\s+/).map(m=>T(m,l)).join(" "),T=(c,l)=>{a("caret",c,l);const m=l.loose?b[s.CARETLOOSE]:b[s.CARET],p=l.includePrerelease?"-0":"";return c.replace(m,(d,u,v,R,E)=>{a("caret",c,d,u,v,R,E);let N;return O(u)?N="":O(v)?N=`>=${u}.0.0${p} <${+u+1}.0.0-0`:O(R)?u==="0"?N=`>=${u}.${v}.0${p} <${u}.${+v+1}.0-0`:N=`>=${u}.${v}.0${p} <${+u+1}.0.0-0`:E?(a("replaceCaret pr",E),u==="0"?v==="0"?N=`>=${u}.${v}.${R}-${E} <${u}.${v}.${+R+1}-0`:N=`>=${u}.${v}.${R}-${E} <${u}.${+v+1}.0-0`:N=`>=${u}.${v}.${R}-${E} <${+u+1}.0.0-0`):(a("no pr"),u==="0"?v==="0"?N=`>=${u}.${v}.${R}${p} <${u}.${v}.${+R+1}-0`:N=`>=${u}.${v}.${R}${p} <${u}.${+v+1}.0-0`:N=`>=${u}.${v}.${R} <${+u+1}.0.0-0`),a("caret return",N),N})},y=(c,l)=>(a("replaceXRanges",c,l),c.split(/\s+/).map(m=>w(m,l)).join(" ")),w=(c,l)=>{c=c.trim();const m=l.loose?b[s.XRANGELOOSE]:b[s.XRANGE];return c.replace(m,(p,d,u,v,R,E)=>{a("xRange",c,p,d,u,v,R,E);const N=O(u),P=N||O(v),A=P||O(R),oe=A;return d==="="&&oe&&(d=""),E=l.includePrerelease?"-0":"",N?d===">"||d==="<"?p="<0.0.0-0":p="*":d&&oe?(P&&(v=0),R=0,d===">"?(d=">=",P?(u=+u+1,v=0,R=0):(v=+v+1,R=0)):d==="<="&&(d="<",P?u=+u+1:v=+v+1),d==="<"&&(E="-0"),p=`${d+u}.${v}.${R}${E}`):P?p=`>=${u}.0.0${E} <${+u+1}.0.0-0`:A&&(p=`>=${u}.${v}.0${E} <${u}.${+v+1}.0-0`),a("xRange return",p),p})},F=(c,l)=>(a("replaceStars",c,l),c.trim().replace(b[s.STAR],"")),be=(c,l)=>(a("replaceGTE0",c,l),c.trim().replace(b[l.includePrerelease?s.GTE0PRE:s.GTE0],"")),Ie=c=>(l,m,p,d,u,v,R,E,N,P,A,oe,xi)=>(O(p)?m="":O(d)?m=`>=${p}.0.0${c?"-0":""}`:O(u)?m=`>=${p}.${d}.0${c?"-0":""}`:v?m=`>=${m}`:m=`>=${m}${c?"-0":""}`,O(N)?E="":O(P)?E=`<${+N+1}.0.0-0`:O(A)?E=`<${N}.${+P+1}.0-0`:oe?E=`<=${N}.${P}.${A}-${oe}`:c?E=`<${N}.${P}.${+A+1}-0`:E=`<=${E}`,`${m} ${E}`.trim()),Re=(c,l,m)=>{for(let p=0;p<c.length;p++)if(!c[p].test(l))return!1;if(l.prerelease.length&&!m.includePrerelease){for(let p=0;p<c.length;p++){if(a(c[p].semver),c[p].semver===n.ANY)continue;if(c[p].semver.prerelease.length>0){const d=c[p].semver;if(d.major===l.major&&d.minor===l.minor&&d.patch===l.patch)return!0}}return!1}return!0};return Pe}const qr=tt(),Yr=(t,e,r)=>{try{e=new qr(e,r)}catch(i){return!1}return e.test(t)};var Br=Yr,rt=Kt(Br);function Kr(t,e,r){const i=t.open(e),n=1e4,a=250,{origin:I}=new URL(e);let b=~~(n/a);function s(h){h.source===i&&(b=0,t.removeEventListener("message",s,!1))}t.addEventListener("message",s,!1);function o(){if(b<=0)return;i.postMessage(r,I),setTimeout(o,a),b-=1}setTimeout(o,a)}var kr=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box;
}
.vega-embed.has-actions {
  padding-right: 38px;
}
.vega-embed details:not([open]) > :not(summary) {
  display: none !important;
}
.vega-embed summary {
  list-style: none;
  position: absolute;
  top: 0;
  right: 0;
  padding: 6px;
  z-index: 1000;
  background: white;
  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
  color: #1b1e23;
  border: 1px solid #aaa;
  border-radius: 999px;
  opacity: 0.2;
  transition: opacity 0.4s ease-in;
  cursor: pointer;
  line-height: 0px;
}
.vega-embed summary::-webkit-details-marker {
  display: none;
}
.vega-embed summary:active {
  box-shadow: #aaa 0px 0px 0px 1px inset;
}
.vega-embed summary svg {
  width: 14px;
  height: 14px;
}
.vega-embed details[open] summary {
  opacity: 0.7;
}
.vega-embed:hover summary, .vega-embed:focus-within summary {
  opacity: 1 !important;
  transition: opacity 0.2s ease;
}
.vega-embed .vega-actions {
  position: absolute;
  z-index: 1001;
  top: 35px;
  right: -9px;
  display: flex;
  flex-direction: column;
  padding-bottom: 8px;
  padding-top: 8px;
  border-radius: 4px;
  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
  border: 1px solid #d9d9d9;
  background: white;
  animation-duration: 0.15s;
  animation-name: scale-in;
  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
  text-align: left;
}
.vega-embed .vega-actions a {
  padding: 8px 16px;
  font-family: sans-serif;
  font-size: 14px;
  font-weight: 600;
  white-space: nowrap;
  color: #434a56;
  text-decoration: none;
}
.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {
  background-color: #f7f7f9;
  color: black;
}
.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
  content: "";
  display: inline-block;
  position: absolute;
}
.vega-embed .vega-actions::before {
  left: auto;
  right: 14px;
  top: -16px;
  border: 8px solid rgba(0, 0, 0, 0);
  border-bottom-color: #d9d9d9;
}
.vega-embed .vega-actions::after {
  left: auto;
  right: 15px;
  top: -14px;
  border: 7px solid rgba(0, 0, 0, 0);
  border-bottom-color: #fff;
}
.vega-embed .chart-wrapper.fit-x {
  width: 100%;
}
.vega-embed .chart-wrapper.fit-y {
  height: 100%;
}

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px;
}

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}
`;function it(t,...e){for(const r of e)Jr(t,r);return t}function Jr(t,e){for(const r of Object.keys(e))mt(t,r,e[r],!0)}var Qr="vega-embed",Zr="6.23.0",ei="Publish Vega visualizations as embedded web components.",ti=["vega","data","visualization","component","embed"],ri={type:"git",url:"http://github.com/vega/vega-embed.git"},ii={name:"UW Interactive Data Lab",url:"http://idl.cs.washington.edu"},ni=[{name:"Dominik Moritz",url:"https://www.domoritz.de"}],si={url:"https://github.com/vega/vega-embed/issues"},ai="https://github.com/vega/vega-embed#readme",oi="BSD-3-Clause",li="build/vega-embed.js",ci="build/vega-embed.module.js",ui="build/vega-embed.min.js",hi="build/vega-embed.min.js",fi="build/vega-embed.module.d.ts",pi=["src","build","patches"],di={"@babel/core":"^7.22.9","@babel/plugin-proposal-async-generator-functions":"^7.20.7","@babel/plugin-proposal-json-strings":"^7.18.6","@babel/plugin-proposal-object-rest-spread":"^7.20.7","@babel/plugin-proposal-optional-catch-binding":"^7.18.6","@babel/plugin-transform-runtime":"^7.22.9","@babel/preset-env":"^7.22.9","@babel/preset-typescript":"^7.22.5","@release-it/conventional-changelog":"^7.0.0","@rollup/plugin-commonjs":"25.0.4","@rollup/plugin-json":"^6.0.0","@rollup/plugin-node-resolve":"^15.1.0","@rollup/plugin-terser":"^0.4.3","@types/semver":"^7.5.0","@typescript-eslint/eslint-plugin":"^6.2.0","@typescript-eslint/parser":"^6.2.0","browser-sync":"^2.29.3",concurrently:"^8.2.0","del-cli":"^5.0.0",eslint:"^8.46.0","eslint-config-prettier":"^9.0.0","eslint-plugin-jest":"^27.2.3","eslint-plugin-prettier":"^5.0.0",jest:"^29.6.2","jest-canvas-mock":"^2.5.2","jest-environment-jsdom":"^29.6.2","patch-package":"^8.0.0","postinstall-postinstall":"^2.1.0",prettier:"^3.0.0","release-it":"^16.1.3",rollup:"3.29.1","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-ts":"^3.2.0",sass:"^1.64.1",typescript:"^5.1.6",vega:"^5.22.1","vega-lite":"^5.2.0"},mi={vega:"^5.21.0","vega-lite":"*"},vi={"fast-json-patch":"^3.1.1","json-stringify-pretty-compact":"^3.0.0",semver:"^7.5.4",tslib:"^2.6.1","vega-interpreter":"^1.0.5","vega-schema-url-parser":"^2.2.0","vega-themes":"^2.14.0","vega-tooltip":"^0.33.0"},Ei=["yallist"],gi={prebuild:"yarn clean && yarn build:style",build:"rollup -c","build:style":"./build-style.sh",clean:"del-cli build src/style.ts",prepublishOnly:"yarn clean && yarn build",preversion:"yarn lint && yarn test",serve:"browser-sync start --directory -s -f build *.html",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",pretest:"yarn build:style",test:"jest","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand",prettierbase:"prettier '*.{css,scss,html}'",format:"eslint . --fix && yarn prettierbase --write",lint:"eslint . && yarn prettierbase --check",release:"release-it"},yi={name:Qr,version:Zr,description:ei,keywords:ti,repository:ri,author:ii,contributors:ni,bugs:si,homepage:ai,license:oi,main:li,module:ci,unpkg:ui,jsdelivr:hi,types:fi,files:pi,devDependencies:di,peerDependencies:mi,dependencies:vi,bundledDependencies:Ei,scripts:gi};function nt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,i)}return r}function Y(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?nt(Object(r),!0).forEach(function(i){Bt(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):nt(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}const $i=yi.version,X=ft;let ae=Et;const st=typeof window!="undefined"?window:void 0;ae===void 0&&st?.vl?.compile&&(ae=st.vl);const at={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},bi={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},he={vega:"Vega","vega-lite":"Vega-Lite"},ye={vega:X.version,"vega-lite":ae?ae.version:"not available"},Ii={vega:t=>t,"vega-lite":(t,e)=>ae.compile(t,{config:e}).spec},Ri=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,Oi="chart-wrapper";function Li(t){return typeof t=="function"}function ot(t,e,r,i){const n=`<html><head>${e}</head><body><pre><code class="json">`,a=`</code></pre>${r}</body></html>`,I=window.open("");I.document.write(n+t+a),I.document.title=`${he[i]} JSON Source`}function lt(t,e){if(t.$schema){const r=je(t.$schema);e&&e!==r.library&&console.warn(`The given visualization spec is written in ${he[r.library]}, but mode argument sets ${he[e]??e}.`);const i=r.library;return rt(ye[i],`^${r.version.slice(1)}`)||console.warn(`The input spec uses ${he[i]} ${r.version}, but the current version of ${he[i]} is v${ye[i]}.`),i}return"mark"in t||"encoding"in t||"layer"in t||"hconcat"in t||"vconcat"in t||"facet"in t||"repeat"in t?"vega-lite":"marks"in t||"signals"in t||"scales"in t||"axes"in t?"vega":e??"vega"}function Ni(t){return!!(t&&"load"in t)}function ct(t){return Ni(t)?t:X.loader(t)}function Ti(t){const e=t.usermeta?.embedOptions??{};return fe(e.defaultStyle)&&(e.defaultStyle=!1),e}async function Ai(t,e,r={}){let i,n;fe(e)?(n=ct(r.loader),i=JSON.parse(await n.load(e))):i=e;const a=Ti(i),I=a.loader;(!n||I)&&(n=ct(r.loader??I));const b=await ut(a,n),s=await ut(r,n),o=Y(Y({},it(s,b)),{},{config:_e(s.config??{},b.config??{})});return await Si(t,i,o,n)}async function ut(t,e){const r=fe(t.config)?JSON.parse(await e.load(t.config)):t.config??{},i=fe(t.patch)?JSON.parse(await e.load(t.patch)):t.patch;return Y(Y(Y({},t),i?{patch:i}:{}),r?{config:r}:{})}function wi(t){const e=t.getRootNode?t.getRootNode():document;return e instanceof ShadowRoot?{root:e,rootContainer:e}:{root:document,rootContainer:document.head??document.body}}async function Si(t,e,r={},i){const n=r.theme?_e(gt[r.theme],r.config??{}):r.config,a=pt(r.actions)?r.actions:it({},at,r.actions??{}),I=Y(Y({},bi),r.i18n),b=r.renderer??"canvas",s=r.logLevel??X.Warn,o=r.downloadFileName??"visualization",h=typeof t=="string"?document.querySelector(t):t;if(!h)throw new Error(`${t} does not exist`);if(r.defaultStyle!==!1){const L="vega-embed-style",{root:T,rootContainer:y}=wi(h);if(!T.getElementById(L)){const w=document.createElement("style");w.id=L,w.innerHTML=r.defaultStyle===void 0||r.defaultStyle===!0?kr.toString():r.defaultStyle,y.appendChild(w)}}const g=lt(e,r.mode);let S=Ii[g](e,n);if(g==="vega-lite"&&S.$schema){const L=je(S.$schema);rt(ye.vega,`^${L.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${L.version}, but current version is v${ye.vega}.`)}h.classList.add("vega-embed"),a&&h.classList.add("has-actions"),h.innerHTML="";let _=h;if(a){const L=document.createElement("div");L.classList.add(Oi),h.appendChild(L),_=L}const f=r.patch;if(f&&(S=f instanceof Function?f(S):ht(S,f,!0,!1).newDocument),r.formatLocale&&X.formatLocale(r.formatLocale),r.timeFormatLocale&&X.timeFormatLocale(r.timeFormatLocale),r.expressionFunctions)for(const L in r.expressionFunctions){const T=r.expressionFunctions[L];"fn"in T?X.expressionFunction(L,T.fn,T.visitor):T instanceof Function&&X.expressionFunction(L,T)}const{ast:G}=r,D=X.parse(S,g==="vega-lite"?{}:n,{ast:G}),x=new(r.viewClass||X.View)(D,Y({loader:i,logLevel:s,renderer:b},G?{expr:X.expressionInterpreter??r.expr??vt}:{}));if(x.addSignalListener("autosize",(L,T)=>{const{type:y}=T;y=="fit-x"?(_.classList.add("fit-x"),_.classList.remove("fit-y")):y=="fit-y"?(_.classList.remove("fit-x"),_.classList.add("fit-y")):y=="fit"?_.classList.add("fit-x","fit-y"):_.classList.remove("fit-x","fit-y")}),r.tooltip!==!1){const L=Li(r.tooltip)?r.tooltip:new yt(r.tooltip===!0?{}:r.tooltip).call;x.tooltip(L)}let{hover:O}=r;if(O===void 0&&(O=g==="vega"),O){const{hoverSet:L,updateSet:T}=typeof O=="boolean"?{}:O;x.hover(L,T)}r&&(r.width!=null&&x.width(r.width),r.height!=null&&x.height(r.height),r.padding!=null&&x.padding(r.padding)),await x.initialize(_,r.bind).runAsync();let j;if(a!==!1){let L=h;if(r.defaultStyle!==!1||r.forceActionsMenu){const y=document.createElement("details");y.title=I.CLICK_TO_VIEW_ACTIONS,h.append(y),L=y;const w=document.createElement("summary");w.innerHTML=Ri,y.append(w),j=F=>{y.contains(F.target)||y.removeAttribute("open")},document.addEventListener("click",j)}const T=document.createElement("div");if(L.append(T),T.classList.add("vega-actions"),a===!0||a.export!==!1){for(const y of["svg","png"])if(a===!0||a.export===!0||a.export[y]){const w=I[`${y.toUpperCase()}_ACTION`],F=document.createElement("a"),be=dt(r.scaleFactor)?r.scaleFactor[y]:r.scaleFactor;F.text=w,F.href="#",F.target="_blank",F.download=`${o}.${y}`,F.addEventListener("mousedown",async function(Ie){Ie.preventDefault();const Re=await x.toImageURL(y,be);this.href=Re}),T.append(F)}}if(a===!0||a.source!==!1){const y=document.createElement("a");y.text=I.SOURCE_ACTION,y.href="#",y.addEventListener("click",function(w){ot(Oe(e),r.sourceHeader??"",r.sourceFooter??"",g),w.preventDefault()}),T.append(y)}if(g==="vega-lite"&&(a===!0||a.compiled!==!1)){const y=document.createElement("a");y.text=I.COMPILED_ACTION,y.href="#",y.addEventListener("click",function(w){ot(Oe(S),r.sourceHeader??"",r.sourceFooter??"","vega"),w.preventDefault()}),T.append(y)}if(a===!0||a.editor!==!1){const y=r.editorUrl??"https://vega.github.io/editor/",w=document.createElement("a");w.text=I.EDITOR_ACTION,w.href="#",w.addEventListener("click",function(F){Kr(window,y,{config:n,mode:g,renderer:b,spec:Oe(e)}),F.preventDefault()}),T.append(w)}}function $e(){j&&document.removeEventListener("click",j),x.finalize()}return{view:x,spec:e,vgSpec:S,finalize:$e,embedOptions:r}}export default Ai;export{at as DEFAULT_ACTIONS,lt as guessMode,X as vega,ae as vegaLite,$i as version};
