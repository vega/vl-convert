import{truthy as X,error as h,hasOwnProperty as y,extend as R,isArray as p,field as ee,isString as b,isFunction as U,peek as j,isBoolean as ne,isDate as re,isNumber as ie,isObject as D,isRegExp as oe,toBoolean as ae,toDate as se,toNumber as ce,toString as ue,flush as fe,lerp as le,pad as de,span as me,inrange as pe,truncate as ge,quarter as he,utcquarter as ve,extent as xe,clampRange as we,panLinear as ye,panLog as be,panPow as Se,panSymlog as Ne,zoomLinear as Ae,zoomLog as Pe,zoomPow as Ee,zoomSymlog as Me,stringValue as S,identity as ze,array as N}from"/-/vega-util@v1.17.2-LUfkDhormMyfWqy3Ts6U/dist=es2020,mode=imports,min/optimized/vega-util.js";import{Literal as v,constants as $e,codegenExpression as Fe,functions as Re,parseExpression as je,CallExpression as De}from"/-/vega-expression@v5.1.0-2VnsdaYPtQ6Pi5w8JxN8/dist=es2020,mode=imports,min/optimized/vega-expression.js";import{bandSpace as Ie,scale as W,scaleFraction as Le,isRegisteredScale as Te}from"/-/vega-scale@v7.3.0-RE8rHwByiw8oUoAe4pNs/dist=es2020,mode=imports,min/optimized/vega-scale.js";import{geoBounds as Ye,geoCentroid as Ve,geoArea as qe}from"/-/d3-geo@v3.1.0-6gCuCN3p6hXOeZDWcbjw/dist=es2020,mode=imports,min/optimized/d3-geo.js";import{rgb as k,lab as Be,hcl as Ce,hsl as Ge}from"/-/d3-color@v3.1.0-MWHDMwd2Pvp3NFjvrHgn/dist=es2020,mode=imports,min/optimized/d3-color.js";import{isTuple as H}from"/-/vega-dataflow@v5.7.5-asKYS4gpPLMPf64pSozt/dist=es2020,mode=imports,min/optimized/vega-dataflow.js";import{Gradient as Oe,pathRender as Qe,pathParse as Xe,Bounds as Z,intersect as Ue}from"/-/vega-scenegraph@v4.10.2-W1dltMWN7mO3TARazJA1/dist=es2020,mode=imports,min/optimized/vega-scenegraph.js";import{selectionVisitor as I,selectionTest as We,selectionIdTest as ke,selectionResolve as He,selectionTuples as Ze}from"/-/vega-selections@v5.4.1-4yIDtA9NY6vzeN00RWao/dist=es2020,mode=imports,min/optimized/vega-selections.js";import{random as Je,cumulativeNormal as Ke,cumulativeLogNormal as _e,cumulativeUniform as tn,densityNormal as en,densityLogNormal as nn,densityUniform as rn,quantileNormal as on,quantileLogNormal as an,quantileUniform as sn,sampleNormal as cn,sampleLogNormal as un,sampleUniform as fn}from"/-/vega-statistics@v1.9.0-Qw8CjSQVQOg2M6VMgsme/dist=es2020,mode=imports,min/optimized/vega-statistics.js";import{utcOffset as ln,utcSequence as dn,timeOffset as mn,timeSequence as pn,timeUnitSpecifier as gn,week as hn,utcweek as vn,dayofyear as xn,utcdayofyear as wn}from"/-/vega-time@v2.1.1-Q1TxQbneCNdh5ryZm2Gf/dist=es2020,mode=imports,min/optimized/vega-time.js";import{range as yn}from"/-/d3-array@v3.2.3-YYAnwYSQZgGML08QhecQ/dist=es2020,mode=imports,min/optimized/d3-array.js";function L(t){const e=this.context.data[t];return e?e.values.value:[]}function J(t,e,n){const r=this.context.data[t]["index:"+e],i=r?r.value.get(n):void 0;return i&&i.count}function K(t,e){const n=this.context.dataflow,r=this.context.data[t],i=r.input;return n.pulse(i,n.changeset().remove(X).insert(e)),1}function _(t,e,n){if(t){const r=this.context.dataflow,i=t.mark.source;r.pulse(i,r.changeset().encode(t,e))}return n!==void 0?n:t}const x=t=>function(e,n){const r=this.context.dataflow.locale();return r[t](n)(e)},tt=x("format"),T=x("timeFormat"),et=x("utcFormat"),nt=x("timeParse"),rt=x("utcParse"),A=new Date(2e3,0,1);function P(t,e,n){return!Number.isInteger(t)||!Number.isInteger(e)?"":(A.setYear(2e3),A.setMonth(t),A.setDate(e),T.call(this,A,n))}function it(t){return P.call(this,t,1,"%B")}function ot(t){return P.call(this,t,1,"%b")}function at(t){return P.call(this,0,2+t,"%A")}function st(t){return P.call(this,0,2+t,"%a")}const ct=":",ut="@",E="%",Y="$";function M(t,e,n,r){e[0].type!==v&&h("First argument to data functions must be a string literal.");const i=e[0].value,o=ct+i;if(!y(o,r))try{r[o]=n.getData(i).tuplesRef()}catch(a){}}function ft(t,e,n,r){e[0].type!==v&&h("First argument to indata must be a string literal."),e[1].type!==v&&h("Second argument to indata must be a string literal.");const i=e[0].value,o=e[1].value,a=ut+o;y(a,r)||(r[a]=n.getData(i).indataRef(n,o))}function f(t,e,n,r){if(e[0].type===v)lt(n,r,e[0].value);else for(t in n.scales)lt(n,r,t)}function lt(t,e,n){const r=E+n;if(!y(e,r))try{e[r]=t.scaleRef(n)}catch(i){}}function m(t,e){if(U(t))return t;if(b(t)){const n=e.scales[t];return n&&Te(n.value)?n.value:void 0}return}function bn(t,e,n){e.__bandwidth=i=>i&&i.bandwidth?i.bandwidth():0,n._bandwidth=f,n._range=f,n._scale=f;const r=i=>"_["+(i.type===v?S(E+i.value):S(E)+"+"+t(i))+"]";return{_bandwidth:i=>`this.__bandwidth(${r(i[0])})`,_range:i=>`${r(i[0])}.range()`,_scale:i=>`${r(i[0])}(${t(i[1])})`}}function V(t,e){return function(n,r,i){if(n){const o=m(n,(i||this).context);return o&&o.path[t](r)}else return e(r)}}const dt=V("area",qe),mt=V("bounds",Ye),pt=V("centroid",Ve);function gt(t){const e=this.context.group;let n=!1;if(e)for(;t;){if(t===e){n=!0;break}t=t.mark.group}return n}function q(t,e,n){try{t[e].apply(t,["EXPRESSION"].concat([].slice.call(n)))}catch(r){t.warn(r)}return n[n.length-1]}function ht(){return q(this.context.dataflow,"warn",arguments)}function vt(){return q(this.context.dataflow,"info",arguments)}function xt(){return q(this.context.dataflow,"debug",arguments)}function B(t){const e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}function z(t){const e=k(t),n=B(e.r),r=B(e.g),i=B(e.b);return .2126*n+.7152*r+.0722*i}function wt(t,e){const n=z(t),r=z(e),i=Math.max(n,r),o=Math.min(n,r);return(i+.05)/(o+.05)}function yt(){const t=[].slice.call(arguments);return t.unshift({}),R(...t)}function bt(t,e){return t===e||t!==t&&e!==e?!0:p(t)?p(e)&&t.length===e.length?Sn(t,e):!1:D(t)&&D(e)?St(t,e):!1}function Sn(t,e){for(let n=0,r=t.length;n<r;++n)if(!bt(t[n],e[n]))return!1;return!0}function St(t,e){for(const n in t)if(!bt(t[n],e[n]))return!1;return!0}function Nt(t){return e=>St(t,e)}function At(t,e,n,r,i,o){const a=this.context.dataflow,u=this.context.data[t],s=u.input,l=a.stamp();let d=u.changes,g,F;if(a._trigger===!1||!(s.value.length||e||r))return 0;if((!d||d.stamp<l)&&(u.changes=d=a.changeset(),d.stamp=l,a.runAfter(()=>{u.modified=!0,a.pulse(s,d).run()},!0,1)),n&&(g=n===!0?X:p(n)||H(n)?n:Nt(n),d.remove(g)),e&&d.insert(e),r&&(g=Nt(r),s.value.some(g)?d.remove(g):d.insert(r)),i)for(F in o)d.modify(i,F,o[F]);return 1}function Pt(t){const e=t.touches,n=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.hypot(n,r)}function Et(t){const e=t.touches;return Math.atan2(e[0].clientY-e[1].clientY,e[0].clientX-e[1].clientX)}const Mt={};function zt(t,e){const n=Mt[e]||(Mt[e]=ee(e));return p(t)?t.map(n):n(t)}function C(t){return p(t)||ArrayBuffer.isView(t)?t:null}function G(t){return C(t)||(b(t)?t:null)}function $t(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return C(t).join(...n)}function Ft(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return G(t).indexOf(...n)}function Rt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return G(t).lastIndexOf(...n)}function jt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return G(t).slice(...n)}function Dt(t,e,n){return U(n)&&h("Function argument passed to replace."),String(t).replace(e,n)}function It(t){return C(t).slice().reverse()}function Lt(t,e,n){return Ie(t||0,e||0,n||0)}function Tt(t,e){const n=m(t,(e||this).context);return n&&n.bandwidth?n.bandwidth():0}function Yt(t,e){const n=m(t,(e||this).context);return n?n.copy():void 0}function Vt(t,e){const n=m(t,(e||this).context);return n?n.domain():[]}function qt(t,e,n){const r=m(t,(n||this).context);return r?p(e)?(r.invertRange||r.invert)(e):(r.invert||r.invertExtent)(e):void 0}function Bt(t,e){const n=m(t,(e||this).context);return n&&n.range?n.range():[]}function Ct(t,e,n){const r=m(t,(n||this).context);return r?r(e):void 0}function Gt(t,e,n,r,i){t=m(t,(i||this).context);const o=Oe(e,n);let a=t.domain(),u=a[0],s=j(a),l=ze;return s-u?l=Le(t,u,s):t=(t.interpolator?W("sequential")().interpolator(t.interpolator()):W("linear")().interpolate(t.interpolate()).range(t.range())).domain([u=0,s=1]),t.ticks&&(a=t.ticks(+r||15),u!==a[0]&&a.unshift(u),s!==j(a)&&a.push(s)),a.forEach(d=>o.stop(l(d),t(d))),o}function Ot(t,e,n){const r=m(t,(n||this).context);return function(i){return r?r.path.context(i)(e):""}}function Qt(t){let e=null;return function(n){return n?Qe(n,e=e||Xe(t)):t}}const Xt=t=>t.data;function Ut(t,e){const n=L.call(e,t);return n.root&&n.root.lookup||{}}function Wt(t,e,n){const r=Ut(t,this),i=r[e],o=r[n];return i&&o?i.path(o).map(Xt):void 0}function kt(t,e){const n=Ut(t,this)[e];return n?n.ancestors().map(Xt):void 0}const Ht=()=>typeof window!="undefined"&&window||null;function Zt(){const t=Ht();return t?t.screen:{}}function Jt(){const t=Ht();return t?[t.innerWidth,t.innerHeight]:[void 0,void 0]}function Kt(){const t=this.context.dataflow,e=t.container&&t.container();return e?[e.clientWidth,e.clientHeight]:[void 0,void 0]}function _t(t,e,n){if(!t)return[];const[r,i]=t,o=new Z().set(r[0],r[1],i[0],i[1]),a=n||this.context.dataflow.scenegraph().root;return Ue(a,o,Nn(e))}function Nn(t){let e=null;if(t){const n=N(t.marktype),r=N(t.markname);e=i=>(!n.length||n.some(o=>i.marktype===o))&&(!r.length||r.some(o=>i.name===o))}return e}function An(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5;t=N(t);const i=t[t.length-1];return i===void 0||Math.hypot(i[0]-e,i[1]-n)>r?[...t,[e,n]]:t}function Pn(t){return N(t).reduce((e,n,r)=>{let[i,o]=n;return e+=r==0?`M ${i},${o} `:r===t.length-1?" Z":`L ${i},${o} `},"")}function En(t,e,n){const{x:r,y:i,mark:o}=n,a=new Z().set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[s,l]of e)s<a.x1&&(a.x1=s),s>a.x2&&(a.x2=s),l<a.y1&&(a.y1=l),l>a.y2&&(a.y2=l);a.translate(r,i);const u=_t([[a.x1,a.y1],[a.x2,a.y2]],t,o);return u.filter(s=>Mn(s.x,s.y,e))}function Mn(t,e,n){let r=0;for(let i=0,o=n.length-1;i<n.length;o=i++){const[a,u]=n[o],[s,l]=n[i];l>e!=u>e&&t<(a-s)*(e-l)/(u-l)+s&&r++}return r&1}const w={random(){return Je()},cumulativeNormal:Ke,cumulativeLogNormal:_e,cumulativeUniform:tn,densityNormal:en,densityLogNormal:nn,densityUniform:rn,quantileNormal:on,quantileLogNormal:an,quantileUniform:sn,sampleNormal:cn,sampleLogNormal:un,sampleUniform:fn,isArray:p,isBoolean:ne,isDate:re,isDefined(t){return t!==void 0},isNumber:ie,isObject:D,isRegExp:oe,isString:b,isTuple:H,isValid(t){return t!=null&&t===t},toBoolean:ae,toDate(t){return se(t)},toNumber:ce,toString:ue,indexof:Ft,join:$t,lastindexof:Rt,replace:Dt,reverse:It,slice:jt,flush:fe,lerp:le,merge:yt,pad:de,peek:j,pluck:zt,span:me,inrange:pe,truncate:ge,rgb:k,lab:Be,hcl:Ce,hsl:Ge,luminance:z,contrast:wt,sequence:yn,format:tt,utcFormat:et,utcParse:rt,utcOffset:ln,utcSequence:dn,timeFormat:T,timeParse:nt,timeOffset:mn,timeSequence:pn,timeUnitSpecifier:gn,monthFormat:it,monthAbbrevFormat:ot,dayFormat:at,dayAbbrevFormat:st,quarter:he,utcquarter:ve,week:hn,utcweek:vn,dayofyear:xn,utcdayofyear:wn,warn:ht,info:vt,debug:xt,extent(t){return xe(t)},inScope:gt,intersect:_t,clampRange:we,pinchDistance:Pt,pinchAngle:Et,screen:Zt,containerSize:Kt,windowSize:Jt,bandspace:Lt,setdata:K,pathShape:Qt,panLinear:ye,panLog:be,panPow:Se,panSymlog:Ne,zoomLinear:Ae,zoomLog:Pe,zoomPow:Ee,zoomSymlog:Me,encode:_,modify:At,lassoAppend:An,lassoPath:Pn,intersectLasso:En},zn=["view","item","group","xy","x","y"],$n="event.vega.",te="this.",O={},Q={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:t=>`_[${S(Y+t)}]`,functions:Fn,constants:$e,visitors:O},$=Fe(Q);function Fn(t){const e=Re(t);zn.forEach(n=>e[n]=$n+n);for(const n in w)e[n]=te+n;return R(e,bn(t,w,O)),e}function c(t,e,n){return arguments.length===1?w[t]:(w[t]=e,n&&(O[t]=n),$&&($.functions[t]=te+t),this)}c("bandwidth",Tt,f),c("copy",Yt,f),c("domain",Vt,f),c("range",Bt,f),c("invert",qt,f),c("scale",Ct,f),c("gradient",Gt,f),c("geoArea",dt,f),c("geoBounds",mt,f),c("geoCentroid",pt,f),c("geoShape",Ot,f),c("indata",J,ft),c("data",L,M),c("treePath",Wt,M),c("treeAncestors",kt,M),c("vlSelectionTest",We,I),c("vlSelectionIdTest",ke,I),c("vlSelectionResolve",He,I),c("vlSelectionTuples",Ze);function Rn(t,e){const n={};let r;try{t=b(t)?t:S(t)+"",r=je(t)}catch(o){h("Expression parse error: "+t)}r.visit(o=>{if(o.type!==De)return;const a=o.callee.name,u=Q.visitors[a];u&&u(a,o.arguments,e,n)});const i=$(r);return i.globals.forEach(o=>{const a=Y+o;!y(n,a)&&e.getSignal(o)&&(n[a]=e.signalRef(o))}),{$expr:R({code:i.code},e.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}export{ct as DataPrefix,ut as IndexPrefix,E as ScalePrefix,Y as SignalPrefix,Lt as bandspace,Tt as bandwidth,$ as codeGenerator,Q as codegenParams,Kt as containerSize,wt as contrast,Yt as copy,L as data,M as dataVisitor,st as dayAbbrevFormat,at as dayFormat,xt as debug,Vt as domain,_ as encode,c as expressionFunction,tt as format,w as functionContext,dt as geoArea,mt as geoBounds,pt as geoCentroid,Ot as geoShape,gt as inScope,J as indata,ft as indataVisitor,Ft as indexof,vt as info,qt as invert,$t as join,Rt as lastindexof,z as luminance,yt as merge,At as modify,ot as monthAbbrevFormat,it as monthFormat,Rn as parseExpression,Qt as pathShape,Et as pinchAngle,Pt as pinchDistance,zt as pluck,Bt as range,Dt as replace,It as reverse,Ct as scale,Gt as scaleGradient,f as scaleVisitor,Zt as screen,K as setdata,jt as slice,T as timeFormat,nt as timeParse,kt as treeAncestors,Wt as treePath,et as utcFormat,rt as utcParse,ht as warn,Jt as windowSize};export default null;
